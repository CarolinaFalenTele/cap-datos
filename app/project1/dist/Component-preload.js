//@ui5-bundle project1/Component-preload.js
sap.ui.predefine("project1/Component", ["sap/ui/core/UIComponent","sap/ui/Device","project1/model/models"],function(e,t,i){"use strict";return e.extend("project1.Component",{metadata:{manifest:"json"},init:function(){e.prototype.init.apply(this,arguments);this.getRouter().initialize();this.setModel(i.createDeviceModel(),"device")}})});
sap.ui.predefine("project1/controller/App.controller", ["sap/ui/core/mvc/Controller","sap/ui/core/CustomData","sap/m/MessageBox","sap/ui/core/format/DateFormat","project1/model/formatter"],function(e,t,o,a,s){"use strict";return e.extend("project1.controller.App",{formatter:s,onInit:function(){this._loadProjectData();const e=this.getOwnerComponent().getRouter();e.getRoute("app").attachPatternMatched(this._onObjectMatched,this);e.getRoute("appNoparame").attachPatternMatched(this._onObjectMatched,this);this.bProcessFlowAllowed=false;this.loadFilteredData();this.loadFilteredDataPend();this.getUserInfo();this._cargarDatosUsuario()},_cargarDatosUsuario:async function(){try{const e=await fetch("/odata/v4/datos-cdo/userdata");if(!e.ok){throw new Error("No se pudo obtener el usuario desde el backend.")}const t=await e.json();const o=new sap.ui.model.json.JSONModel(t);this.getView().setModel(o,"userModel");await this.filterEstado()}catch(e){console.error("Error al cargar el usuario:",e)}},filterEstado:async function(){try{const e=this.getView().getModel("userModel");if(!e){return}const t=e.getProperty("/ID");const o=e.getProperty("/email");const a=await fetch(`/odata/v4/datos-cdo/DatosProyect?$expand=Area,jefeProyectID`);const s=await a.json();const n=s.value;const r=n.filter(e=>e.Usuarios_ID===t);const i=async e=>await Promise.all(e.map(async e=>{const t=e.ID;const o=e=>{if(!e)return null;const t=new Date(e);return`${t.getDate().toString().padStart(2,"0")}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getFullYear()}`};e.FechaCreacionFormateada=o(e.fechaCreacion);e.fechaComiteForm=o(e.fechaComite);e.FechaModificacionFormateada=o(e.FechaModificacion);e.NombreArea=e.Area?.NombreArea||"Sin área";e.NombreJefe=e.jefeProyectID?.name||"Sin jefe";e.EstadoStatus=e.Estado==="Aprobado"?"Success":e.Estado==="Rechazado"?"Error":"None";e.OfertaIcon=e.Oferta?"sap-icon://accept":"sap-icon://decline";e.OfertaColor=e.Oferta?"#0066FF":"red";e.OfertaTexto=e.Oferta?"Si":"No";if(e.Estado==="Borrador"){e.workflowId=null;e.actualizadoEn=null;e.actualizadoEnFormateada="No aplica";e.Etapas=[];return e}const a=await fetch(`/odata/v4/datos-cdo/WorkflowInstancias?$filter=datosProyect_ID eq ${t}&$orderby=creadoEn desc&$top=1`);const s=await a.json();const n=s.value[0];let r=[];if(n?.ID){const e=await fetch(`/odata/v4/datos-cdo/WorkflowEtapas?$filter=workflow_ID eq ${n.workflowId}`);this._workID=n.workflowId;const t=await e.json();r=t.value||[]}const i=r.some(e=>e.estado==="Pendiente");if(i){e.Estado="Pendiente"}else if(n?.estado){e.Estado=n.estado}else{e.Estado=e.Estado||"Borrador"}e.workflowId=n?.workflowId||null;e.actualizadoEn=n?.actualizadoEn||null;e.actualizadoEnFormateada=o(e.actualizadoEn)||"Fecha no disponible";e.Etapas=r;return e}));const c=await i(n);const l=c.filter(e=>e.Estado==="Aprobado");const d=c.filter(e=>e.Estado==="Pendiente");const u=c.filter(e=>e.Estado==="Borrador"&&e.Usuarios_ID===t);const p=c.filter(e=>e.Estado==="Rechazado");const f=[];const m=[];d.forEach(e=>{const t=e.Etapas.filter(e=>e.estado==="Aprobado"||e.estado==="Rechazado").sort((e,t)=>new Date(t.fechaAprobado||t.creadoEn)-new Date(e.fechaAprobado||e.creadoEn))[0];if(t){e.UltimaEtapaComentario=t.comentario||"";e.UltimaEtapaNombre=t.nombreEtapa||"Etapa sin nombre"}else{e.UltimaEtapaComentario="";e.UltimaEtapaNombre=""}let a=false;e.Etapas.forEach(t=>{if(t.estado==="Pendiente"&&t.asignadoA?.trim().toLowerCase()===o?.trim().toLowerCase()){a=true;f.push({nombreEtapa:t.nombreEtapa,asignadoA:t.asignadoA,aprobadoPor:t.aprobadoPor,estado:t.estado,comentario:e.UltimaEtapaComentario,fechaAprobado:t.fechaAprobado,nameProyect:e.nameProyect,creadoPor:e.creadoPor,descripcion:e.descripcion,projectId:e.ID})}});if(a){m.push(e)}});const h=c.reduce((e,o)=>{if(o.Estado==="Borrador"&&o.Usuarios_ID!==t){return e}return e+1},0);this.getView().setModel(new sap.ui.model.json.JSONModel({Count:h}),"modelTotal");const g=await i(r);const w=g.filter(e=>e.Estado==="Pendiente");const I=[...l,...p];this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:I,Count:I.length}),"modelAprobados");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:d,Count:d.length}),"modelPendientes");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:u,Count:u.length}),"modelBorrador");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:p,Count:p.length}),"modelRechazados");this.getView().setModel(new sap.ui.model.json.JSONModel({Count:h}),"modelTotal");this.getView().setModel(new sap.ui.model.json.JSONModel({Etapas:f,Count:f.length}),"modelEtapasAsignadas");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:m,Count:m.length}),"modelAsignados");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:w,Count:w.length}),"modelMisSolicitudesPendientes");this.getView().setModel(new sap.ui.model.json.JSONModel({DatosProyect:w,Count:w.length}),"modelMisSolicitudes");const C=this.byId("status0");if(d.length>0){C.setText("Pendiente");C.setState("Warning")}else if(p.length>0){C.setText("Rechazado");C.setState("None")}else if(u.length>0){C.setText("Borrador");C.setState("None")}else{C.setText("Aprobado");C.setState("Success")}}catch(e){console.error("❌ Error al cargar los proyectos con estado:",e)}},filtrarProyectosPorNombre:function(e){if(typeof e!=="string"){e=""}var t=this.getView().getModel("modelRechazados");var o=t.getProperty("/DatosProyect")||[];var a=o.filter(function(t){return t.name&&t.name.toLowerCase().includes(e.toLowerCase())});t.setProperty("/DatosProyect",a);t.setProperty("/Count",a.length)},filtrarProyectosPorNombre:function(e){if(typeof e!=="string"){e=""}var t=this.getView().getModel("modelRechazados");var o=t.getProperty("/DatosProyect")||[];var a=o.filter(function(t){return t.name&&t.name.toLowerCase().includes(e.toLowerCase())});t.setProperty("/DatosProyect",a);t.setProperty("/Count",a.length)},onActivityPress:function(e,t){this.byId("ma77").setVisible(true);var o=e.getSource();var a=o.getCustomData()[0].getValue();var s=o.getCustomData()[1].getValue();const n=t.value;var r=this.byId("processflow1");if(!r){console.error("No se encontró el ProcessFlow con ID 'processflow1'");return}r.removeAllNodes();this.createProcessFlowNodes(n,r,a);r.attachNodePress(this.onNodePress.bind(this));this.byId("idTitleProceso").setText("Proceso de solicitud: "+a);this.byId("text1881").setText("PEP de solicitud: "+s);this.byId("itb1").setSelectedKey("people")},onVerHistorial:async function(e){try{const t=e.getSource();let o=t.getBindingContext("modelPendientes");let a="modelPendientes";if(!o){o=t.getBindingContext("modelAprobados");a="modelAprobados"}if(!o){sap.m.MessageBox.warning("No se pudo determinar el modelo de origen.");return}const s=o.getObject();const n=s.workflowId;if(!n){return}const r=this.getOwnerComponent().getModel();const i=r.bindContext("/getWorkflowTimeline(...)");i.setParameter("ID",n);await i.execute();const c=i.getBoundContext().getObject();await this.onActivityPress(e,c);sap.m.MessageBox.information(JSON.stringify(c,null,2))}catch(e){console.error(" Error al obtener el historial del workflow:",e);sap.m.MessageBox.error("No se pudo obtener el historial del workflow.")}},onActivityPress:function(e,t){this.byId("ma77").setVisible(true);var o=e.getSource();var a=o.getCustomData()[0].getValue();var s=o.getCustomData()[1].getValue();const n=t.value;var r=this.byId("processflow1");if(!r){console.error("No se encontró el ProcessFlow con ID 'processflow1'");return}r.removeAllNodes();this.createProcessFlowNodes(n,r,a);r.attachNodePress(this.onNodePress.bind(this));this.byId("idTitleProceso").setText("Proceso de solicitud: "+a);this.byId("text1881").setText("PEP de solicitud: "+s);this.byId("itb1").setSelectedKey("people")},createProcessFlowNodes:function(e,t,o){const a={"SOLICITUD CDO":"0","APROBACIÓN":"1",BASIS:"2",PMO:"3","APROBADO PMO":"4",CONTROL:"5","GESTIÓN":"6","DIRECCIÓN":"8","APROBACIÓN DIRECCIÓN":"9",RECHAZO:"99",FINALIZADO:"99"};const s={COMPLETED:"Positive",APPROVED:"Positive",RECHAZO:"Negative",REJECTED:"Negative",PENDIENTE:"Critical",CREATED:"Neutral",TRIGGERED:"Neutral"};const n=[];const r=e.filter(e=>{const t=(e.paso||"").trim().toUpperCase();return!n.some(e=>t.includes(e.toUpperCase()))});const i=new Map;r.forEach(e=>{const t=`${e.instancia}-${(e.paso||"").trim()}`;const o=i.get(t);if(!o||new Date(e.timestamp)>new Date(o.timestamp)){i.set(t,e)}});const c=Array.from(i.values()).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));t.removeAllNodes();c.forEach((e,o)=>{if(!e.id)e.id="evento_"+o;let a=e.paso||"Paso desconocido";let n=this.obtenerLaneIdDesdePaso(a);const r=a.toUpperCase();if(r.includes("CDO")||r.includes("INICIO")){n="0"}else if(r.includes("APROBACIÓN")){n="1"}else if(r.includes("PENDIENTE")||r.includes("BASIS")||r.includes("TQ")||r.includes("FACTORIA")||r.includes("EMAIL DE APROBACIÓN")){n="2"}else if(r.includes("PMO")||r.includes("NOTIFICACIÓN")||r.includes("PENDIENTE")){if(r.includes("APROBACIÓN")){n="4"}else{n="3"}}else if(r.includes("CONTROL")||r.includes("GESTIÓN")){if(r.includes("APROBADO")){n="6"}else{n="5"}}else if(r.includes("DIRECCIÓN")||r.includes("REVISION")){if(r.includes("APROBACIÓN")){n="9"}else{n="8"}}else if(r.includes("RECHAZO")||r.includes("FINALIZADO")){n="99"}let i="Neutral";const l=(e.estado||e.tipo||"").toUpperCase();for(let e in s){if(l.includes(e)){i=s[e];break}}const d=c[o+1];const u=d?[d.id]:[];const p=new sap.suite.ui.commons.ProcessFlowNode({nodeId:e.id,laneId:n,title:a,titleAbbreviation:a.substring(0,3),state:i,stateText:e.descripcion||"",children:u,isTitleClickable:true,focused:false,highlighted:false,texts:[a,e.descripcion||""]});p.addCustomData(new sap.ui.core.CustomData({key:"eventoOriginal",value:JSON.stringify(e)}));p.data("eventoOriginal",e);t.addNode(p)})},obtenerLaneIdDesdePaso:function(e){const t=(e||"").toUpperCase();if(t.includes("CDO")||t.includes("SOLICITUD"))return"0";if(t.includes("NOTIFICACIÓN")&&t.includes("APROBACIÓN"))return"1";if(t.includes("BASIS")||t.includes("TQ")||t.includes("FACTORIA"))return"2";if(t.includes("NOTIFICACIÓN")&&t.includes("PMO"))return"3";if(t.includes("PMO")&&!t.includes("NOTIFICACIÓN"))return"4";if(t.includes("NOTIFICACIÓN")&&t.includes("CONTROL"))return"5";if(t.includes("CONTROL")&&!t.includes("NOTIFICACIÓN"))return"6";if(t.includes("NOTIFICACIÓN")&&t.includes("DIRECCIÓN"))return"8";if(t.includes("DIRECCIÓN")&&!t.includes("NOTIFICACIÓN"))return"9";if(t.includes("FINALIZADO")||t.includes("RECHAZO")||t.includes("RECHAZADO"))return"99";return"0"},onNodePress:function(e){const t=e.getParameters();if(!t)return;const o=t.data("eventoOriginal");if(!o)return;if(!this._oDialog){this._oDialog=new sap.m.Dialog({title:"Detalles del Paso",contentWidth:"500px",contentHeight:"auto",stretchOnPhone:true,verticalScrolling:true,content:[new sap.ui.layout.form.SimpleForm({editable:false,layout:"ResponsiveGridLayout",content:[new sap.m.Label({text:"Paso"}),new sap.m.Text({text:o.paso||"Paso desconocido"}),new sap.m.Label({text:"Descripción"}),new sap.m.Text({text:o.descripcion||""}),new sap.m.Label({text:"Fecha"}),new sap.m.Text({text:o.timestamp||""}),new sap.m.Label({text:"Comentario"}),new sap.m.Text({text:o.comentario||"N/A",wrapping:true})]})],beginButton:new sap.m.Button({text:"Cerrar",type:"Emphasized",press:function(){this._oDialog.close()}.bind(this)})});this.getView().addDependent(this._oDialog)}else{const e=this._oDialog.getContent()[0];e.removeAllContent();e.addContent(new sap.m.ObjectStatus({title:"Paso",text:o.paso||"Paso desconocido",state:"Success"}));e.addContent(new sap.m.ObjectStatus({title:"Descripción",text:o.descripcion||"",state:"Information"}));e.addContent(new sap.m.ObjectStatus({title:"Fecha",text:o.timestamp||"",state:"Warning"}));e.addContent(new sap.m.Label({text:"Comentario",design:"Bold",class:"sapUiSmallMarginTop"}));e.addContent(new sap.m.Text({title:"Comentario",text:o.comentario||"N/A",wrapping:true,width:"100%"}))}this._oDialog.open()},getUserInfo:function(){fetch("/odata/v4/datos-cdo/getUserInfo").then(e=>{if(!e.ok){throw new Error(" No se pudo obtener la información del usuario.")}return e.json()}).then(e=>{const t=e.value;const o=e.token||t?.token;if(!t){console.error(" No se encontró la información del usuario.");return}const a=(e,t,o)=>{const a=this.byId(e);if(a){a.setText(t||o)}else{}};a("dddtg",t.email,"Sin email");a("attrEmpleado",t.fullName,"Sin nombre");const s=t.roles||{};const n=Object.keys(s);const r=["","Visualizador","user","DatosProyect.Read"];const i=n.length===r.length&&n.every(e=>r.includes(e));console.log("Roles del usuario:",n);const c=["newId_btnEditar","aprobBtnEdit","butn34"];const l=["ww","wsw","newId_btnEliminar","newId_btnEliminar2"];const d=this.byId("33");const u=["Control","Direccion","BasisTQFac","PMO"];const p=u.some(e=>n.includes(e));const f=this.byId("id34");if(f){f.setVisible(p)}else{}const m=(e,t,o)=>{e.forEach(e=>{const o=this.byId(e);if(!o){}else{o.setEnabled(t)}})};if(i){m(c,false,"editar");m(l,false,"eliminar");if(d){d.setEnabled(false)}else{}sap.m.MessageBox.warning("Solo tiene permisos de visualizador. No puede crear, editar ni borrar.",{title:"Permisos insuficientes"})}else{m(c,true,"editar");m(l,true,"eliminar");if(d){d.setEnabled(true)}else{console.warn(" Botón de creación no encontrado: id '33'")}}if(o){this._startSessionWatcher(o)}else{console.warn("Token no recibido en la respuesta.")}}).catch(e=>{console.error("Error obteniendo datos del usuario:",e)})},_startSessionWatcher:function(e){const t=this._parseJwt(e);const o=t.exp*1e3;const a=Date.now();const s=o-a-1*60*1e3;if(s>0){setTimeout(()=>{this._showSessionWarning(o)},s)}else{this._showSessionWarning(o)}},_showSessionWarning:function(e){let t=Math.floor((e-Date.now())/1e3);const a=setInterval(()=>{if(t<=0){clearInterval(a);o.error("  Tu sesión ha expirado. (En pruebas: no se cerrará la sesión)");return}if(s&&s.getContent&&s.getContent()[0]){s.getContent()[0].setText(`Tu sesión expirará en ${t} segundos. ¿Deseas continuar?`)}t--},1e3);const s=new sap.m.Dialog({title:"  Sesión a punto de expirar",content:[new sap.m.Text({text:`Tu sesión expirará en ${t} segundos. ¿Deseas continuar?`})],beginButton:new sap.m.Button({text:"Sí, mantener sesión",press:()=>{clearInterval(a);s.close();this._refreshToken()}}),endButton:new sap.m.Button({text:"No",press:()=>{clearInterval(a);s.close()}}),afterClose:()=>{s.destroy()}});s.open()},_parseJwt:function(e){const t=e.split(".")[1];const o=atob(t.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(decodeURIComponent(escape(o)))},_refreshToken:async function(){try{const e=await fetch("/odata/v4/datos-cdo/getUserInfo",{method:"GET"});const t=await e.json();console.log("Respuesta refresco token:",t);const a=t.token||t.value&&t.value.token;if(a){this._startSessionWatcher(a);o.success("Sesión renovada.")}else{throw new Error("Token no recibido.")}}catch(e){o.error("No se pudo renovar la sesión: "+e.message)}},loadFilteredData:function(){var e=new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.EQ,"Aprobado");var t=this.byId("tabla_Aprobadores");var o=t.getBinding("items");if(o){o.filter([e]);this.updateIconTabFilterCount(o)}else{t.attachEventOnce("updateFinished",function(){var o=t.getBinding("items");o.filter([e]);this.updateIconTabFilterCount(o)}.bind(this))}},updateIconTabFilterCount:function(e){e.attachEventOnce("dataReceived",function(){var t=e.getLength();this.byId("ma55").setCount(t.toString())}.bind(this))},loadFilteredDataPend:function(){var e=this.byId("idPendientes");var t=e.getBinding("items");if(t){var o=new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.EQ,"Pendiente");t.filter([o]);var a=t.getContexts();var s=a.map(e=>e.getObject());this.updateIconTabFilterCountPen(t)}else{e.attachEventOnce("updateFinished",function(){var t=e.getBinding("items");var o=new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.EQ,"Pendiente");t.filter([o]);var a=t.getContexts();var s=a.map(e=>e.getObject());this.updateIconTabFilterCountPen(t)}.bind(this))}},updateIconTabFilterCountPen:function(e){e.attachEventOnce("dataReceived",function(){var t=e.getLength();this.byId("ma3").setCount(t.toString())}.bind(this))},onSearch:function(e){const t=e.getParameter("newValue")||e.getParameter("query")||"";const o=this.byId("TableBorrador");const a=o.getBinding("items");if(a){if(t.length>0){const e=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("FechaCreacionFormateada",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("nameProyect",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("descripcion",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("NombreArea",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("NombreJefe",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("FechaModificacionFormateada",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.Contains,t)],and:false});a.filter(e)}else{a.filter([])}}},onSearchApro:function(e){var t=e.getParameter("newValue");var o=this.byId("tabla_Aprobadores");var a=o.getBinding("items");var s=new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.EQ,"Aprobado");var n=[s];if(t&&t.length>0){var r=new sap.ui.model.Filter({path:"nameProyect",operator:sap.ui.model.FilterOperator.Contains,value1:t.toLowerCase(),caseSensitive:false});n.push(r)}var i=new sap.ui.model.Filter({filters:n,and:true});a.filter(i)},onSearchAprobadores:function(e){const t=e.getParameter("newValue")||e.getParameter("query")||"";const o=this.byId("tabla_Aprobadores");const a=o.getBinding("items");if(a){if(t.length>0){const e=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("nombreEtapa",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("nameProyect",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("descripcion",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("asignadoA",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("comentario",sap.ui.model.FilterOperator.Contains,t)],and:false});a.filter(e)}else{a.filter([])}}},onAfterShow:function(){this._loadProjectData()},_loadProjectData:function(){const e=this.byId("idPendientes");const t=e.getBinding("items");if(t){t.refresh()}},_onObjectMatched:async function(e){const t=this.getOwnerComponent().getModel("modelEtapasAsignadas");if(t){t.refresh(true)}this._refrescarModelEtapas();this.filterEstado()},_refrescarModelEtapas:async function(){try{const e=this.getView().getModel("userModel");if(!e)return;const t=e.getProperty("/email");const o=this.getView().getModel("modelPendientes");if(!o)return;const a=o.getProperty("/DatosProyect")||[];const s=[];a.forEach(e=>{e.Etapas.forEach(o=>{if(o.estado==="Pendiente"&&o.asignadoA?.trim().toLowerCase()===t?.trim().toLowerCase()){s.push({nombreEtapa:o.nombreEtapa,asignadoA:o.asignadoA,aprobadoPor:o.aprobadoPor,estado:o.estado,comentario:o.comentario,fechaAprobado:o.fechaAprobado,nameProyect:e.nameProyect,creadoPor:e.creadoPor,descripcion:e.descripcion,projectId:e.ID})}})});this.getView().getModel("modelEtapasAsignadas").setData({Etapas:s,Count:s.length})}catch(e){console.error("Error al refrescar modelEtapasAsignadas:",e)}},_refreshTableData:function(){const e=this.byId("idPendientes");if(e){e.getBinding("items")?.refresh()}},formatDate:function(e){if(!e){return""}if(typeof e==="object"&&typeof e.getTime==="function"){e=e}else{e=new Date(e)}if(isNaN(e.getTime())){return""}var t=a.getInstance({pattern:"dd MMM yyyy",UTC:true});return t.format(e)},onEditPress:function(e){var t=e.getSource();var o=t.getBindingContext("modelPendientes");var a=t.getBindingContext("modelAprobados");var s=t.getBindingContext("modelBorrador");var n=t.getBindingContext("modelEtapasAsignadas");var r=t.getBindingContext("modelRechazados");var i=o||a||s||n||r;if(!i){console.error("No se pudo obtener el contexto del ítem.");return}var c=i.getProperty("ID")||i.getProperty("projectId");if(!c){console.error("El ID del proyecto es nulo o indefinido");return}var l=i.getProperty("nameProyect");var d=this;var u=this.getView().getModel("mainService");if(u){u.setData({});u.refresh(true)}var p=null;if(o){p="modelPendientes"}else if(a){p="modelAprobados"}else if(s){p="modelBorrador"}else if(n){p="modelEtapasAsignadas"}else if(r){p="modelRechazados"}var f=p==="modelEtapasAsignadas"||p==="modelAprobados"||p==="modelRechazados"?"display":"edit";var m=f==="edit"?"Confirmar Edición":"Ver Solicitud";var h=f==="edit"?"¿Estás seguro de que quieres editar el proyecto '"+l+"'?":"¿Quieres ver el contenido de esta solicitud?";var g=new sap.m.Dialog({title:m,type:"Message",state:"Warning",content:new sap.m.Text({text:h}),beginButton:new sap.m.Button({text:"Confirmar",press:function(){g.close();var e=sap.ui.core.UIComponent.getRouterFor(d);if(p==="modelEtapasAsignadas"){e.navTo("viewWithAprobacion",{sourceModel:p,mode:f,sProjectID:c,aprobacion:"true"})}else{e.navTo("viewWithMode",{sourceModel:p,mode:f,sProjectID:c},true)}}}),endButton:new sap.m.Button({text:"Cancelar",press:function(){g.close()}})});g.open()},onView:function(e){if(!this.Dialog){this.Dialog=this.loadFragment({name:"project1.view.Dialog"})}this.Dialog.then(function(e){this.oDialog=e;this.oDialog.open()}.bind(this))},_closeDialog:function(){this.oDialog.close()},DialogInfo:async function(e){this.onView();var t=e.getSource();var o=t.getCustomData().find(function(e){return e.getKey()==="projectId"}).getValue();const a=this._sCsrfToken;var s=this.getView().getModel("mainService");if(s){s.setData({});s.refresh(true)}var n=`/odata/v4/datos-cdo/DatosProyect(${o})?$expand=jefeProyectID,Area`;try{const e=await fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","x-csrf-token":a}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const t=await e.json();this.byId("idNombreProyecto").setText(t.nameProyect);this.byId("idDescripcion1").setText(t.descripcion);this.byId("idCreador").setText(t.Empleado);this.byId("idEMail").setText(t.Email);this.byId("idModifi").setText(t.FechaModificacion);this.byId("fechainitProyect").setText(t.Fechainicio);const o=t.jefeProyectID?.name||"Sin jefe asignado";this.byId("idJefeProyect").setText(o);this.byId("idArea").setText(t.Area?.NombreArea||"Sin área");const s=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});const u=new Date(t.fechaCreacion);const p=s.format(u);this.byId("idCreacion").setText(p);if(t.FechaFin){var r=t.FechaFin.split("T")[0];var i=r.split("-");var c=i[2]+"-"+i[1]+"-"+i[0];this.byId("idFechaFinProyect").setText(c)}else{this.byId("idFechaFinProyect").setText("Sin fecha");console.warn("FechaFin es null o indefinido")}this.byId("idEstadoProyect").setText(t.Estado);const f=t.Estado||"";const m=this.byId("idEstadoProyect");m.setText(f);switch(f.toLowerCase()){case"aprobado":m.setState("Success");break;case"rechazado":m.setState("Error");break;case"pendiente":m.setState("Warning");break;case"borrador":m.setState("None");break;default:m.setState("None");break}var l=new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t.Total);var d=l+" €";this.byId("idtotal").setText(d)}catch(e){console.error("Error al obtener los datos del proyecto:",e)}},onEmailPress2:function(e){const t=e.getSource().getText();window.location.href="mailto:"+t},onDeletePress:async function(e){let t=e.getSource();const o=t.data("etapaId");let a=t.getCustomData()[0].getValue();if(!a){console.error("No se encontró un ID válido para eliminar.");sap.m.MessageToast.show("Error: No se encontró un ID válido.");return}const s={otrosGastoRecu:["ValorMensuServReInter"],RecursosInternos:["ValorMensuReInter"],otrosRecursos:["ValorMensuGastViaReInter"],ConsumoExternos:["ValorMensuConsuEx"],otrosServiciosConsu:["ValorMensuServConsuEx"],GastoViajeConsumo:["ValorMensuGastoViaConsuEx"],RecursosExternos:["ValorMensuRecuExter"],serviRecurExter:["ValorMensuSerExter"],GastoViajeRecExter:["ValorMensuGastoViExter"],otrosConceptos:["ValorMensuOtrConcep"],LicenciasCon:["ValorMensulicencia"]};try{let e=await fetch("/odata/v4/datos-cdo/",{method:"GET",headers:{"x-csrf-token":"Fetch"}});if(!e.ok)throw new Error("Error al obtener el CSRF Token");let t=e.headers.get("x-csrf-token");if(!t)throw new Error("No se recibió un CSRF Token");sap.m.MessageBox.confirm("¿Deseas eliminar este proyecto y todos sus registros relacionados?",{actions:[sap.m.MessageBox.Action.YES,sap.m.MessageBox.Action.NO],onClose:async e=>{if(e!==sap.m.MessageBox.Action.YES)return;this.byId("idPendientes").setBusy(true);this.byId("idTableAprobados").setBusy(true);this.byId("TableBorrador").setBusy(true);this.byId("tabla_Aprobadores").setBusy(true);try{const e=await fetch(`/odata/v4/datos-cdo/DatosProyect(${a})?$expand=WorkflowInstancias`,{method:"GET",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(e.ok){if(o){try{const e=this.getOwnerComponent().getModel();const t=e.bindContext("/cancelWorkflow(...)");t.setParameter("workflowInstanceId",o);await t.execute()}catch(e){console.warn("Error al cancelar el workflow. Continuando con la eliminación.",e)}}}else{console.warn("No se pudo obtener la instancia de workflow.")}const n=["planificacion","planServicio","Facturacion","ClientFactura","ProveedoresC","RecursosInternos","ConsumoExternos","RecursosExternos","otrosConceptos","otrosGastoRecu","otrosRecursos","otrosServiciosConsu","GastoViajeConsumo","serviRecurExter","GastoViajeRecExter","LicenciasCon","WorkflowInstancias","ResumenCostesTotal","RecurInterTotal","ConsuExterTotal","RecuExterTotal","InfraestrLicencia","PerfilTotal","Archivos"];for(const e of n){let o=await fetch(`/odata/v4/datos-cdo/DatosProyect(${a})/${e}`,{method:"GET",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(!o.ok){console.warn(`  No se pudieron obtener los registros de ${e}`);continue}let n=o.headers.get("Content-Type");let r=n&&n.includes("application/json")?await o.json():{value:[]};let i=Array.isArray(r.value)?r.value:[r];if(i.length>0){for(const o of i){if(s[e]){let a=s[e];for(const s of a){let a=await fetch(`/odata/v4/datos-cdo/${e}(${o.ID})/${s}`,{method:"GET",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(a.ok){let e=await a.json();let o=e.value||[];await Promise.all(o.map(async e=>{let o=await fetch(`/odata/v4/datos-cdo/${s}(${e.ID})`,{method:"DELETE",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(!o.ok){console.error(`Error eliminando hijo anidado ${s} con ID ${e.ID}`)}else{}}))}else{console.warn(`No se pudieron obtener registros para hijo anidado ${s} de ${e}(${o.ID})`)}}}let a=await fetch(`/odata/v4/datos-cdo/${e}(${o.ID})`,{method:"DELETE",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(!a.ok){console.error(`Error eliminando ${e} con ID ${o.ID}`)}else{}}}}let r=await fetch(`/odata/v4/datos-cdo/DatosProyect(${a})`,{method:"DELETE",headers:{"Content-Type":"application/json","x-csrf-token":t}});if(r.ok){sap.m.MessageBox.success("Proyecto y registros eliminados exitosamente.",{title:"Éxito",actions:[sap.m.MessageBox.Action.OK],onClose:async function(){let e=this.byId("idPendientes");if(e){let t=e.getBinding("items");if(t){t.refresh(true)}else{console.warn("  No se encontró el binding de la tabla.")}}else{console.warn("  Tabla no encontrada con ID idPendientes.")}await this.filterEstado()}.bind(this)})}else{throw new Error("Error al eliminar el proyecto principal")}}catch(e){console.error("Error eliminando el proyecto o registros:",e);sap.m.MessageToast.show("Error al eliminar el proyecto o registros.")}finally{this.byId("TableBorrador").setBusy(false);this.byId("idPendientes").setBusy(false);this.byId("idTableAprobados").setBusy(false);this.byId("tabla_Aprobadores").setBusy(false)}}})}catch(e){console.error("Error al obtener el CSRF Token:",e);sap.m.MessageToast.show("Error al obtener el CSRF Token.")}},onNavToView1:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);var t=this.getOwnerComponent();Promise.resolve().then(()=>{var e=t.byId("view");if(e&&e.getController&&typeof e.getController==="function"){var o=e.getController();if(o._clearAllInputs){o._clearAllInputs()}}});e.navTo("viewNoParam",{mode:"create"})}})});
sap.ui.predefine("project1/controller/View1.controller", ["sap/ui/core/mvc/Controller","sap/ui/core/format/DateFormat","sap/viz/ui5/controls/VizFrame","sap/ui/model/odata/v4/ODataModel","sap/m/MessageToast","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/ui/model/json/JSONModel","sap/m/MessageBox"],function(e,t,o,a,s,i,r,n,c,l,d){"use strict";return e.extend("project1.controller.View1",{recursoID:null,onInit:function(){var e=new sap.ui.model.json.JSONModel({milestones:[{fase:"Kick off",fechaInicio:null,fechaFin:null},{fase:"Diseño",fechaInicio:null,fechaFin:null},{fase:"Construcción",fechaInicio:null,fechaFin:null},{fase:"Pruebas TQ",fechaInicio:null,fechaFin:null},{fase:"Go live",fechaInicio:null,fechaFin:null},{fase:"Paso AM",fechaInicio:null,fechaFin:null},{fase:"Server post/prod",fechaInicio:null,fechaFin:null}],chartData:[]});this.getView().setModel(e,"planning");var t=new sap.ui.model.json.JSONModel({fechas:[{fase:"Plan",fechaInicio:null,fechaFin:null}]});this.getView().setModel(t,"fechasModel");var o=this.byId("idVizFrame");o.setVizProperties({title:{text:"Planificacion"}});o.setVizScales([{feed:"color",palette:["#f7f7ff","#0066ff","#c5f8f9","#75c0c7","#f3e996","#d6786b","#e1c3f4"]}],{replace:true});var a=this.byId("idVizFrame2");a.setVizProperties({title:{text:"Plan de Servicio"}});this.updateVizFrame1();this.updateVizFrame3();this._tableValues={tablaConsuExter:{},table_dimicFecha:{},tablaRecExterno:{},idOtroserConsu:{},idGastoViajeConsu:{},idServiExterno:{},idGastoRecuExter:{},tablaInfrestuctura:{},tablaLicencia:{},tableServicioInterno:{},tablGastoViajeInterno:{}};this._editedRows=this._editedRows||{};this._rowYearlySums=this._rowYearlySums||{};this._yearlySums={2024:0,2025:0,2026:0,2027:0,2028:0,2029:0};this.currentRow=0;this.currentTable=0;this._mode="";this._handleInputChangeCounter=0;const s=new sap.ui.model.json.JSONModel({mode:""});this.getView().setModel(s,"viewModel");const i=sap.ui.core.UIComponent.getRouterFor(this);["viewWithMode","viewNoParam","view","viewWithAprobacion"].forEach(function(e){i.getRoute(e).attachPatternMatched(this._onObjectMatched,this)},this);this.token();this.getUserInfo();this.onColumnTotales();this.enviarID();this.filtertables();this.byId("coste6552").setVisible(false)},actualizarHeadersAnios:function(){const e=["tablaConsuExter","table_dimicFecha","tablaRecExterno","tablaInfrestuctura"];const t=(new Date).getFullYear();if(t===this._anioActual){console.log("Año sin cambios, no actualizo headers.");return}this._anioActual=t;e.forEach(e=>{const o=this.byId(e);if(!o){console.warn(`No se encontró tabla con id: ${e}`);return}const a=o.getColumns();let s=0;a.forEach(o=>{const a=o.getHeader();if(a&&a.isA("sap.m.Label")){const o=a.getText();const i=o.trim();if(/^\d{4}$/.test(i)){const r=parseInt(i,10);const n=t+s;a.setText(n.toString());console.log(`Tabla: ${e} - Header "${o}" actualizado a "${n}"`);s++}}})})},filterAreaFalse:async function(e){var t=this.byId("slct_area");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Area",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreArea}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Area('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreArea+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el área:",o);t.setSelectedKey(e)}}},filterJefe:async function(e){var t=this.byId("slct_Jefe");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Jefeproyect",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{name}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Jefeproyect('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.name+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el JefeProyecto:",o);t.setSelectedKey(e)}}},filterVertical:async function(e){var t=this.byId("slct_verti");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Vertical",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreVertical}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Vertical('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreVertical+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el Vertical:",o);t.setSelectedKey(e)}}},filterClienteNuevo:async function(e){var t=this.byId("slct_client");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/ClienteNuevo",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreClienteNuevo}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/ClienteNuevo('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreClienteNuevo+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el ClienteNuevo:",o);t.setSelectedKey(e)}}},filterTipoIniciativa:async function(e){var t=this.byId("slct_inic");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/TipoIniciativa",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreIniciativa}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/TipoIniciativa('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreIniciativa+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el TipoIniciativa:",o);t.setSelectedKey(e)}}},filterNaturaleza:async function(e){var t=this.byId("idNatu");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Naturaleza",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreNaturaleza}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Naturaleza('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreNaturaleza+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el Naturaleza:",o);t.setSelectedKey(e)}}},filterSeguimiento:async function(e){var t=this.byId("selc_Segui");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Seguimiento",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreSeguimiento}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Seguimiento('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreSeguimiento+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el Seguimiento:",o);t.setSelectedKey(e)}}},filterEjecucionVia:async function(e){var t=this.byId("selc_ejcu");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/EjecucionVia",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreEjecuVia}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/EjecucionVia('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreEjecuVia+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el EjecucionVia:",o);t.setSelectedKey(e)}}},filterAMreceptor:async function(e){var t=this.byId("selct_Amrecp");var o=this.getOwnerComponent().getModel();t.bindItems({path:"/AMreceptor",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreAMreceptor}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/AMreceptor('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreAMreceptor+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el AMreceptor:",o);t.setSelectedKey(e)}}},filtertables:async function(){const e=["tablaConsuExter","table_dimicFecha","tablaRecExterno","idOtroserConsu","idGastoViajeConsu","idServiExterno","idGastoRecuExter","tablaInfrestuctura","tablaLicencia","tableServicioInterno","tablGastoViajeInterno"];for(let t of e){await this.filterSelectsFromTable(t)}},filterSelectsFromTable:async function(e){var t=this.byId(e);var o=t.getItems();for(let e=0;e<o.length;e++){let t=o[e];let a=t.getCells()[0];if(!a)continue;let s=a.getSelectedKey();await this.filterVerticaltablasDinamicas(s,a)}},filterVerticaltablasDinamicas:async function(e,t){var o=this.getOwnerComponent().getModel();t.bindItems({path:"/Vertical",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreVertical}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/Vertical('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreVertical+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el Vertical:",o);t.setSelectedKey(e)}}},filterTipoServicioDinamicas:async function(e,t){var o=this.getOwnerComponent().getModel();t.bindItems({path:"/TipoServicio",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombreTipoServ}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/TipoServicio('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreTipoServ+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el TipoServicio:",o);t.setSelectedKey(e)}}},filterPerfilServiDinamicas:async function(e,t){var o=this.getOwnerComponent().getModel();t.bindItems({path:"/PerfilServicio",filters:[new sap.ui.model.Filter("Activo",sap.ui.model.FilterOperator.EQ,true)],template:new sap.ui.core.Item({key:"{ID}",text:"{NombrePerfil}"})});await new Promise(e=>{var o=t.getBinding("items");if(!o){e();return}o.attachEventOnce("dataReceived",function(){e()})});if(e){var a=o.sServiceUrl+"/PerfilServicio('"+e+"')";try{var s=await fetch(a);if(!s.ok){throw new Error("No se pudo obtener el registro")}var i=await s.json();if(i&&i.Activo===false){var r=new sap.ui.core.Item({key:i.ID,text:i.NombreTipoServ+" (inactiva)",enabled:false});t.addItem(r);t.setSelectedKey(i.ID)}else{t.setSelectedKey(e)}}catch(o){console.error("Error al obtener el PerfilServicio:",o);t.setSelectedKey(e)}}},refreshODataModel:function(){const e=this.getOwnerComponent().getModel();if(e&&typeof e.refresh==="function"){e.refresh()}const t=this.getView();if(t.getElementBinding()){t.getElementBinding().refresh(true)}},onInfoPress:function(e){if(!this._oPopover){this._oPopover=this.byId("infoPopover")}this._oPopover.openBy(e.getSource())},onInfoPressRecursos:function(e){if(!this._oPopover){this._oPopover=this.byId("infoPopoverRecursos")}this._oPopover.openBy(e.getSource())},onInfoGeneralPress:function(e){if(!this._oPopoverGeneral){this._oPopoverGeneral=this.byId("infoPopoverGeneral")}this._oPopoverGeneral.openBy(e.getSource())},onTipoCambioLive:function(e){var t=e.getSource();var o=t.getValue().trim();if(o===""){return}var a=parseFloat(o);if(!isNaN(a)){t.setValue(a.toFixed(4))}},highlightControls:function(){const e=[this.byId("input0"),this.byId("input1"),this.byId("idDescripcion"),this.byId("int_clienteFun"),this.byId("id_Cfactur"),this.byId("idObje"),this.byId("idAsunyRestri"),this.byId("box_multiJuridica"),this.byId("box_pluriAnual"),this.byId("slct_area"),this.byId("slct_Jefe"),this.byId("slct_verti"),this.byId("slct_inic"),this.byId("idNatu"),this.byId("selct_Amrecp"),this.byId("selc_ejcu"),this.byId("selc_Segui"),this.byId("slct_client"),this.byId("date_inico"),this.byId("date_fin")];setTimeout(()=>{e.forEach(e=>{if(e&&e.setValueState){e.setValueState("Information")}});setTimeout(()=>{e.forEach(e=>{if(e&&e.setValueState){e.setValueState("None")}})},2e3)},50)},getUserInfo:async function(){fetch("/odata/v4/datos-cdo/getUserInfo").then(e=>{if(!e.ok){throw new Error("No se pudo obtener la información del usuario.")}return e.json()}).then(e=>{const t=e.value;const o=e.token||t&&t.token;if(t){const e=this.byId("dddtg");e?.setText(t.email);e?.setTooltip(t.email);this.byId("23d3")?.setText(t.fullName);this._user=t.email;const a=t.roles||{};const s=Object.keys(a);console.log("Roles del usuario  View:",s);this._userRoles=s;const i=["Control","Direccion","BasisTQFac","PMO"];this._userPuedeAprobar=i.some(e=>s.includes(e));this.getUsuario();if(o){this._startSessionWatcher(o)}else{console.warn("Token no recibido en la respuesta.")}}else{console.error("No se encontró la información del usuario.")}}).catch(e=>{console.error("Error obteniendo datos del usuario:",e)})},_startSessionWatcher:function(e){const t=this._parseJwt(e);const o=t.exp*1e3;const a=Date.now();const s=o-a-1*60*1e3;if(s>0){setTimeout(()=>{this._showSessionWarning(o)},s)}else{this._showSessionWarning(o)}},_showSessionWarning:function(e){let t=Math.floor((e-Date.now())/1e3);const o=setInterval(()=>{if(t<=0){clearInterval(o);d.error("⛔ Tu sesión ha expirado. (En pruebas: no se cerrará la sesión)");return}if(a&&a.getContent&&a.getContent()[0]){a.getContent()[0].setText(`Tu sesión expirará en ${t} segundos. ¿Deseas continuar?`)}t--},1e3);const a=new sap.m.Dialog({title:"    Sesión a punto de expirar",content:[new sap.m.Text({text:`Tu sesión expirará en ${t} segundos. ¿Deseas continuar?`})],beginButton:new sap.m.Button({text:"Sí, mantener sesión",press:()=>{clearInterval(o);a.close();this._refreshToken()}}),endButton:new sap.m.Button({text:"No",press:()=>{clearInterval(o);a.close()}}),afterClose:()=>{a.destroy()}});a.open()},_parseJwt:function(e){const t=e.split(".")[1];const o=atob(t.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(decodeURIComponent(escape(o)))},_refreshToken:async function(){try{const e=await fetch("/odata/v4/datos-cdo/getUserInfo",{method:"GET"});const t=await e.json();const o=t.token||t.value&&t.value.token;if(o){this._startSessionWatcher(o);d.success("Sesión renovada.")}else{throw new Error("Token no recibido.")}}catch(e){d.error("No se pudo renovar la sesión: "+e.message)}},onEmailPress:function(e){const t=e.getSource().getText();window.location.href="mailto:"+t},_resetButtonHandlers:function(){const e=this.byId("btnAceptar");const t=this.byId("btnBorrado");if(e){e.detachPress(this._onDecisionPress,this);e.detachPress(this.onSave,this);e.detachPress(this.onClearFields,this);e.detachPress(this.onBorrador,this)}if(t){t.detachPress(this._onDecisionPress,this);t.detachPress(this.onSave,this);t.detachPress(this.onClearFields,this);t.detachPress(this.onBorrador,this)}},resetFormUI:function(){var e=this.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Input")||e.isA("sap.m.TextArea")||e.isA("sap.m.CheckBox")||e.isA("sap.m.ComboBox")||e.isA("sap.m.DatePicker")});e.forEach(function(e){if(e.setEnabled){e.setEnabled(true)}if(e.setEditable){e.setEditable(true)}if(e.setValue){e.setValue("")}})},_onObjectMatched:async function(e){this._resetButtonHandlers();const t=e.getParameter("arguments");let o=t.sProjectID;let a=t.sourceModel||"modelPendientes";const s=t.mode||"display";let i=this._parseAprobacionFlag(t,a);if(a.includes(";")){a=a.split(";")[0]}const r=this.byId("btnAceptar");const n=this.byId("btnBorrado");this._mode=s;this.getView().getModel("viewModel").setProperty("/mode",s);if(s==="create"){await this._clearAllInputs()}else if(s==="edit"){this._clearAllInputsEdit()}r.setEnabled(true);r.setText("Enviar");r.setType(sap.m.ButtonType.Accept);r.attachPress(this.onSave,this);n.setEnabled(true);n.setText("Guardar como borrador");n.setType(sap.m.ButtonType.Emphasized);n.attachPress(this.onBorrador,this);if(s==="display"&&(a==="modelAprobados"||a==="modelEtapasAsignadas"||a==="modelRechazados")){this._Visualizar(o,a);return}await this._configureButtons(a,i,s);this._sProjectID=o;if(o){try{const e=await this._fetchProjectData(o);await this._populateViewWithData(e,s);await this._configureButtons(a,i,s)}catch(e){console.error("Error al obtener los datos del proyecto:",e);sap.m.MessageToast.show("Error al cargar los datos del proyecto")}}},_parseAprobacionFlag:function(e,t){let o=false;if(t.includes(";")){const e=t.split(";");t=e[0];e.slice(1).forEach(e=>{const[t,a]=e.split("=");if(t==="aprobacion"){o=a==="true"}})}else{o=e.aprobacion==="true"}return o},_configureButtons:function(e,t,o){const a=this.byId("btnAceptar");const s=this.byId("btnBorrado");if(!a||!s)return;a.detachPress(this.onSave,this);a.removeAllCustomData();s.detachPress(this.onBorrador,this);s.removeAllCustomData();if(o==="display"){a.setEnabled(false);a.setText("Enviar");a.setType(sap.m.ButtonType.Accept);s.setEnabled(false);s.setText("Guardar como borrador");s.setType(sap.m.ButtonType.Emphasized);return}if(e==="modelBorrador"||o==="create"){this._isAprobacion=false;a.setEnabled(true);a.setText("Enviar");a.setType(sap.m.ButtonType.Accept);s.setIcon("sap-icon://save");a.attachPress(this.onSave,this);s.setEnabled(true);s.setText("Guardar como borrador");s.setType(sap.m.ButtonType.Emphasized);a.setIcon("");s.attachPress(this.onBorrador,this);var i=new Date;var r=i.getDay();var n=i.getHours();if(r===3&&n>=20){var c=this.byId("btnAceptar");c.setEnabled(false);d.error("El envío está deshabilitado los miércoles por revisión interna. Intenta mañana.",{title:"Envío bloqueado"});return}return}if(e==="modelPendientes"&&o==="edit"){this._isAprobacion=false;a.setEnabled(true);a.setText("Enviar");a.setType(sap.m.ButtonType.Accept);a.attachPress(this.onSave,this);s.setEnabled(true);s.setText("Guardar como borrador");s.setType(sap.m.ButtonType.Transparent);s.attachPress(this.onBorrador,this);s.setEnabled(false);return}a.setEnabled(true);a.setText("Enviar");a.setType(sap.m.ButtonType.Accept);a.attachPress(this.onSave,this);s.setEnabled(true);s.setText("Guardar como borrador");s.setType(sap.m.ButtonType.Transparent);s.attachPress(this.onBorrador,this);console.log("¿Botón deshabilitado3",s.getEnabled())},_fetchProjectData:async function(e){const t=this._sCsrfToken;const o=`/odata/v4/datos-cdo/DatosProyect(${e})`;const a=await fetch(o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","x-csrf-token":t}});if(!a.ok){const e=await a.text();throw new Error("Network response was not ok: "+e)}return await a.json()},_populateViewWithData:async function(e,t){const o=this.byId("btnBorrado");if(!e)return;var a=this.byId("23437");this.byId("input0").setValue(e.codigoProyect||"");this.byId("input1").setValue(e.nameProyect||"");this.byId("area0").setValue(e.datosExtra||"");this._setEstadoVisual(a,e.Estado);this.byId("inputCambioEu").setValue(e.CambioEuRUSD||"");this.byId("23d3").setText(e.Empleado||"");this.byId("ofertaCheckBox").setSelected(e.Oferta===true||e.Oferta==="true");this.byId("idComentariosFac").setValue(e.comentarioFacturacion||"");this.byId("idComentarioTipo").setValue(e.comentarioTipoCompra||"");this.byId("idCheckMensual").setSelected(!!e.mensual);this.byId("idTextComProve").setValue(e.comentarioProveedor||"");this.byId("idComenpVd").setValue(e.comentarioPvD||"");this.byId("dddtg").setText(e.Email||"");this.byId("int_clienteFun").setValue(e.funcionalString||"");this.byId("id_Cfactur").setValue(e.clienteFacturacion||"");this.byId("idObje").setValue(e.objetivoAlcance||"");this.byId("idDescripcion").setValue(e.descripcion||"");this.byId("input0_1725625161348").setValue(e.Total||"");this.byId("idAsunyRestri").setValue(e.AsuncionesyRestricciones||"");this.byId("box_multiJuridica").setSelected(!!e.multijuridica);this.byId("box_pluriAnual").setSelected(!!e.pluriAnual);await this.filterAreaFalse(e.Area_ID);await this.filterJefe(e.jefeProyectID_ID);this.byId("selectMotivo").setSelectedKey(e.MotivoCondi_ID||"");this.byId("select_tipoCom").setSelectedKey(e.TipoCompra_ID||"");this.filterVertical(e.Vertical_ID);await this.filterTipoIniciativa(e.Iniciativa_ID);await this.filterNaturaleza(e.Naturaleza_ID);await this.filterAMreceptor(e.AmReceptor_ID);await this.filterEjecucionVia(e.EjecucionVia_ID);await this.filterSeguimiento(e.Seguimiento_ID);await this.filterClienteNuevo(e.ClienteNuevo_ID);this.byId("date_inico").setDateValue(e.Fechainicio?new Date(e.Fechainicio):null);this.byId("date_fin").setDateValue(e.FechaFin?new Date(e.FechaFin):null);this.byId("box_pluriAnual").setSelected(e.pluriAnual);this.byId("id_Cfactur").setValue(e.clienteFacturacion);this.byId("box_multiJuridica").setSelected(e.multijuridica);const s=e.Iniciativa_ID;this.byId("table0").setVisible(s==="323e4567-e89b-12d3-a456-426614174002");this.byId("idCheckMensual").setVisible(s==="323e4567-e89b-12d3-a456-426614174002");this.byId("idComentarioTipo").setVisible(s==="323e4567-e89b-12d3-a456-426614174002");this.byId("idComenpVd").setEditable(s==="223e4567-e89b-12d3-a456-426614174001");this.onInputChange();await Promise.all([this.leerPlanificacion(this._sProjectID),this.leerPlanServicio(this._sProjectID),this.leerProveedor(this._sProjectID),this.leerFacturacion(this._sProjectID),this.leerClientFactura(this._sProjectID),this.leerRecursos(this._sProjectID),this.leerConsumoExterno(this._sProjectID),this.leerGastoViajeConsu(this._sProjectID),this.leerRecursoExterno(this._sProjectID),this.leerOtrosServiExter(this._sProjectID),this.leerOtrosConcepto(this._sProjectID),this.leerSerivioInterno(this._sProjectID),this.leerGastoviajeInterno(this._sProjectID),this.leerConsuOtroServi(this._sProjectID),this.leerGastoViaExter(this._sProjectID),this.leerLicencias(this._sProjectID),this.leerPerfilJornadas(this._sProjectID),this.leerTotalRecursoInterno(this._sProjectID),this.leerTotalConsumoExter(this._sProjectID),this.leerTotalRecuExterTotal(this._sProjectID),this.leerWorkflowInstancias(this._sProjectID),this.leerTotalInfraestrLicencia(this._sProjectID),this.leerTotalResumenCostesTotal(this._sProjectID),this.getArchivosByProjectId(this._sProjectID)]);this.highlightControls();const i=this.byId("btnAceptar");new sap.m.Dialog({title:"Información",type:"Message",state:"Success",content:new sap.m.Text({text:"Datos cargados correctamente"}),beginButton:new sap.m.Button({text:"OK",press:function(){this.getParent().close()}}),afterClose:function(){this.destroy()}}).open()},onVerArchivo:function(e){const t=e.getSource();const o=t.getBindingContext("archivosModel");if(!o){sap.m.MessageToast.show("    No se pudo obtener el contexto del archivo.");return}const a=o.getProperty("ID");const s=o.getProperty("nombre");const i=o.getProperty("tipoMime");if(!a||!s||!i){sap.m.MessageToast.show("    Faltan datos para abrir o descargar el archivo.");return}this._descargarArchivo(a,s,i)},_descargarArchivo:async function(e,t,o){try{const a=await fetch(`/odata/v4/datos-cdo/Archivos('${e}')/contenido/$value`,{method:"GET"});if(!a.ok){const e=await a.text();throw new Error("    Error al descargar archivo: "+e)}const s=await a.blob();const i=URL.createObjectURL(new Blob([s],{type:o}));if(o.startsWith("image/")||o==="application/pdf"||o.startsWith("text/")){const e=window.open();e.document.write(`<title>${t}</title><iframe src="${i}" width="100%" height="100%"></iframe>`)}const r=document.createElement("a");r.href=i;r.download=t||"archivo";document.body.appendChild(r);r.click();document.body.removeChild(r)}catch(e){console.error("    Error en descarga:",e)}},getArchivosByProjectId:async function(e){try{const t=`/odata/v4/datos-cdo/Archivos?$filter=datosProyect_ID eq '${e}'`;const o=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){const e=await o.text();throw new Error("Error en la respuesta de la API: "+e)}const a=await o.json();const s=a.value||[];const i=s.map(e=>e.ID);this._archivoIds=i;const r=new sap.ui.model.json.JSONModel({archivos:s});this.getView().setModel(r,"archivosModel")}catch(e){console.error("    Error al cargar archivos:",e);console.log(e.message)}},_clearAllInputs:async function(){const e=this.getView();const t=e.findElements(true);const o=e.getModel("planning");const a=e.getModel("dynamicInputs");var s=this.getView().getModel("fechasModel");if(!s){console.warn("No existe fechasModel, no se puede limpiar el VizFrame");return}s.setProperty("/chartData",[]);this._idWorkflowInstancias=null;this._idWorkIniciado=null;this._clearTableTextsOnly();this._IdFechasPorMesLicencia=null;this._IdFechasPorMesOtConp=null;this._IdFechasPorMesReEx=null;this._IdFechasPorMesSerReEx=null;this._IdFechasPorMesREExt=null;this._IdFechasPorMesGasViaConsuEx=null;this._IdFechasPorMesServiConsu=null;this._IdFechasPorMesConsuEx=null;this._IdFechasPorMesGVinter=null;this._IdFechasPorMesServInt=null;this._IdFechasPorMesGasViaConsuEx=[];this._IdFechasPorMes=[];this._RecursoInt=[];this._FacturacionID=null;this._aChartData=[];this._proveedoresIDs=[];this._recursosIDs=[];this._consumoExternosIDs=[];this._RecursoExterno=null;this._OtrosConceptos=null;this._idServiInterno=null;this._IdGastoViajInter=null;this._idConsuOtrser=null;this._idGastoViajeCOnsu=null;this._idOtroSerEx=null;this._idGasViaReEx=null;this._idLicencia=null;this._idJornadas=null;this._idTotalRecInter=null;this._selectedFile=null;const i=["tablaConsuExter","table_dimicFecha","tablaRecExterno","idOtroserConsu","idGastoViajeConsu","idServiExterno","idGastoRecuExter","tablaInfrestuctura","tablaLicencia","tableServicioInterno","tablGastoViajeInterno"];i.forEach(e=>{const t=this.byId(e);if(t){const e=t.getColumns();for(let o=e.length-1;o>=0;o--){const a=e[o].getHeader();if(a&&/\d{4}-\w+/.test(a.getText())){t.removeColumn(e[o])}}t.getItems().forEach(t=>{const o=t.getCells();for(let a=o.length-1;a>=0;a--){const s=o[a];const i=e[a]&&e[a].getHeader()?.getText();if(/\d{4}-\w+/.test(i)){t.removeCell(s)}}})}});const r=["txt_codig","txt_nomPro","txt_area","txt_NomJefe","txt_funcio","txt_feIni","txt_feFin","txt_ini","text72_1731325324246","text73_1731325328049","txt_client","txt_cFactura","txt_Codi2","txt_Nombre2","txt_area2","txt_Fe_ini2","txt_Fe_fin2","textClitFu3","textCliFac3","textCodigo3","textNatural3","txtNombre3","txtAre3","txtFechInici3","txtFechFin3"];r.forEach(e=>{const t=this.byId(e);if(t&&typeof t.setText==="function"){t.setText("")}});const n=["inputReInter","inputConsuEx","inputRcurExtern","inputTotalJor","inputServi1","inputOtrosServi1","inputGastoVia1","totalRecuInter","inputServi2","inputOtroSer2","input2_1756121205","inptGastoVi2","inputServi","input10_1724757017406","input9_1724757015442","totalInfraestruc","input0_1724758359","input0_1725625161348","input0_1725625132423424361348","totaRecurExterno","input0","totalConsuExternot","idComenpVd","idTextComProve","input0_1724758359","totalSubtotal","input2_1724756105"];t.forEach(e=>{if(e instanceof sap.m.Input||e instanceof sap.m.TextArea){e.setValue("")}else if(e instanceof sap.m.Select){e.setSelectedKey("")}else if(e instanceof sap.m.DatePicker){e.setDateValue(null);e.setValue("")}else if(e instanceof sap.m.CheckBox){e.setSelected(false)}const t=e.getId().split("--").pop();const o=n.includes(t);if(!o){if(typeof e.setEditable==="function"){e.setEditable(true)}if(typeof e.setEnabled==="function"){e.setEnabled(true)}}});const c=["table0","idCheckMensual","idComentarioTipo","table_clienteFac"];c.forEach(e=>{const t=this.byId(e);if(t){t.setVisible(false)}});this.byId("text73_172746565340567").setText("");this.byId("text73_172746565340569997").setText("");if(o){o.setProperty("/chartData",[]);o.setProperty("/chartModel",[])}if(a){a.setData({});a.refresh(true)}const l=this.getView().getModel("archivosModel");if(l){l.setProperty("/archivos",[])}this.refreshODataModel();i.forEach(e=>{const t=this.byId(e);if(t){const e=t.getColumns();for(let o=e.length-1;o>=0;o--){const a=e[o].getHeader();if(a&&/\d{4}-\w+/.test(a.getText())){t.removeColumn(e[o])}}t.getItems().forEach(t=>{const o=t.getCells();for(let a=o.length-1;a>=0;a--){const s=o[a];const i=e[a]&&e[a].getHeader()?.getText();if(/\d{4}-\w+/.test(i)){t.removeCell(s)}}});t.invalidate()}})},_clearAllInputsEdit:async function(){await this._clearTableTextsOnly();const e=this.getView();const t=e.findElements(true);const o=e.getModel("planning");const a=e.getModel("dynamicInputs");if(a){a.setData({});a.refresh(true)}this._IdFechasPorMesGasViaConsuEx=[];this._IdFechasPorMes=[];this._RecursoInt=[];this._FacturacionID=null;this._aChartData=[];this._proveedoresIDs=[];this._recursosIDs=[];this._consumoExternosIDs=[];this._RecursoExterno=null;this._OtrosConceptos=null;this._idServiInterno=null;this._IdGastoViajInter=null;this._idConsuOtrser=null;this._idGastoViajeCOnsu=null;this._idOtroSerEx=null;this._idGasViaReEx=null;this._idLicencia=null;this._idJornadas=null;this._idTotalRecInter=null;this._selectedFile=null;const s=["inputReInter","inputConsuEx","inputRcurExtern","inputTotalJor","inputServi1","inputOtrosServi1","inputGastoVia1","totalRecuInter","inputServi2","inputOtroSer2","inptGastoVi2","inputServi","input10_1724757017406","input9_1724757015442","totalSubtotal","input2_1724756105","input0_1724758359","totalInfraestruc","totaRecurExterno","input0","totalConsuExternot","idComenpVd","idTextComProve , input0_1724758359","input2_1756121205","input0_1725625161348","input0_1725625132423424361348"];t.forEach(e=>{const t=e.getId().split("--").pop();const o=s.includes(t);if(!o){if(typeof e.setEditable==="function"){e.setEditable(true)}if(typeof e.setEnabled==="function"){e.setEnabled(true)}}})},_clearTableTextsOnly:function(){const e=this.getView();const t=["tablaConsuExter","table_dimicFecha","tablaRecExterno","idOtroserConsu","idGastoViajeConsu","idServiExterno","idGastoRecuExter","tablaInfrestuctura","tablaLicencia","tableServicioInterno","tablGastoViajeInterno"];t.forEach(e=>{const t=this.byId(e);if(!t){console.warn(`Tabla no encontrada: ${e}`);return}const o=t.getColumns();const a=t.getItems();a.forEach(e=>{const t=e.getCells();t.forEach((e,t)=>{const a=o[t]&&o[t].getHeader()?.getText();const s=/\d{4}-\w+/.test(a);if(typeof e.setValue==="function"){e.setValue("")}if(typeof e.setText==="function"){e.setText("")}if(typeof e.setSelectedKey==="function"){e.setSelectedKey("")}})})})},_onDecisionPress:function(e){const t=e.getSource().data("valor");const o=t==="approve"?"aprobar":"rechazar";const a=t==="approve"?"Aprobación":"Rechazo";console.log("DECISIÓN:",t);const s=new sap.m.TextArea({width:"100%",placeholder:"Puede escribir un comentario (opcional)...",rows:4});const i=new sap.m.Dialog({title:"Confirmar "+a,type:"Message",content:[new sap.m.Text({text:`¿Está seguro de que desea ${o} este proyecto?`}),new sap.m.Label({text:"Comentario:",labelFor:s}),s],beginButton:new sap.m.Button({text:" Confirmar",type:sap.m.ButtonType.Emphasized,press:function(){const e=s.getValue();console.log(" Comentario ingresado: ",e);i.close();const o=t==="approve"?"Enviando aprobación":"Enviando rechazo";const a=t==="approve"?"Enviando su aprobación, por favor espere...":"Enviando su rechazo, por favor espere...";if(!this._oBusyDialog){this._oBusyDialog=new sap.m.BusyDialog({title:o,text:a})}else{this._oBusyDialog.setTitle(o);this._oBusyDialog.setText(a)}this._oBusyDialog.open();this._completarWorkflow(t,e).then(()=>{this._oBusyDialog.close();sap.m.MessageBox.information("La decisión fue enviada correctamente. Puede ir a la aplicación para ver el estado del proceso.",{title:"Proceso enviado",onClose:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("appNoparame")}.bind(this)})}).catch(e=>{this._oBusyDialog.close();console.error("Error completando workflow:",e);sap.m.MessageBox.error("Hubo un error procesando la aprobación.")})}.bind(this)}),endButton:new sap.m.Button({text:"Cancelar",press:function(){i.close()}}),afterClose:function(){i.destroy()}});i.open()},_Visualizar:async function(e,t){const o=this.byId("btnAceptar");const a=this.byId("btnBorrado");o.detachPress(this.onSave,this);o.setIcon("");o.removeAllCustomData();a.detachPress(this.onBorrador,this);o.setIcon("");a.removeAllCustomData();const s=this.byId("idDelete");if(t==="modelEtapasAsignadas"){this._isAprobacion=true;s.setVisible(false);o.detachPress(this._onDecisionPress,this);o.setText("Aprobar");o.setType(sap.m.ButtonType.Accept);o.setIcon("sap-icon://accept");o.data("valor","approve");o.attachPress(this._onDecisionPress,this);a.detachPress(this._onDecisionPress,this);a.setText("Rechazar");a.setType(sap.m.ButtonType.Reject);a.setIcon("sap-icon://decline");a.data("valor","reject");a.attachPress(this._onDecisionPress,this)}else{o.setEnabled(false);a.setEnabled(false)}this._configureButtonsForView();const i=this._sCsrfToken;const r=this.getView().getModel("mainService");if(r){r.setData({});r.refresh(true)}this._sProjectID=e;const n=`/odata/v4/datos-cdo/DatosProyect('${e}')`;try{const t=await fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","x-csrf-token":i}});if(!t.ok){const e=await t.text();throw new Error("Network response was not ok: "+e)}const o=await t.json();if(o){this._fillControlsWithData(o);await Promise.all([this.leerPlanificacion(e),this.leerPlanServicio(e),this.leerProveedor(e),this.leerFacturacion(e),this.leerClientFactura(e),this.leerRecursos(e),this.leerConsumoExterno(e),this.leerGastoViajeConsu(e),this.leerRecursoExterno(e),this.leerOtrosServiExter(e),this.leerOtrosConcepto(e),this.leerSerivioInterno(e),this.leerGastoviajeInterno(e),this.leerConsuOtroServi(e),this.leerGastoViaExter(e),this.leerLicencias(e),this.leerPerfilJornadas(e),this.leerTotalRecursoInterno(e),this.leerTotalConsumoExter(e),this.leerTotalRecuExterTotal(e),this.leerWorkflowInstancias(e),this.leerTotalInfraestrLicencia(e),this.leerTotalResumenCostesTotal(e)]);this.highlightControls();this._setAllControlsEditable(false);this._showSuccessDialog("Datos cargados correctamente")}}catch(e){console.error("Error al obtener los datos del proyecto:",e);sap.m.MessageToast.show("Error al cargar los datos del proyecto")}},_configureButtonsForView:function(){if(this._isAprobacion){return}const e=this.byId("btnAceptar");const t=this.byId("btnBorrado");const o=this.byId("idDelete");e.setEnabled(false);t.setEnabled(false);o.setEnabled(false);e.setText("Enviar");e.setType(sap.m.ButtonType.Accept);t.setText("Guardar como borrador");t.setType(sap.m.ButtonType.Emphasized)},_fillControlsWithData:async function(e){var t=this.byId("23437");this.byId("input0").setValue(e.codigoProyect||"");this.byId("input1").setValue(e.nameProyect||"");this.byId("area0").setValue(e.datosExtra||"");this.byId("inputCambioEu").setValue(e.CambioEuRUSD||"");this._setEstadoVisual(t,e.Estado);this.byId("ofertaCheckBox").setSelected(e.Oferta===true||e.Oferta==="true");this.byId("23d3").setText(e.Empleado||"");this.byId("idComentariosFac").setValue(e.comentarioFacturacion||"");this.byId("idComentarioTipo").setValue(e.comentarioTipoCompra||"");this.byId("idCheckMensual").setSelected(!!e.mensual);this.byId("idTextComProve").setValue(e.comentarioProveedor||"");this.byId("idComenpVd").setValue(e.comentarioPvD||"");this.byId("dddtg").setText(e.Email||"");this.byId("int_clienteFun").setValue(e.funcionalString||"");this.byId("id_Cfactur").setValue(e.clienteFacturacion||"");this.byId("idObje").setValue(e.objetivoAlcance||"");this.byId("idDescripcion").setValue(e.descripcion||"");this.byId("input0_1725625161348").setValue(e.Total||"");this.byId("idAsunyRestri").setValue(e.AsuncionesyRestricciones||"");this.byId("box_multiJuridica").setSelected(!!e.multijuridica);this.byId("box_pluriAnual").setSelected(!!e.pluriAnual);this.byId("slct_area").setSelectedKey(e.Area_ID||"");this.byId("slct_Jefe").setSelectedKey(e.jefeProyectID_ID||"");this.byId("selectMotivo").setSelectedKey(e.MotivoCondi_ID||"");this.byId("select_tipoCom").setSelectedKey(e.TipoCompra_ID||"");this.byId("slct_verti").setSelectedKey(e.Vertical_ID||"");this.byId("slct_inic").setSelectedKey(e.Iniciativa_ID||"");this.byId("idNatu").setSelectedKey(e.Naturaleza_ID||"");this.byId("selct_Amrecp").setSelectedKey(e.AmReceptor_ID||"");this.byId("selc_ejcu").setSelectedKey(e.EjecucionVia_ID||"");this.byId("selc_Segui").setSelectedKey(e.Seguimiento_ID||"");this.byId("slct_client").setSelectedKey(e.ClienteNuevo_ID||"");this.byId("date_inico").setDateValue(e.Fechainicio?new Date(e.Fechainicio):null);this.byId("date_fin").setDateValue(e.FechaFin?new Date(e.FechaFin):null);await this.onInputChange();if(e.Iniciativa_ID==="323e4567-e89b-12d3-a456-426614174002"){this.byId("table0").setVisible(true);this.byId("idCheckMensual").setVisible(true);this.byId("idComentarioTipo").setVisible(true)}else{this.byId("table0").setVisible(false);this.byId("idCheckMensual").setVisible(false);this.byId("idComentarioTipo").setVisible(false)}this.byId("idComenpVd").setEditable(e.Iniciativa_ID==="223e4567-e89b-12d3-a456-426614174001")},_showSuccessDialog:function(e){var t=new sap.m.Dialog({title:"Información",type:"Message",state:"Success",content:new sap.m.Text({text:e}),beginButton:new sap.m.Button({text:"OK",press:function(){t.close()}}),afterClose:function(){t.destroy()}});t.open()},_setEstadoVisual:function(e,t){e.setText(t||"");switch((t||"").toLowerCase()){case"aprobado":e.setState(sap.ui.core.ValueState.Success);break;case"rechazado":e.setState(sap.ui.core.ValueState.Error);break;case"borrador":e.setState(sap.ui.core.ValueState.None);break;case"pendiente":default:e.setState(sap.ui.core.ValueState.Warning);break}},_setAllControlsEditable:function(e){const t=this.getView();const o=["sap.m.Input","sap.m.TextArea","sap.m.Select","sap.m.CheckBox","sap.m.DatePicker"];o.forEach(o=>{t.findAggregatedObjects(true,function(e){return e.isA&&e.isA(o)}).forEach(function(t){if(t.setEditable){t.setEditable(e)}else if(t.setEnabled){t.setEnabled(e)}})})},enviarID:async function(e){const t=e;if(!t){d.error("No se ha definido el ID del workflow.");return}const o=this.getOwnerComponent().getModel();const a=o.bindContext(`/registrarTareasWorkflow(workflowInstanceId='${e}')`);try{await a.execute();const e=a.getBoundContext().getObject()}catch(e){d.error("Error al registrar tareas:\n"+e.message)}},_completarWorkflow:async function(e,t){const o=this._idWorkIniciado;const a=this._sProjectID;const s="Carolina Falen";if(!o){sap.m.MessageBox.error("No se encontró el ID del flujo de trabajo.");return}const i=this.getOwnerComponent().getModel();const r=i.bindContext("/completeWorkflow(...)");r.setParameter("workflowInstanceId",o);r.setParameter("decision",e);r.setParameter("usuario",s);r.setParameter("idProject",a);r.setParameter("comentario",t);r.setParameter("comentariopmo",t);try{await r.execute();const t=this._idWorkflowInstancias;if(!t){sap.m.MessageBox.error("No se encontró el ID de la instancia de workflow para actualizar el estado.");return}const o=`/odata/v4/datos-cdo/WorkflowInstancias(${t})`;let a;if(e==="approve"){a="Aprobado"}else if(e==="reject"){a="Rechazado"}else{a="Desconocido"}const s=(new Date).toISOString();const i=await fetch(o,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","x-csrf-token":this._sCsrfToken},body:JSON.stringify({estado:a,actualizadoEn:s})});if(!i.ok){const e=await i.text();throw new Error("Error actualizando el estado del proyecto: "+e)}}catch(e){sap.m.MessageBox.error("Error al completar el workflow: "+e.message)}},leerPlanificacion:async function(e){if(!e){console.error("Error: projectID es inválido o indefinido:",e);return}var t=`/odata/v4/datos-cdo/planificacion?$filter=datosProyect_ID eq '${e}'`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Error en la respuesta de la API: "+t)}const a=await e.json();if(!a||!a.value||!Array.isArray(a.value)||a.value.length===0){return}a.value.sort((e,t)=>new Date(e.fecha_inicio)-new Date(t.fecha_inicio));var o=this.getView().getModel("planning");let s={};a.value.forEach(e=>{let t=e.fecha_inicio?new Date(e.fecha_inicio).toISOString().split("T")[0]:null;let o=e.fecha_fin?new Date(e.fecha_fin).toISOString().split("T")[0]:null;s[e.hito]={fechaInicio:t,fechaFin:o}});const i=["Kick off","Diseño","Construcción","Pruebas TQ","Go live","Paso AM","Server post/prod"];i.forEach((e,t)=>{let a=`/milestones/${t}`;if(s[e]){o.setProperty(a+"/fechaInicio",s[e].fechaInicio);o.setProperty(a+"/fechaFin",s[e].fechaFin)}else{o.setProperty(a+"/fechaInicio",null);o.setProperty(a+"/fechaFin",null)}});this._idPlani=a.value[0].ID;this.updateVizFrame1(a)}catch(e){console.error("Error al obtener los datos de planificación:",e)}},leerPlanServicio:async function(e){if(!e){console.error("Error: projectID es inválido o indefinido:",e);return}var t=`/odata/v4/datos-cdo/planServicio?$filter=datosProyect_ID eq '${e}'`;try{const a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){const n=await a.text();throw new Error("Error en la respuesta de la API: "+n)}const s=await a.json();if(!s||!s.value||!Array.isArray(s.value)||s.value.length===0){console.warn("No se encontraron datos de planServicio para el proyecto:",e);return}s.value.sort((e,t)=>new Date(e.fecha_inicio)-new Date(t.fecha_inicio));var o=this.getView().getModel("fechasModel");if(!o){o=new sap.ui.model.json.JSONModel;this.getView().setModel(o,"fechasModel")}const i=s.value.map(e=>{let t=e.fecha_inicio?new Date(e.fecha_inicio).toISOString().split("T")[0]:null;let o=e.fecha_fin?new Date(e.fecha_fin).toISOString().split("T")[0]:null;return{fase:e.hito,duracion:e.duracion,label:`Inicio: ${t} - Fin: ${o}`}});o.setProperty("/chartData",i);function r(e){if(!e)return null;const t=new Date(e);return t.toISOString().split("T")[0]}o.setProperty("/fechas",[{fechaInicio:r(s.value[0].fecha_inicio),fechaFin:r(s.value[0].fecha_fin)}]);this._idPlanServicio=s.value[0].ID}catch(c){console.error("Error al obtener los datos de planServicio:",c)}},leerProveedor:async function(e){var t=`/odata/v4/datos-cdo/ProveedoresC?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}this.byId("idTextComProve").setEditable(false);const s=await e.json();var o=this.byId("table2");var a=o.getItems();this._proveedoresIDs=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{var o=a[t];if(o){var s=o.getCells();if(s.length>1){s[0].setValue(e.valueCondi||"");s[1].setValue(e.valueProvee||"")}this._proveedoresIDs[t]=e.ID}});this.byId("box_condi").setSelected(s.value[0].checkCondi||false);this.byId("box_prove").setSelected(s.value[0].checkProveedor||false)}else{}}catch(e){console.error("Error al obtener los datos de proveedor:",e)}},leerFacturacion:async function(e){var t=`/odata/v4/datos-cdo/Facturacion?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("table0");var a=o.getItems();if(s.value&&s.value.length>0){s.value.forEach(function(e,t){var o=a[t];var s=o.getCells();if(a[t]){var s=a[t].getCells();if(s.length>1){if(s[0]instanceof sap.m.DatePicker){s[0].setDateValue(e.fechaEstimida?new Date(e.fechaEstimida):null)}if(s[1]instanceof sap.m.Input){s[1].setValue(e.descripcionHito||"")}if(s[2]instanceof sap.m.Input){s[2].setValue(Math.round(e.facturacion))}}}});if(s.value[0]&&s.value[0].ID){this._FacturacionID=s.value[0].ID}this.metodoSumarFac()}else{}}catch(e){console.error("Error al obtener los datos de Facturación:",e)}},leerClientFactura:async function(e){var t=`/odata/v4/datos-cdo/ClientFactura?$filter=datosProyect_ID eq ${e}&$orderby=ID asc`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const c=await e.json();var o=this.byId("table_clienteFac");var a=o.getItems();if(c.value&&c.value.length>0){let e=c.value.sort((e,t)=>e.ID-t.ID);for(let t=0;t<e.length;t++){let r=e[t];if(t>=a.length){let e=new sap.m.ColumnListItem({cells:[new sap.m.Input({value:r.juridica||""}),new sap.m.Input({value:r.oferta?`${r.oferta}%`:""})]});o.addItem(e);a.push(e)}var s=a[t];var i=s.getCells();if(i[0].getMetadata().getName()==="sap.m.Input"){i[0].setValue(r.juridica||"")}else if(i[0].getMetadata().getName()==="sap.m.Text"){i[0].setText(r.juridica||"")}if(i[1].getMetadata().getName()==="sap.m.Input"){let e=r.oferta?r.oferta.toString():"";e=e.replace("%","");i[1].setValue(e?`${e}%`:"")}else if(i[1].getMetadata().getName()==="sap.m.Text"){i[1].setText(r.oferta?`${r.oferta}%`:"")}}}this.metodoSumar();var r=this.byId("box_multiJuridica");var n=r.getSelected();this.onCheckBoxSelectMulti({getSource:()=>r,getSelected:()=>n})}catch(e){console.error("Error al obtener los datos de cliente Facturación:",e)}},leerWorkflowInstancias:async function(e){var t=`/odata/v4/datos-cdo/WorkflowInstancias?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const i=await e.json();if(i.value&&i.value.length>0){var o=i.value[0];var a=o.ID;var s=o.workflowId;this._idWorkIniciado=s;this._idWorkflowInstancias=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerRecursos:async function(e){var t=`/odata/v4/datos-cdo/RecursosInternos?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("table_dimicFecha");var a=o.getItems();this._recursosIDs=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._recursosIDs[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[2].setSelectedKey(e.PerfilServicio_ID||"");this.filterPerfilServiDinamicas(e.PerfilServicio_ID,s[2]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalE?parseFloat(e.totalE).toFixed(2):"0.00")}})}await this.fechasDinamicas();await this.leerFechas()}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e);sap.m.MessageToast.show("Error al cargar los datos de Recursos Internos")}},leerPerfilJornadas:async function(e){var t=`/odata/v4/datos-cdo/PerfilTotal?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("inputReInter").setValue(o.totalJorRI?parseFloat(o.totalJorRI).toFixed(2):"0.00");this.byId("inputConsuEx").setValue(o.totalJorCE?parseFloat(o.totalJorCE).toFixed(2):"0.00");this.byId("inputRcurExtern").setValue(o.totalJorRE?parseFloat(o.totalJorRE).toFixed(2):"0.00");this.byId("inputTotalJor").setValue(o.Total?parseFloat(o.Total).toFixed(2):"0.00");this._idJornadas=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerTotalRecursoInterno:async function(e){var t=`/odata/v4/datos-cdo/RecurInterTotal?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("inputServi1").setValue(o.servicios?parseFloat(o.servicios).toFixed(2):"0.00");this.byId("inputOtrosServi1").setValue(o.OtrosServicios?parseFloat(o.OtrosServicios).toFixed(2):"0.00");this.byId("inputGastoVia1").setValue(o.GastosdeViaje?parseFloat(o.GastosdeViaje).toFixed(2):"0.00");this.byId("totalRecuInter").setValue(o.Total?parseFloat(o.Total).toFixed(2):"0.00");this._idTotalRecInter=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerTotalConsumoExter:async function(e){var t=`/odata/v4/datos-cdo/ConsuExterTotal?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("inputServi2").setValue(o.servicios?parseFloat(o.servicios).toFixed(2):"0.00");this.byId("inputOtroSer2").setValue(o.OtrosServicios?parseFloat(o.OtrosServicios).toFixed(2):"0.00");this.byId("inptGastoVi2").setValue(o.GastosdeViaje?parseFloat(o.GastosdeViaje).toFixed(2):"0.00");this.byId("totalConsuExternot").setValue(o.Total?parseFloat(o.Total).toFixed(2):"0.00");this._idTotalConsuEx=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerTotalRecuExterTotal:async function(e){var t=`/odata/v4/datos-cdo/RecuExterTotal?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("inputServi").setValue(o.servicios?parseFloat(o.servicios).toFixed(2):"0.00");this.byId("input10_1724757017406").setValue(o.OtrosServicios?parseFloat(o.OtrosServicios).toFixed(2):"0.00");this.byId("input9_1724757015442").setValue(o.GastosdeViaje?parseFloat(o.GastosdeViaje).toFixed(2):"0.00");this.byId("totaRecurExterno").setValue(o.Total?parseFloat(o.Total).toFixed(2):"0.00");this._idtotalRecurExter=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerTotalInfraestrLicencia:async function(e){var t=`/odata/v4/datos-cdo/InfraestrLicencia?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("totalInfraestruc").setValue(o.totalInfraestruc?parseFloat(o.totalInfraestruc).toFixed(2):"0.00");this.byId("input0_1724758359").setValue(o.totalLicencia?parseFloat(o.totalLicencia).toFixed(2):"0.00");this._idInfraLicencia=a}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerTotalResumenCostesTotal:async function(e){var t=`/odata/v4/datos-cdo/ResumenCostesTotal?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();if(s.value&&s.value.length>0){var o=s.value[0];var a=o.ID;this.byId("totalSubtotal").setValue(o.Subtotal?parseFloat(o.Subtotal).toFixed(2):"0.00");this.byId("input2_172475612").setValue(o.CosteEstruPorce?parseFloat(o.CosteEstruPorce).toFixed(2):"0.00");this.byId("input2_1724756105").setValue(o.Costeestructura?parseFloat(o.Costeestructura).toFixed(2):"0.00");this.byId("input2_17221205").setValue(o.totalLicencias?parseFloat(o.totalLicencias).toFixed(2):"0.00");this.byId("input2_1756121205").setValue(o.Margeingresos?parseFloat(o.Margeingresos).toFixed(2):"0.00");this._ResumenTotal=a;this.onColumnTotales()}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerFechas:async function(){const e=this._recursosIDs;const t={};const o={};const a=e.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuReInter?$filter=RecursosInternos_ID eq '${e}'`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});const i=await s.json();if(i.value&&i.value.length>0){}else{console.warn(`    Sin resultados para recursoID ${e}`)}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMes=o;this.rellenarInputsConFechas("table_dimicFecha",t,r);return{recursoID:e,data:i.value||[]}}catch(t){console.error(`    Error en consulta para recursoID ${e}:`,t);return{recursoID:e,error:t}}});const s=await Promise.all(a)},rellenarInputsConFechas:function(e,t,o){const a=this._inputsDinamicos?.[e]?.[t];if(!a){console.warn(`No existen inputs dinámicos para tabla ${e} fila ${t}`);return}for(const[s,i]of Object.entries(o)){const o=a[s];if(o){const e=Number(i).toFixed(2);o.setValue(e);o.fireChange({value:e})}else{console.warn(`No se encontró input para la fecha ${s} en tabla ${e}, fila ${t}`)}}},leerFechasServiRecInter:async function(){const e=this._idServiInterno;const t={};const o={};const a=e.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuServReInter?$filter=otrosGastoRecu_ID eq '${e}'`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});const i=await s.json();if(i.value&&i.value.length>0){}else{console.warn(`    Sin resultados para servicioID ${e}`)}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMesServInt=o;this.rellenarInputsConFechas("tableServicioInterno",t,r);return{servicioID:e,data:i.value||[]}}catch(t){console.error(`    Error en consulta para servicioID ${e}:`,t);return{servicioID:e,error:t}}});const s=await Promise.all(a)},leerFechasGastoViajeRecInter:async function(){const e=this._IdGastoViajInter;const t={};const o={};const a=Array.isArray(e)?e:[e];const s=a.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuGastViaReInter?$filter=otrosRecursos_ID eq '${e}'`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});const i=await s.json();if(i.value&&i.value.length>0){}else{console.warn(`    Sin resultados para recursoID ${e}`)}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMesGVinter=o;this._idGastInterno=i.value[0]?.ID||null;this.rellenarInputsConFechas("tablGastoViajeInterno",t,r);return{recursoID:e,data:i.value||[]}}catch(t){console.error(`    Error en consulta para recursoID ${e}:`,t);return{recursoID:e,error:t}}});const i=await Promise.all(s)},leerFechasConsumoExterno:async function(){const e=this._consumoExternosIDs;const t={};const o={};const a=e.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuConsuEx?$filter=ConsumoExternos_ID eq '${e}'`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});const i=await s.json();if(i.value&&i.value.length>0){}else{console.warn(`    Sin resultados para consumoID ${e}`)}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMesConsuEx=o;this.rellenarInputsConFechas("tablaConsuExter",t,r);return{consumoID:e,data:i.value||[]}}catch(t){console.error(`    Error en consulta para consumoID ${e}:`,t);return{consumoID:e,error:t}}});const s=await Promise.all(a)},leerFechasServConsumoExterno:async function(){const e=this._idConsuOtrser;const t={};const o={};const a=e.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuServConsuEx?$filter=otrosServiciosConsu_ID eq '${e}'`;console.log(`  Consultando URL para servicioID: ${e}`);try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error al consultar el servicio: "+e)}const i=await s.json();if(i.value&&i.value.length>0){}else{console.warn(`    Sin resultados para servicioID ${e}`)}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMesServiConsu=o;this.rellenarInputsConFechas("idOtroserConsu",t,r);return{servicioID:e,data:i.value||[]}}catch(t){console.error(`    Error en consulta para servicioID ${e}:`,t);return{servicioID:e,error:t}}});const s=await Promise.all(a)},leerFechasGastoConsumoExterno:async function(){const e=this._idGastoViajeCOnsu;const t={};const o={};const a=e.map(async(e,t)=>{const a=`/odata/v4/datos-cdo/ValorMensuGastoViaConsuEx?$filter=GastoViajeConsumo_ID eq '${e}'`;console.log(`  Consultando URL para gastoID: ${e}`);try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();if(!i.value||i.value.length===0){console.warn(`    Sin datos encontrados para gastoID: ${e}`);return{gastoID:e,data:[]}}const r={};i.value.forEach(e=>{const t=e.mesAno;r[t]=e.valor;o[t]=e.ID});this._IdFechasPorMesGasViaConsuEx=o;this.rellenarInputsConFechas("idGastoViajeConsu",t,r);return{gastoID:e,data:i.value}}catch(t){console.error(`    Error al consultar gastoID ${e}:`,t);return{gastoID:e,error:t}}});const s=await Promise.all(a)},leerFechasRecursoExterno:async function(){const e=this._RecursoExterno;const t={};const o=e.map(async(e,o)=>{const a=`/odata/v4/datos-cdo/ValorMensuRecuExter?$filter=RecursosExternos_ID eq ${e}`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();if(!i.value||i.value.length===0){console.warn(`    Sin datos encontrados para recurso externo ID: ${e}`);return{recursoID:e,data:[]}}const r={};i.value.forEach(e=>{const o=e.mesAno;r[o]=e.valor;t[o]=e.ID});this._IdFechasPorMesREExt=t;this.rellenarInputsConFechas("tablaRecExterno",o,r);return{recursoID:e,data:i.value}}catch(t){console.error(`    Error al consultar recurso externo ID ${e}:`,t);return{recursoID:e,error:t}}});const a=await Promise.all(o)},leerFechasServRecursoExterno:async function(){const e=this._idOtroSerEx;const t={};const o=e.map(async(e,o)=>{const a=`/odata/v4/datos-cdo/ValorMensuSerExter?$filter=ServiRecurExterno_ID eq ${e}`;console.log(`  URL consultada para ServiRecurExterno_ID: ${e}`);try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();if(!i.value||i.value.length===0){console.warn(`    No hay datos de ValorMensuSerExter para el ID: ${e}`);return{servID:e,data:[]}}let r={};i.value.forEach(e=>{const o=e.mesAno;r[o]=e.valor;t[o]=e.ID});this._IdFechasPorMesSerReEx=t;this.rellenarInputsConFechas("idServiExterno",o,r);return{servID:e,data:i.value}}catch(t){console.error(`    Error al consultar ServiRecurExterno_ID ${e}:`,t);return{servID:e,error:t}}});const a=await Promise.all(o)},leerFechasGastoRecursoExterno:async function(){const e=this._idGasViaReEx;const t={};const o=e.map(async(e,o)=>{const a=`/odata/v4/datos-cdo/ValorMensuGastoViExter?$filter=GastoViajeRecExter_ID eq ${e}`;console.log(`  URL consultada para GastoViajeRecExter_ID: ${e}`);try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();if(!i.value||i.value.length===0){console.warn(`    No hay datos de ValorMensuGastoViExter para el ID: ${e}`);return{gastoID:e,data:[]}}let r={};i.value.forEach(e=>{const o=e.mesAno;r[o]=e.valor;t[o]=e.ID});this._IdFechasPorMesReEx=t;this.rellenarInputsConFechas("idGastoRecuExter",o,r);return{gastoID:e,data:i.value}}catch(t){console.error(`    Error al consultar GastoViajeRecExter_ID ${e}:`,t);return{gastoID:e,error:t}}});const a=await Promise.all(o)},leerGastoviajeInterno:async function(e){var t=`/odata/v4/datos-cdo/otrosRecursos?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("tablGastoViajeInterno");var a=o.getItems();this._IdGastoViajInter=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._IdGastoViajInter[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalE?parseFloat(e.totalE).toFixed(2):"0.00")}}});await this.leerFechasGastoViajeRecInter()}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerSerivioInterno:async function(e){var t=`/odata/v4/datos-cdo/otrosGastoRecu?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("tableServicioInterno");var a=o.getItems();this._idServiInterno=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idServiInterno[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalE?parseFloat(e.totalE).toFixed(2):"0.00")}}});await this.leerFechasServiRecInter()}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerConsumoExterno:async function(e){var t=`/odata/v4/datos-cdo/ConsumoExternos?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("tablaConsuExter");var a=o.getItems();this._consumoExternosIDs=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._consumoExternosIDs[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[2].setSelectedKey(e.PerfilConsumo_ID||"");s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.totalC).toFixed(2):"0.00")}}});for(let e=0;e<this._consumoExternosIDs.length;e++){const t=this._consumoExternosIDs[e];await this.leerFechasConsumoExterno(t)}}else{}}catch(e){console.error("Error al obtener los datos de Consumo Externo:",e)}},leerConsuOtroServi:async function(e){var t=`/odata/v4/datos-cdo/otrosServiciosConsu?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("idOtroserConsu");var a=o.getItems();this._idConsuOtrser=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idConsuOtrser[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});for(let e of this._idConsuOtrser){await this.leerFechasServConsumoExterno(e)}}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerGastoViajeConsu:async function(e){var t=`/odata/v4/datos-cdo/GastoViajeConsumo?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("idGastoViajeConsu");var a=o.getItems();this._idGastoViajeCOnsu=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idGastoViajeCOnsu[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});this.leerFechasGastoConsumoExterno()}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerRecursoExterno:async function(e){var t=`/odata/v4/datos-cdo/RecursosExternos?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}this._RecursoExterno=[];const i=await e.json();var o=this.byId("tablaRecExterno");var a=o.getItems();if(i.value&&i.value.length>0){i.value.forEach((e,t)=>{this._RecursoExterno[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[2].setValue(e.PerfilServicio||"");s[3].setValue(e.ConceptoOferta||"");s[4].setValue(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.totalC).toFixed(2):"0.00")}}});var s=i.value[0].ID;await this.leerFechasRecursoExterno(s)}else{}}catch(e){console.error("Error al obtener los datos de Recursos Externos:",e)}},leerOtrosServiExter:async function(e){var t=`/odata/v4/datos-cdo/serviRecurExter?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("idServiExterno");var a=o.getItems();this._idOtroSerEx=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idOtroSerEx[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});await this.leerFechasServRecursoExterno()}else{}}catch(e){console.error("Error al obtener los datos de serviRecurExter:",e)}},leerGastoViaExter:async function(e){var t=`/odata/v4/datos-cdo/GastoViajeRecExter?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("idGastoRecuExter");var a=o.getItems();this._idGasViaReEx=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idGasViaReEx[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[1].setSelectedKey(e.tipoServicio_ID||"");this.filterTipoServicioDinamicas(e.tipoServicio_ID,s[1]);s[3].setValue(e.ConceptoOferta||"");s[4].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[5].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[6].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[7].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[8].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[9].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[10].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[11].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[12].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});for(let e of this._idGasViaReEx){await this.leerFechasGastoRecursoExterno(e)}}else{}}catch(e){console.error("Error al obtener los datos de GastoViajeRecExter:",e)}},leerOtrosConcepto:async function(e){var t=`/odata/v4/datos-cdo/otrosConceptos?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("tablaInfrestuctura");var a=o.getItems();this._OtrosConceptos=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._OtrosConceptos[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[2].setValue(e.ConceptoOferta||"");s[3].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[4].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[5].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[6].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[7].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[8].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[9].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[10].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[11].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});for(let e of this._OtrosConceptos){await this.leerFechasOtrosConcetos(e)}}else{}}catch(e){console.error("Error al obtener los datos de Recursos Internos:",e)}},leerFechasOtrosConcetos:async function(){const e=this._OtrosConceptos;const t={};const o=e.map(async(e,o)=>{const a=`/odata/v4/datos-cdo/ValorMensuOtrConcep?$filter=otrosConceptos_ID eq ${e}`;try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();if(!i.value||i.value.length===0){console.warn(`    No hay datos de ValorMensuOtrConcep para el ID: ${e}`);return{conceptoID:e,data:[]}}let r={};i.value.forEach(e=>{const o=e.mesAno;r[o]=e.valor;t[o]=e.ID});this._IdFechasPorMesOtConp=t;this.rellenarInputsConFechas("tablaInfrestuctura",o,r);return{conceptoID:e,data:i.value}}catch(t){console.error(`    Error al consultar otrosConceptos_ID ${e}:`,t);return{conceptoID:e,error:t}}});const a=await Promise.all(o)},leerFechasLicencia:async function(){const e=this._idLicencia;const t={};const o=e.map(async(e,o)=>{const a=`/odata/v4/datos-cdo/ValorMensulicencia?$filter=licencia_ID eq ${e}`;console.log(`  URL consultada para licencia_ID: ${e}`);try{const s=await fetch(a,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok){const e=await s.text();throw new Error("    Error en respuesta de red: "+e)}const i=await s.json();console.log("    Respuesta JSON completa:",i);if(!i.value||i.value.length===0){console.warn(`    No hay datos de ValorMensulicencia para el ID: ${e}`);return{licenciaID:e,data:[]}}let r={};i.value.forEach(e=>{const o=e.mesAno;r[o]=e.valor;t[o]=e.ID});this._IdFechasPorMesLicencia=t;this.rellenarInputsConFechas("tablaLicencia",o,r);return{licenciaID:e,data:i.value}}catch(t){console.error(`    Error al consultar licencia_ID ${e}:`,t);return{licenciaID:e,error:t}}});const a=await Promise.all(o)},leerLicencias:async function(e){var t=`/odata/v4/datos-cdo/LicenciasCon?$filter=datosProyect_ID eq ${e}`;try{const e=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok){const t=await e.text();throw new Error("Network response was not ok: "+t)}const s=await e.json();var o=this.byId("tablaLicencia");var a=o.getItems();this._idLicencia=[];if(s.value&&s.value.length>0){s.value.forEach((e,t)=>{this._idLicencia[t]=e.ID;if(t<a.length){var o=a[t];var s=o.getCells();if(s.length>1){s[0].setSelectedKey(e.Vertical_ID||"");this.filterVerticaltablasDinamicas(e.Vertical_ID,s[0]);s[2].setValue(e.ConceptoOferta||"");s[3].setText(e.PMJ?parseFloat(e.PMJ).toFixed(2):"0.00");s[4].setText(e.year1?parseFloat(e.year1).toFixed(2):"0.00");s[5].setText(e.year2?parseFloat(e.year2).toFixed(2):"0.00");s[6].setText(e.year3?parseFloat(e.year3).toFixed(2):"0.00");s[7].setText(e.year4?parseFloat(e.year4).toFixed(2):"0.00");s[8].setText(e.year5?parseFloat(e.year5).toFixed(2):"0.00");s[9].setText(e.year6?parseFloat(e.year6).toFixed(2):"0.00");s[10].setText(e.total?parseFloat(e.total).toFixed(2):"0.00");s[11].setText(e.totalC?parseFloat(e.total).toFixed(2):"0.00")}}});await this.leerFechasLicencia()}else{}}catch(e){console.error("Error al obtener los datos de LicenciasCon:",e)}},updateVizFrame1:function(e){var t=this.getView();var o=t.getModel("planning");if(!o){console.error("El modelo 'planning' no está definido.");return}if(!e||!e.value){return}var a=sap.ui.core.format.DateFormat.getInstance({pattern:"yyyy-MM-dd"});var s=e.value.map(function(e){var t=e.fecha_inicio?new Date(e.fecha_inicio):null;var o=e.fecha_fin?new Date(e.fecha_fin):null;if(t&&!isNaN(t.getTime())&&o&&!isNaN(o.getTime())){var s=(o-t)/(1e3*60*60*24);return{fase:e.hito,fechaInicio:a.format(t),fechaFin:a.format(o),duracion:s,label:`Inicio: ${a.format(t)}, Fin: ${a.format(o)}, Duración: ${s} días`}}else{console.warn("Fechas no válidas para el hito:",e);return null}}).filter(Boolean);o.setProperty("/chartData",s);this._aChartData=s},onFechaManualChange:function(){var e=this.getView();var t=e.getModel("fechasModel");var o=sap.ui.core.format.DateFormat.getInstance({pattern:"yyyy-MM-dd"});var a=t.getProperty("/fechas/0/fechaInicio");var s=t.getProperty("/fechas/0/fechaFin");if(!a||!s){console.warn("Alguna de las fechas está vacía. No se actualizará el gráfico.");return}var i=new Date(a);var r=new Date(s);if(isNaN(i.getTime())||isNaN(r.getTime())){console.warn("Fechas inválidas. No se actualizará el gráfico.");return}var n=Math.round((r-i)/(1e3*60*60*24));var c=[{fase:"Plan",fechaInicio:o.format(i),fechaFin:o.format(r),duracion:n,label:`Inicio: ${o.format(i)}, Fin: ${o.format(r)}, Duración: ${n} días`}];t.setProperty("/chartData",c)},updateVizFrame3:function(){var e=this.getView();var t=e.getModel("planning");var o=t.getData();var a=sap.ui.core.format.DateFormat.getInstance({pattern:"yyyy-MM-dd"});var s=o.milestones.map(function(e){var t=e.fechaInicio?new Date(e.fechaInicio):null;var o=e.fechaFin?new Date(e.fechaFin):null;if(t&&o&&!isNaN(t)&&!isNaN(o)){var s=(o-t)/(1e3*60*60*24);return{fase:e.fase,fechaInicio:a.format(t),fechaFin:a.format(o),duracion:s,label:`Inicio: ${a.format(t)}, Fin: ${a.format(o)}, Duración: ${s} días`}}else{return null}}).filter(Boolean);t.setProperty("/chartData",s);this._aChartData=s},onFechaChange:function(){this.updateVizFrame1();this.updateVizFrame3()},onPerfilChangeTabla1:function(e){this.updateRowData(e,["table_dimicFecha"])},updateRowData:function(e){const t=e.getSource();var o=this.byId("table_dimicFecha");var a=t.getParent();var s=o.indexOfItem(a);if(s===-1){console.error(`Índice de la fila no encontrado en la tabla ${oTableId}. Verifica la estructura de la tabla.`);return}else{}var i=o.getItems();var r=i[s].getCells();if(!r||r.length===0){console.error(`Datos de la fila no encontrados en la tabla ${oTableId}.`);return}var n=t.getSelectedItem().getText();var c={Director:{PMJ:1370.88},"CG4.C":{PMJ:179.46},"CG4.A":{PMJ:347.37},"CG4.B":{PMJ:223.59},CG3:{PMJ:424.15},CG2:{PMJ:529.92},CG1:{PMJ:670.46}};var l=c[n];if(l){r[4].setText(l.PMJ);var d="table_dimicFecha";if(!this._editedRows[d]){this._editedRows[d]=new Set}if(!this._editedRows[d].has(s)){this._editedRows[d].add(s)}this.updateTotalField(d,s,l.PMJ,e,4)}else{console.error(`No hay configuración definida para el valor seleccionado: ${n}`)}},selectFuncionchange:function(e){const t=e.getSource();const o=this.byId("tablaConsuExter");var a=t.getParent();var s=o.indexOfItem(a);if(s===-1){console.error(`Índice de la fila no encontrado en la tabla ${oTableId}. Verifica la estructura de la tabla.`);return}var i=o.getItems();var r=i[s].getCells();if(!r||r.length===0){console.error(`Datos de la fila no encontrados en la tabla ${oTableId}.`);return}var n=t.getSelectedItem().getText();var c={"Equipo Argentina - Analista":{PMJ:216.18},"Equipo Argentina - Asistente":{PMJ:190.74},"Equipo Argentina - Jefe":{PMJ:296.13},"Equipo Argentina - Gerente":{PMJ:478.34},"Basis - Consultor Junior":{PMJ:207.19},"Basis - Consultor Senior":{PMJ:356.21},"Basis - Arquitecto":{PMJ:356.21},"QA - Análisis Funcional":{PMJ:278},"QA - Jefe Proyecto":{PMJ:320},"Testing - Análisis Funcional":{PMJ:180},"TA - Consultor Senior 1-2":{PMJ:379.17},"TA - Consultor Senior 3":{PMJ:455.4}};var l=c[n];if(l){r[4].setText(l.PMJ);var d="tablaConsuExter";if(!this._editedRows[d]){this._editedRows[d]=new Set}if(!this._editedRows[d].has(s)){this._editedRows[d].add(s)}this.updateTotalField(d,s,l.PMJ,e,4)}else{console.error(`No hay configuración definida para el valor seleccionado: ${n}`)}},token:async function(){try{let e=await fetch("/odata/v4/datos-cdo",{method:"GET",headers:{"x-csrf-token":"Fetch"}});if(!e.ok){throw new Error("Error al obtener el CSRF Token")}let t=e.headers.get("x-csrf-token");if(!t){throw new Error("No se recibió un CSRF Token")}localStorage.setItem("csrfToken",t);this._sCsrfToken=t}catch(e){console.error("Error en la llamada al servicio:",e)}},getCsrfToken:function(){return localStorage.getItem("csrfToken")},sendRequest:async function(){const e=this.getCsrfToken();if(!e){await this.token()}const t=await fetch("/odata/v4/datos-cdo",{method:"GET",headers:{"x-csrf-token":e}});if(t.ok){const e=await t.json();console.log(e)}else{console.error("Error en la solicitud:",t.status)}},onSave:async function(){const e=this._usuarioActual;let t=this.getView().getModel("viewModel").getProperty("/mode");if(!this._oBusyDialog){this._oBusyDialog=new sap.m.BusyDialog({title:"Procesando",text:"Procesando su solicitud, por favor espere un momento..."})}if(!t){t=this._mode||""}if(!t){t=this._sProjectID?"edit":"create"}let o=0;let a=[];const s=[];const i=this._sProjectID;const r=parseFloat(this.byId("input0").getValue(),10);const n=this.byId("dddtg").getText();const c=this.byId("23d3").getText();const l=parseFloat(this.byId("inputCambioEu").getValue());const d=this.byId("input1").getValue();const u=this.byId("idDescripcion").getValue();const h=parseFloat(this.byId("input0_1725625161348").getValue());const f=this.byId("box_pluriAnual").getSelected();const p=this.byId("id_Cfactur").getValue();const g=this.byId("box_multiJuridica").getSelected();const x=this.byId("ofertaCheckBox").getSelected();const y=this.byId("idCheckMensual").getSelected();const I=this.byId("int_clienteFun").getValue();const v=this.byId("idObje").getValue();const m=this.byId("idAsunyRestri").getValue();const b=this.byId("area0").getValue();const T=this.byId("date_inico").getDateValue();const C=this.byId("date_fin").getDateValue();const w=this.byId("input_ipc").getValue();const _=this.byId("idTextComProve").getValue();const F=this.byId("idComenpVd").getValue();let S=w.replace("%","").replace(",",".");let E=parseFloat(S);const V=this.byId("idComentarioTipo").getValue();const D=this.byId("idComentariosFac").getValue();var P=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd'T'HH:mm:ss"});const j=T?P.format(T):null;const N=C?P.format(C):null;const $=this.byId("idNatu").getSelectedKey();const k=this.byId("slct_area");const R=k.getSelectedKey();const M=k.getSelectedItem()?k.getSelectedItem().getText():"";const O=this.byId("slct_Jefe");const A=O.getSelectedKey();const G=O.getSelectedItem()?O.getSelectedItem().getText():"";const J=this.byId("select_tipoCom").getSelectedKey();const K=this.byId("selectMotivo").getSelectedKey();const L=this.byId("slct_inic").getSelectedKey();const B=this.byId("selc_Segui").getSelectedKey();const H=this.byId("selc_ejcu").getSelectedKey();const q=this.byId("slct_client").getSelectedKey();const z=this.byId("slct_verti");const U=z.getSelectedKey();const W=z.getSelectedItem()?z.getSelectedItem().getText():null;const Y=this.byId("selct_Amrecp").getSelectedKey();function Q(e,t,a,i="text"){if(i==="boolean"){if(!t){o++;s.push(a)}}else if(i==="date"){if(!t){if(e.setValueState){e.setValueState("Error")}o++;s.push(a)}else{if(e.setValueState){e.setValueState("None")}}}else{if(!t){if(e.setValueState){e.setValueState("Error")}o++;s.push(a)}else{if(e.setValueState){e.setValueState("None")}}}}const X=this.validateRecursosInternos();const Z=this.validateServicioInterno();const ee=this.validateGastoViajeInterno();const te=this.validateChartData();const oe=this.validateConsumoExterno();const ae=this.validateServiConsu();const se=this.validateGastoConsu();const ie=this.validateRecursoExterno();const re=this.validateServicioRecuExter();const ne=this.validateGastoViajeExterno();const ce=this.validateOtrosConceptos();const le=this.validateLicencia();const de=this.validateClienteFacturacion();const ue=this.validatePlanning();const he=this.validatePlanServicio();const fe=this.validateClienteCampos();const pe=this.validateProveedores();const ge=this.validatePluriAnual();const xe=this.validateSumaOfertas();if(!te.success){a.push(...te.errors)}if(!X.success){a.push(...X.errors)}if(!Z.success){a.push(...Z.errors)}if(!ee.success){a.push(...ee.errors)}if(!oe.success){a.push(...oe.errors)}if(!ae.success){a.push(...ae.errors)}if(!se.success){a.push(...se.errors)}if(!ie.success){a.push(...ie.errors)}if(!re.success){a.push(...re.errors)}if(!ne.success){a.push(...ne.errors)}if(!ce.success){a.push(...ce.errors)}if(!le.success){a.push(...le.errors)}if(!de.success){a.push(...de.errors)}if(!xe.success){a.push(...xe.errors)}if(!ue.success){a.push(...ue.errors)}if(!fe.success){a.push(...fe.errors)}if(!he.success){a.push(...he.errors)}if(!pe.success){a.push(...pe.errors)}if(!ge.success){a.push(...ge.errors)}Q(this.byId("input1"),d,"Nombre del Proyecto");Q(this.byId("idDescripcion"),u,"Descripcion");Q(this.byId("date_inico"),T,"Inicio","date");Q(this.byId("date_fin"),C,"Fin","date");Q(this.byId("idObje"),v,"Objectivo y Alcance");if(o>0||a.length>0){let e="";if(s.length>0){e+="Por favor, complete los siguientes campos:\n- "+s.join("\n- ")}if(a.length>0){if(e.length>0){e+="\n\n"}e+="Errores en los datos ingresados:\n- "+a.join("\n- ")}sap.m.MessageBox.warning(e,{title:"Advertencia"});return}const ye=new Date;const Ie=new Date(ye.getTime()-ye.getTimezoneOffset()*6e4);const ve=await this.mostrarDialogoModalidad();let me="Offline";let be=null;if(ve.modalidad==="Comité"){me="Comité";be=ve.fechaComite?ve.fechaComite.toISOString().split("T")[0]:null}const Te={codigoProyect:"1",nameProyect:d,Email:n,Empleado:c,pluriAnual:f,Total:h,Oferta:x,descripcion:u,mensual:y,comentarioTipoCompra:V,comentarioFacturacion:D,comentarioProveedor:_,comentarioPvD:F,funcionalString:I,clienteFacturacion:p,multijuridica:g,Naturaleza_ID:$,TipoCompra_ID:J,TipoCompra:{ID:J},MotivoCondi:{ID:K},Area_ID:R,Iniciativa_ID:L,jefeProyectID_ID:A,objetivoAlcance:v,AsuncionesyRestricciones:m,Vertical_ID:U,Fechainicio:j,FechaFin:N,Seguimiento_ID:B,EjecucionVia_ID:H,AmReceptor_ID:Y,ClienteNuevo_ID:q,Estado:"Pendiente",modalidad:me,fechaComite:be,Usuarios_ID:e,datosExtra:b,IPC_apli:E,CambioEuRUSD:l};if(!i){Te.fechaCreacion=Ie}let Ce=sap.ui.core.format.DateFormat.getDateInstance({pattern:"yyyy-MM-dd"});const we=new Date;const _e=Ce.format(we);if(i){Te.FechaModificacion=_e}if(!Te.descripcion||!Te.nameProyect){console.error("Validación fallida: Falta código o nombre del proyecto",Te);return}try{let e=this.getView().getModel();let t=e.sServiceUrl;let o;let a="/odata/v4/datos-cdo/DatosProyect";let s="POST";this._oBusyDialog.open();if(this._mode==="edit"){if(!i){sap.m.MessageBox.error("Error: No hay ProjectID para editar.");return}if(this._idWorkIniciado){try{const e=this.getView().getModel();const t=e.bindContext("/cancelWorkflow(...)");t.setParameter("workflowInstanceId",this._idWorkIniciado);await t.execute()}catch(e){sap.m.MessageBox.error("Error al cancelar workflow anterior: "+e.message);return}}a=`/odata/v4/datos-cdo/DatosProyect(${i})`;s="PATCH"}else if(this._mode==="create"){s="POST";a="/odata/v4/datos-cdo/DatosProyect"}let r=await fetch(t,{method:"GET",headers:{"x-csrf-token":"Fetch"}});if(!r.ok){throw new Error("Error al obtener el CSRF Token")}let n=r.headers.get("x-csrf-token");if(!n){throw new Error("No se recibió un CSRF Token")}o=await fetch(a,{method:s,headers:{"Content-Type":"application/json","x-csrf-token":n},body:JSON.stringify(Te)});if(!o.ok){const e=await o.text();console.error(`Error en ${s} (${o.status}):`,e);if(o.status===400){sap.m.MessageToast.show("Error 400: Datos incorrectos o incompletos.")}else if(o.status===404){sap.m.MessageToast.show("Error 404: Endpoint no encontrado.")}else if(o.status===500){sap.m.MessageToast.show("Error 500: Problema en el servidor o base de datos.")}else{sap.m.MessageToast.show(`Error ${o.status}: ${e}`)}throw new Error(`HTTP ${o.status} - ${e}`)}if(o.ok){const e=await o.json();const t=e.ID||e.data?.ID;if(t){const e=await Promise.all([this.insertFacturacion(t),this.inserChart(t,n),this.insertarProveedor(t),this.insertClientFactura(t),this.insertRecursosInternos(t),this.insertCosumoExterno(t),this.insertRecursoExterno(t),this.insertarOtrosConceptos(t),this.insertServicioInterno(t),this.insertGastoViajeInterno(t),this.insertServiConsu(t),this.insertGastoConsu(t),this.insertServicioRecuExter(t),this.insertGastoViajeExterno(t),this.insertarLicencia(t),this.insertPerfilJornadas(t,n),this.insertTotalRecuInterno(t,n),this.insertTotalConsuExt(t,n),this.insertTotalRecuExterTotal(t,n),this.insertTotalInfraestrLicencia(t,n),this.insertResumenCostesTotal(t,n),this.onUploadFile(t,n),this.insertPlanServicio(t,n)]);const o=window.location.hostname;let a="";if(o.includes("localhost")||o.includes("dev")||o.includes("test")||o.includes("applicationstudio")){a="https://telefonica-global-technology--s-a--j8z80lwx-sp-shc-dev-16bb931b.cfapps.eu20-001.hana.ondemand.com/project1/index.html#/app/"}else{a="https://telefonica-global-technology--s-a--zagvian4-sp-shc-qa-d6cf78b85.cfapps.eu20-001.hana.ondemand.com/project1/index.html#/app/"}const s=this.getView().getModel();const i=s.bindContext("/startWorkflow(...)");const r={codigoproyect:0,nameproyect:d,generatedid:t,urlapp:a,descripcion:u,jefeProyecto:G,area:M,usuario:c,Modalidad:me};if(me==="Comité"&&be){r.fechaComite=be}if(W?.toLowerCase()==="ssff"||W?.toLowerCase()==="sap"){r.vertical=W}i.setParameter("payload",JSON.stringify(r));try{await i.execute();const e=i.getBoundContext().getObject();this.workflowInstanceId=e.workflowInstanceId;if(e&&e.workflowInstanceId){const o=e.workflowInstanceId;this.insertWorkflow(o,c,t,n);this._oBusyDialog.close()}else{sap.m.MessageBox.error("No se recibió el ID del flujo de trabajo.")}this.getOwnerComponent().getRouter().navTo("app",{newId:t})}catch(e){sap.m.MessageBox.error("Error al iniciar el workflow: "+e.message)}}else{console.error("No se generó un ID válido.")}}}catch(e){console.error("Error en la llamada al servicio:",e)}},validatePluriAnual:function(){const e=[];const t=this.byId("box_pluriAnual");const o=this.byId("date_inico");const a=this.byId("date_fin");o.setValueState("None");a.setValueState("None");if(t.getSelected()){const t=o.getDateValue();const s=a.getDateValue();if(!t||!s){e.push("Debes ingresar fechas de inicio y fin para validar PluriAnual.");if(!t)o.setValueState("Error");if(!s)a.setValueState("Error")}else{const i=s.getFullYear()-t.getFullYear();const r=s.getMonth()-t.getMonth()+i*12;if(r<12){e.push("Si seleccionaste PluriAnual, la duración debe ser de al menos 1 año.");o.setValueState("Error");a.setValueState("Error")}}}return{success:e.length===0,errors:e}},_checkIfAnyTableHasData:function(){let e=false;for(const t of Object.keys(this._tableValues)){const o=this.byId(t);if(!o)continue;const a=o.getItems();for(let t=0;t<a.length;t++){const o=a[t].getCells();const s=o.some(e=>{if(e.getValue){return e.getValue().trim()!==""}if(e.getSelectedKey){return e.getSelectedKey().trim()!==""}return false});if(s){e=true;break}}if(e)break}return e},validateProveedores:function(){const e=[];let t=true;const o=this.byId("table2");const a=o?o.getItems():[];function s(e,t){let o=0;e.forEach(e=>{const a=e.getCells();const s=a[t];const i=s.getValue?s.getValue().trim():"";if(i)o++});return o}const i=this.byId("box_condi")?.getSelected();const r=this.byId("box_prove")?.getSelected();const n=this.byId("select_tipoCom");if(i||r){if(!n||!n.getSelectedKey()){e.push("El campo Tipo de compra es obligatorio.");if(n)n.setValueState("Error");t=false}else{n.setValueState("None")}}if(i){const o=s(a,0);if(o<1){e.push("Debe haber al menos 1 proveedor si es CONDICIONADO.");t=false}const i=this.byId("selectMotivo");if(!i||!i.getSelectedKey()){e.push("Debe indicar el motivo de condicionamiento.");if(i)i.setValueState("Error");t=false}else{i.setValueState("None")}const r=this.byId("idTextComProve");if(!r||!r.getValue()){e.push("Debe indicar la justificación del condicionamiento.");if(r)r.setValueState("Error");t=false}else{r.setValueState("None")}}if(r){const o=s(a,1);if(o<2){e.push("Debe haber al menos 2 proveedores si es NO CONDICIONADO.");t=false}}return{success:t,errors:e}},validateClienteCampos:function(){const e=[];const t=this.byId("slct_inic");const o=t&&t.getSelectedItem()?t.getSelectedItem().getText().trim():"";const a=["Proyecto/Servicio Interno PdV","Proyecto/Servicio a Cliente Externo"];const s=this.byId("int_clienteFun");const i=this.byId("id_Cfactur");const r=this.byId("idComenpVd");s.setValueState("None");i.setValueState("None");r.setValueState("None");if(a.includes(o)){const t=s?.getValue()?.trim();const a=i?.getValue()?.trim();if(!t){e.push(`Si seleccionaste "${o}", debes completar el campo "Cliente Funcional".`);s.setValueState("Error")}if(!a){e.push(`Si seleccionaste "${o}", debes completar el campo "Cliente a Facturación".`);i.setValueState("Error")}if(o==="Proyecto/Servicio Interno PdV"){const t=r?.getValue()?.trim();if(!t){e.push(`Si seleccionaste "${o}", debes escribir un comentario en el campo requerido`);r.setValueState("Error")}}}return{success:e.length===0,errors:e}},validateSumaOfertas:function(){const e=[];const t=this.byId("box_multiJuridica");const o=t.getSelected();if(o){var a=this.byId("table_clienteFac");var s=a.getItems();var i=0;s.forEach(function(e,t){if(t<s.length-1){var o=e.getCells();var a=o[1];var r="";if(a.getMetadata().getName()==="sap.m.Input"){r=a.getValue()}else if(a.getMetadata().getName()==="sap.m.Text"){r=a.getText()}var n=parseFloat((r||"").toString().trim());if(!isNaN(n)){i+=n}}});this.byId("text73_172746565340567").setText(i.toFixed(2)+"%");this._totalOferta=i;if(i.toFixed(2)!=100){e.push(`El total de la columna "Oferta" la suma debe ser exactamente 100%. Actualmente es ${i.toFixed(2)}%.`)}}return{success:e.length===0,errors:e}},validatePlanning:function(){const e=[];const t=this.byId("selc_Segui");const o=t&&t.getSelectedItem()?t.getSelectedItem().getText().trim():"";const a=this.getView().getModel("planning");const s=["Agile","Mixto","Waterfall"];if(s.includes(o)){const t=a.getProperty("/milestones")||[];const s=this.byId("planningTable");const i=s?s.getItems():[];if(t.length===0){e.push(`Rellenar Planificación es obligatorio cuando se selecciona la metodología "${o}".`);if(s)s.addStyleClass("tableError")}else{let a=true;let r=0;t.forEach((t,o)=>{const s=i[o];if(t.fechaInicio||t.fechaFin){a=false}if(t.fechaInicio&&t.fechaFin){r++}if(t.fechaInicio&&!t.fechaFin){e.push(`La fase "${t.fase}" tiene fecha de inicio pero falta la fecha de fin.`);if(s)s.addStyleClass("rowError")}else if(!t.fechaInicio&&t.fechaFin){e.push(`La fase "${t.fase}" tiene fecha de fin pero falta la fecha de inicio.`);if(s)s.addStyleClass("rowError")}else{if(s)s.removeStyleClass("rowError")}});if(a){e.push(`Al seleccionar "${o}", debe completar al menos 2 hitos del proyecto en la Planificación Preliminar. No todas las fases son obligatorias, pero se recomienda registrar la mayoría para una mejor trazabilidad.`);if(s)s.addStyleClass("tableError")}else if(r<2){e.push(`Debe completar al menos 2 hitos para la metodología "${o}".`);if(s)s.addStyleClass("tableError")}else{if(s)s.removeStyleClass("tableError")}}}return{success:e.length===0,errors:e}},validatePlanServicio:function(){const e=[];function t(e){if(!e)return null;const t=new Date(e);t.setHours(0,0,0,0);return t}const o=this.byId("selc_Segui");const a=o&&o.getSelectedItem()?o.getSelectedItem().getText().trim():"";const s=["Sin Seguimiento","Servicio"];if(s.includes(a)){const o=t(this.byId("date_inico").getDateValue());const s=t(this.byId("date_fin").getDateValue());if(!o||!s){e.push("Debes seleccionar las fechas Inicio y Fin en el formulario.")}const i=this.getView().getModel("planning");const r=i.getProperty("/chartModel")||[];if(r.length===0){e.push(`Debes rellenar el gráfico de Plan de Servicio si seleccionaste "${a}".`)}else{let a=null;let i=null;r.forEach(o=>{const s=o.fechaInicio?t(new Date(o.fechaInicio)):null;const r=o.fechaFin?t(new Date(o.fechaFin)):null;if(!s||!r||!o.duracion){e.push(`La fase Plan de Servicio no tiene fechas completas o duración calculada.`)}if(s){if(!a||s<a){a=s}}if(r){if(!i||r>i){i=r}}});if(a&&o&&a.getTime()!==o.getTime()){e.push(`La fecha de inicio más temprana en Plan Servicio (${a.toLocaleDateString()}) no coincide con la fecha inicio seleccionada en el formulario (${o.toLocaleDateString()}).`)}if(i&&s&&i.getTime()!==s.getTime()){e.push(`La fecha de fin más tardía Plan Servicio (${i.toLocaleDateString()}) no coincide con la fecha fin seleccionada en el formulario (${s.toLocaleDateString()}).`)}}}return{success:e.length===0,errors:e}},validateChartData:function(){const e=[];function t(e){if(!e)return null;const t=new Date(e);t.setHours(0,0,0,0);return t}const o=this.byId("selc_Segui");const a=o&&o.getSelectedItem()?o.getSelectedItem().getText().trim():"";const s=["Sin Seguimiento","Servicio"];if(s.includes(a)){return{success:true,errors:[]}}const i=t(this.byId("date_inico").getDateValue());const r=t(this.byId("date_fin").getDateValue());if(!i||!r){e.push("Debes seleccionar las fechas Inicio y Fin en el formulario.")}let n=null;let c=null;if(this._aChartData&&this._aChartData.length>0){this._aChartData.forEach(o=>{const a=o.fechaInicio?t(new Date(o.fechaInicio)):null;const s=o.fechaFin?t(new Date(o.fechaFin)):null;if(!a||!s||!o.duracion){e.push(`La fase "${o.fase}" no tiene fechas completas o duración calculada.`)}if(a){if(!n||a<n){n=a}}if(s){if(!c||s>c){c=s}}})}else{e.push("El gráfico Planificación Preliminar del Proyecto está vacío. Debes ingresar al menos un hito.")}if(n&&i){if(n.getTime()!==i.getTime()){e.push(`La fecha de inicio más temprana en  Planificación (${n.toLocaleDateString()}) no coincide con la fecha inicio seleccionada en el formulario (${i.toLocaleDateString()}).`)}}if(c&&r){if(c.getTime()!==r.getTime()){e.push(`La fecha de fin más tardía Planificación (${c.toLocaleDateString()}) no coincide con la fecha fin seleccionada en el formulario (${r.toLocaleDateString()}).`)}}return{success:e.length===0,errors:e}},validateClienteFacturacion:function(){const e=this.byId("box_multiJuridica");const t=e.getSelected();const o=this.byId("table_clienteFac");const a=o.getItems();const s=[];let i=false;let r=false;for(let e=0;e<a.length;e++){const t=a[e];const o=t.getCells();if(o[0].getMetadata().getName()==="sap.m.Title"){continue}const n=o[0];const c=o[1];const l=n.getValue().trim();const d=c.getValue().trim();const u=!l&&!d;n.setValueState("None");c.setValueState("None");if(!u){i=true;const t=[];if(!l){t.push("Debe ingresar la Jurídica");n.setValueState("Error");n.setValueStateText("Campo obligatorio")}if(!d){t.push("Debe ingresar el % Oferta");c.setValueState("Error");c.setValueStateText("Campo obligatorio")}else if(isNaN(d)||Number(d)<0||Number(d)>100){t.push("El % Oferta debe ser un número entre 0 y 100");c.setValueState("Error");c.setValueStateText("Valor inválido")}if(t.length>0){s.push(`Fila ${e+1}: ${t.join(", ")}`)}else{r=true}}}if(t&&!i){const e=a[0];const t=e.getCells();const o=t[0];const i=t[1];o.setValueState("Error");o.setValueStateText("Campo obligatorio");i.setValueState("Error");i.setValueStateText("Campo obligatorio");s.push("Debe completar al menos una fila de Cliente Facturación cuando Multi Jurídica está seleccionado.")}else if(t&&i&&!r){s.push("Debe completar correctamente al menos una fila de Cliente Facturación.")}return{success:s.length===0,errors:s}},validateRecursosInternos:function(){const e=this.byId("table_dimicFecha");const t=e.getItems();const o=[];let a=false;let s=false;for(let e=0;e<t.length;e++){const i=t[e];const r=i.getCells()[0];const n=i.getCells()[1];const c=i.getCells()[2];const l=i.getCells()[3];const d=r?.getSelectedKey()||"";const u=n?.getSelectedKey()||"";const h=c?.getSelectedKey()||"";const f=l?.getValue()?.trim()||"";const p=!d&&!u&&!h&&!f;r?.setValueState("None");n?.setValueState("None");c?.setValueState("None");l?.setValueState("None");if(!p){a=true;const t=[];if(!d){t.push("Debe seleccionar la Vertical");r?.setValueState("Error");r?.setValueStateText("Campo obligatorio")}if(!u){t.push("Debe seleccionar el Tipo de Servicio");n?.setValueState("Error");n?.setValueStateText("Campo obligatorio")}if(!h){t.push("Debe seleccionar el Perfil");c?.setValueState("Error");c?.setValueStateText("Campo obligatorio")}if(!f){t.push("El campo Concepto es obligatorio");l?.setValueState("Error");l?.setValueStateText("Campo obligatorio")}if(t.length>0){o.push(`Fila ${e+1}: ${t.join(", ")}`)}else{s=true}}}if(a&&!s){o.push("Debe completar correctamente al menos una fila de Recursos Internos.")}return{success:o.length===0,errors:o}},validateServicioInterno:function(){const e=this.byId("tableServicioInterno");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=i.getSelectedKey();const u=r.getSelectedKey();const h=n.getValue()?.trim();const f=parseInt(c.getText(),10);const p=parseInt(l.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const g=!d&&!u&&!h&&isNaN(f)&&isNaN(p);if(g){continue}const x=[];if(!d){x.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!u){x.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!h){x.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(x.length>0){o.push(`Fila ${e+1}: ${x.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},validateGastoViajeInterno:function(){const e=this.byId("tablGastoViajeInterno");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=s.getCells()[12];const u=i.getSelectedKey();const h=r.getSelectedKey();const f=n.getValue()?.trim();const p=parseInt(c.getText(),10);const g=parseInt(l.getText(),10);const x=parseInt(d.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const y=!u&&!h&&!f&&isNaN(p)&&isNaN(g)&&isNaN(x);if(y){continue}const I=[];if(!u){I.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!h){I.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!f){I.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(I.length>0){o.push(`Fila ${e+1}: ${I.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},validateConsumoExterno:function(){const e=this.byId("tablaConsuExter");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[2];const c=s.getCells()[3];const l=s.getCells()[4];const d=i?.getSelectedKey()||"";const u=r?.getSelectedKey()||"";const h=n?.getSelectedKey()||"";const f=c?.getValue()?.trim()||"";const p=parseFloat(l?.getText())||0;const g=parseFloat(s.getCells()[11]?.getText())||0;const x=parseFloat(s.getCells()[12]?.getText())||0;const y=d||u||h||f||p>0||g>0||x>0;i?.setValueState("None");r?.setValueState("None");n?.setValueState("None");c?.setValueState("None");if(y){a=true;const t=[];if(!d){t.push("Debe seleccionar la Vertical");i?.setValueState("Error");i?.setValueStateText("Campo obligatorio")}if(!u){t.push("Debe seleccionar el Tipo de Servicio");r?.setValueState("Error");r?.setValueStateText("Campo obligatorio")}if(!h){t.push("Debe seleccionar el Perfil");n?.setValueState("Error");n?.setValueStateText("Campo obligatorio")}if(!f){t.push("El campo Concepto es obligatorio");c?.setValueState("Error");c?.setValueStateText("Campo obligatorio")}if(t.length>0){o.push(`Fila ${e+1}: ${t.join(", ")}`)}}}if(a&&o.length>0){return{success:false,errors:o}}return{success:true,errors:[]}},validateServiConsu:function(){const e=this.byId("idOtroserConsu");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=s.getCells()[12];const u=i.getSelectedKey();const h=r.getSelectedKey();const f=n.getValue()?.trim();const p=parseInt(c.getText(),10);const g=parseInt(l.getText(),10);const x=parseInt(d.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const y=!u&&!h&&!f&&isNaN(p)&&isNaN(g)&&isNaN(x);if(y){continue}const I=[];if(!u){I.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!h){I.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!f){I.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(I.length>0){o.push(`Fila ${e+1}: ${I.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},validateGastoConsu:function(){const e=this.byId("idGastoViajeConsu");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=s.getCells()[12];const u=i.getSelectedKey();const h=r.getSelectedKey();const f=n.getValue()?.trim();const p=parseInt(c.getText(),10);const g=parseInt(l.getText(),10);const x=parseInt(d.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const y=!u&&!h&&!f&&isNaN(p)&&isNaN(g)&&isNaN(x);if(y){continue}const I=[];if(!u){I.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!h){I.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!f){I.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(I.length>0){o.push(`Fila ${e+1}: ${I.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},validateRecursoExterno:function(){const e=this.byId("tablaRecExterno");const t=e.getItems();const o=[];for(let e=0;e<t.length;e++){const a=t[e];const s=a.getCells()[0];const i=a.getCells()[1];const r=a.getCells()[2];const n=a.getCells()[3];const c=a.getCells()[4];const l=s.getSelectedKey()||"";const d=i.getSelectedKey()||"";const u=r.getValue()||"";const h=n.getValue()||"";const f=parseFloat(c.getValue());const p=parseFloat(a.getCells()[11].getText());const g=parseFloat(a.getCells()[12].getText());const x=l||d||u||h||!isNaN(f)||!isNaN(p)||!isNaN(g);s.setValueState("None");i.setValueState("None");r.setValueState("None");n.setValueState("None");c.setValueState("None");if(x){const t=[];if(!l){t.push("Debe seleccionar la Vertical");s.setValueState("Error");s.setValueStateText("Campo obligatorio")}if(!d){t.push("Debe seleccionar el Tipo de Servicio");i.setValueState("Error");i.setValueStateText("Campo obligatorio")}if(!u){t.push("Debe seleccionar el Perfil");r.setValueState("Error");r.setValueStateText("Campo obligatorio")}if(!h){t.push("El campo Concepto es obligatorio");n.setValueState("Error");n.setValueStateText("Campo obligatorio")}if(isNaN(f)){t.push("El campo PMJ no es válido");c.setValueState("Error");c.setValueStateText("Debe ser un número válido")}if(t.length>0){o.push(`Fila ${e+1}: ${t.join(", ")}`)}}}if(o.length>0){return{success:false,errors:o}}return{success:true,errors:[]}},validateServicioRecuExter:function(){const e=this.byId("idServiExterno");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=s.getCells()[12];const u=i.getSelectedKey();const h=r.getSelectedKey();const f=n.getValue()?.trim();const p=parseInt(c.getText(),10);const g=parseInt(l.getText(),10);const x=parseInt(d.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const y=!u&&!h&&!f&&(isNaN(p)||p===0)&&(isNaN(g)||g===0)&&(isNaN(x)||x===0);if(y){continue}const I=[];if(!u){I.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!h){I.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!f){I.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(I.length>0){o.push(`Fila ${e+1}: ${I.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o,hasValidRow:a}},validateGastoViajeExterno:function(){const e=this.byId("idGastoRecuExter");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[1];const n=s.getCells()[3];const c=s.getCells()[4];const l=s.getCells()[11];const d=s.getCells()[12];const u=i.getSelectedKey();const h=r.getSelectedKey();const f=n.getValue()?.trim();const p=parseInt(c.getText(),10);const g=parseInt(l.getText(),10);const x=parseInt(d.getText(),10);i.setValueState("None");r.setValueState("None");n.setValueState("None");const y=!u&&!h&&!f&&(isNaN(p)||p===0)&&(isNaN(g)||g===0)&&(isNaN(x)||x===0);if(y){continue}const I=[];if(!u){I.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!h){I.push("Debe seleccionar el Tipo de Servicio");r.setValueState("Error")}if(!f){I.push("El campo Concepto es obligatorio");n.setValueState("Error")}if(I.length>0){o.push(`Fila ${e+1}: ${I.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o,hasValidRow:a}},validateLicencia:function(){const e=this.byId("tablaLicencia");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[2];const n=i.getSelectedKey();const c=r.getValue()?.trim();i.setValueState("None");r.setValueState("None");const l=!n&&!c;if(l){continue}const d=[];if(!n){d.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!c){d.push("El campo Concepto es obligatorio");r.setValueState("Error")}if(d.length>0){o.push(`Fila ${e+1}: ${d.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},validateOtrosConceptos:function(){const e=this.byId("tablaInfrestuctura");const t=e.getItems();const o=[];let a=false;for(let e=0;e<t.length;e++){const s=t[e];const i=s.getCells()[0];const r=s.getCells()[2];const n=i.getSelectedKey();const c=r.getValue()?.trim();i.setValueState("None");r.setValueState("None");const l=!n&&!c;if(l){continue}const d=[];if(!n){d.push("Debe seleccionar la Vertical");i.setValueState("Error")}if(!c){d.push("El campo Concepto es obligatorio");r.setValueState("Error")}if(d.length>0){o.push(`Fila ${e+1}: ${d.join(", ")}`)}else{a=true}}return{success:o.length===0,errors:o}},mostrarDialogoModalidad:function(){return new Promise((e,t)=>{if(!this._oComiteDialog){this._oComiteDialog=sap.ui.xmlfragment("project1.view.ComiteDialog",this);this.getView().addDependent(this._oComiteDialog)}var o=sap.ui.getCore().byId("radioGroupModalidad");o.setSelectedIndex(0);var a=sap.ui.getCore().byId("datePickerComite");var s=sap.ui.getCore().byId("infoText");a.setVisible(false);s.setVisible(false);a.setDateValue(null);this._modalidadResolve=e;this._modalidadReject=t;this._oComiteDialog.open()})},onCancelarComiteDialog:function(){if(this._oComiteDialog){this._oComiteDialog.close()}if(this._modalidadReject){this._modalidadReject("cancelado");this._modalidadReject=null;this._modalidadResolve=null}},onConfirmModalidad:function(){const e=sap.ui.getCore().byId("radioGroupModalidad").getSelectedIndex();const t=e===0?"Offline":"Comité";const o=sap.ui.getCore().byId("datePickerComite");const a=o.getDateValue();if(t==="Comité"&&!a){sap.m.MessageToast.show("Por favor, selecciona una fecha para Comité.");return}this._oComiteDialog.close();if(this._modalidadResolve){this._modalidadResolve({modalidad:t,fechaComite:a||null})}},onSelectModalidad:function(e){var t=e.getParameter("selectedIndex");var o=this._oComiteDialog;var a=sap.ui.getCore().byId("datePickerComite");var s=sap.ui.getCore().byId("infoText");if(t===1){a.setVisible(true);s.setVisible(true)}else{a.setVisible(false);s.setVisible(false)}},getUsuario:async function(){try{const e=this._user;if(!e){throw new Error("El email del usuario no está disponible. Asegúrate de haber ejecutado getUserInfo primero.")}const t=`/odata/v4/datos-cdo/Usuarios`;const o=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){const e=await o.text();throw new Error("Error en la respuesta de la red: "+e)}const a=await o.json();const s=a.value.find(t=>t.email?.toLowerCase()===e.toLowerCase());if(s){this._usuarioActual=s.ID;return s.ID}else{throw new Error("    No se encontró el usuario con el email logueado.")}}catch(e){console.error("Error al obtener el usuario:",e);return null}},onBorrador:async function(){const e=this._usuarioActual;let t=this.getView().getModel("viewModel").getProperty("/mode");if(!this._oBusyDialog){this._oBusyDialog=new sap.m.BusyDialog({title:"Procesando",text:"Guardando, por favor espere"})}if(!t){t=this._mode||""}if(!t){t=this._sProjectID?"edit":"create"}let o=0;const a=[];let s=[];const i=this._sProjectID;const r=parseFloat(this.byId("input0").getValue(),10);const n=this.byId("ofertaCheckBox").getSelected();const c=this.byId("dddtg").getText();const l=this.byId("23d3").getText();const d=parseFloat(this.byId("inputCambioEu").getValue());const u=this.byId("input1").getValue();const h=this.byId("idDescripcion").getValue();const f=parseFloat(this.byId("input0_1725625161348").getValue());const p=this.byId("box_pluriAnual").getSelected();const g=this.byId("id_Cfactur").getValue();const x=this.byId("box_multiJuridica").getSelected();const y=this.byId("idCheckMensual").getSelected();const I=this.byId("int_clienteFun").getValue();const v=this.byId("idObje").getValue();const m=this.byId("idAsunyRestri").getValue();const b=this.byId("area0").getValue();const T=this.byId("date_inico").getDateValue();const C=this.byId("date_fin").getDateValue();const w=this.byId("input_ipc").getValue();let _=w.replace("%","").replace(",",".");let F=parseFloat(_);const S=this.byId("idTextComProve").getValue();const E=this.byId("idComenpVd").getValue();const V=this.byId("idComentarioTipo").getValue();const D=this.byId("idComentariosFac").getValue();var P=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd'T'HH:mm:ss"});const j=T?P.format(T):null;const N=C?P.format(C):null;const $=this.byId("idNatu").getSelectedKey();const k=this.byId("slct_area").getSelectedKey();const R=this.byId("slct_Jefe").getSelectedKey();const M=this.byId("select_tipoCom").getSelectedKey();const O=this.byId("selectMotivo").getSelectedKey();const A=this.byId("slct_inic").getSelectedKey();const G=this.byId("selc_Segui").getSelectedKey();const J=this.byId("selc_ejcu").getSelectedKey();const K=this.byId("slct_client").getSelectedKey();const L=this.byId("slct_verti").getSelectedKey();const B=this.byId("selct_Amrecp").getSelectedKey();const H=(e,t,s)=>{if(!t||typeof t==="string"&&t.trim()===""){e.setValueState("Error");e.setValueStateText("Este campo es obligatorio");o++;if(!a.includes(s)){a.push(s)}}else{e.setValueState("None")}};H(this.byId("input1"),u,"Nombre del Proyecto");H(this.byId("idDescripcion"),h,"Descripcion");const q=this.validateRecursosInternos();const z=this.validateServicioInterno();const U=this.validateGastoViajeInterno();const W=this.validateChartData();const Y=this.validateConsumoExterno();const Q=this.validateServiConsu();const X=this.validateGastoConsu();const Z=this.validateRecursoExterno();const ee=this.validateServicioRecuExter();const te=this.validateGastoViajeExterno();const oe=this.validateOtrosConceptos();const ae=this.validateLicencia();if(!q.success){s.push(...q.errors)}if(!z.success){s.push(...z.errors)}if(!U.success){s.push(...U.errors)}if(!Y.success){s.push(...Y.errors)}if(!Q.success){s.push(...Q.errors)}if(!X.success){s.push(...X.errors)}if(!Z.success){s.push(...Z.errors)}if(!ee.success){s.push(...ee.errors)}if(!te.success){s.push(...te.errors)}if(!oe.success){s.push(...oe.errors)}if(!ae.success){s.push(...ae.errors)}if(o>0||s.length>0){let e="";if(a.length>0){e+="Por favor, complete los siguientes campos:\n- "+a.join("\n- ")}if(s.length>0){if(e.length>0){e+="\n\n"}e+="Errores en los datos ingresados:\n- "+s.join("\n- ")}sap.m.MessageBox.warning(e,{title:"Advertencia"});return}const se=new Date;const ie=new Date(se.getTime()-se.getTimezoneOffset()*6e4);const re={codigoProyect:"1",nameProyect:u,Email:c,Empleado:l,Oferta:n,pluriAnual:p,Total:f,descripcion:h,mensual:y,comentarioTipoCompra:V,comentarioFacturacion:D,comentarioProveedor:S,comentarioPvD:E,funcionalString:I,clienteFacturacion:g,multijuridica:x,Naturaleza_ID:$,TipoCompra_ID:M,TipoCompra:{ID:M},MotivoCondi:{ID:O},Area_ID:k,Iniciativa_ID:A,jefeProyectID_ID:R,objetivoAlcance:v,AsuncionesyRestricciones:m,Vertical_ID:L,Fechainicio:j,FechaFin:N,Seguimiento_ID:G,EjecucionVia_ID:J,AmReceptor_ID:B,ClienteNuevo_ID:K,Estado:"Borrador",datosExtra:b,IPC_apli:F,Usuarios_ID:e,CambioEuRUSD:d};if(!i){re.fechaCreacion=ie}let ne=sap.ui.core.format.DateFormat.getDateInstance({pattern:"yyyy-MM-dd"});const ce=new Date;const le=ne.format(ce);if(i){re.FechaModificacion=le}if(!re.descripcion||!re.nameProyect){console.error("Validación fallida: Falta código o nombre del proyecto",re);return}try{let e=this.getView().getModel();let t=e.sServiceUrl;let o;let a="/odata/v4/datos-cdo/DatosProyect";let s="POST";this._oBusyDialog.open();if(this._mode==="edit"){if(!i){sap.m.MessageBox.error("Error: No hay ProjectID para editar.");return}a=`/odata/v4/datos-cdo/DatosProyect(${i})`;s="PATCH"}else if(this._mode==="create"){s="POST";a="/odata/v4/datos-cdo/DatosProyect"}let r=await fetch(t,{method:"GET",headers:{"x-csrf-token":"Fetch"}});if(!r.ok){throw new Error("Error al obtener el CSRF Token")}let n=r.headers.get("x-csrf-token");if(!n){throw new Error("No se recibió un CSRF Token")}o=await fetch(a,{method:s,headers:{"Content-Type":"application/json","x-csrf-token":n},body:JSON.stringify(re)});if(!o.ok){const e=await o.text();console.error(`Error en ${s} (${o.status}):`,e);if(o.status===400){sap.m.MessageToast.show("Error 400: Datos incorrectos o incompletos.")}else if(o.status===404){sap.m.MessageToast.show("Error 404: Endpoint no encontrado.")}else if(o.status===500){sap.m.MessageToast.show("Error 500: Problema en el servidor o base de datos.")}else{sap.m.MessageToast.show(`Error ${o.status}: ${e}`)}throw new Error(`HTTP ${o.status} - ${e}`)}if(o.ok){const e=await o.json();const t=e.ID||e.data?.ID;if(t){await Promise.all([this.insertFacturacion(t),this.inserChart(t,n),this.insertarProveedor(t),this.insertClientFactura(t),this.insertRecursosInternos(t),this.insertCosumoExterno(t),this.insertRecursoExterno(t),this.insertarOtrosConceptos(t),this.insertServicioInterno(t),this.insertGastoViajeInterno(t),this.insertServiConsu(t),this.insertGastoConsu(t),this.insertServicioRecuExter(t),this.insertGastoViajeExterno(t),this.insertarLicencia(t),this.insertPerfilJornadas(t,n),this.insertTotalRecuInterno(t,n),this.insertTotalConsuExt(t,n),this.onUploadFile(t,n),this.insertPlanServicio(t,n)]);this._oBusyDialog.close();this.getOwnerComponent().getRouter().navTo("app",{newId:t})}else{console.error("No se generó un ID válido.")}}}catch(e){console.error("Error en la llamada al servicio:",e)}},onFileSelected:function(e){const t=e.getParameter("files")[0];if(t){this._selectedFile=t}},onUploadFile:async function(e,t){const o=this._archivoIds;const a=this._selectedFile;if(!a){return}const s=crypto.randomUUID();const i=a.name;const r=a.type||"application/octet-stream";try{let n;const c={ID:s,nombre:i,tipoMime:r,datosProyect_ID:e};if(o){const e=await fetch(`/odata/v4/datos-cdo/Archivos('${o}')`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(c)});e=await fetch(`/odata/v4/datos-cdo/Archivos('${o}')/contenido/$value`,{method:"PUT",headers:{"X-CSRF-Token":t,"Content-Type":r},body:a})}else{n=await fetch(`/odata/v4/datos-cdo/Archivos`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(c)});n=await fetch(`/odata/v4/datos-cdo/Archivos('${s}')/contenido/$value`,{method:"PUT",headers:{"X-CSRF-Token":t,"Content-Type":r},body:a})}if(!n.ok){const e=await n.text();throw new Error("    Error subiendo archivo: "+e)}}catch(e){console.error("    Error total en upload:",e);console.log(e.message)}},insertWorkflow:async function(e,t,o,a){var s=this._idWorkflowInstancias;var i={workflowId:e,estado:"Pendiente",creadoEn:(new Date).toISOString(),actualizadoEn:(new Date).toISOString(),creadoPor:t,datosProyect_ID:o};let r="/odata/v4/datos-cdo/WorkflowInstancias";let n="POST";if(s){r+=`(${s})`;n="PATCH"}try{const e=await fetch(r,{method:n,headers:{"Content-Type":"application/json","X-CSRF-Token":a},body:JSON.stringify(i)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertPerfilJornadas:async function(e,t){var o=this._idJornadas;var a=parseFloat(this.byId("inputReInter").getValue());var s=parseFloat(this.byId("inputConsuEx").getValue());var i=parseFloat(this.byId("inputRcurExtern").getValue());var r=parseFloat(this.byId("inputTotalJor").getValue());var n={totalJorRI:a,totalJorCE:s,totalJorRE:i,Total:r,datosProyect_ID:e};let c="/odata/v4/datos-cdo/PerfilTotal";let l="POST";if(o){c+=`(${o})`;l="PATCH"}try{const e=await fetch(c,{method:l,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(n)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertTotalRecuInterno:async function(e,t){var o=this._idTotalRecInter;var a=parseFloat(this.byId("inputServi1").getValue(),10);var s=parseFloat(this.byId("inputOtrosServi1").getValue(),10);var i=parseFloat(this.byId("inputGastoVia1").getValue(),10);var r=parseFloat(this.byId("totalRecuInter").getValue(),10);var n={servicios:a,OtrosServicios:s,GastosdeViaje:i,Total:r,datosProyect_ID:e};let c="/odata/v4/datos-cdo/RecurInterTotal";let l="POST";if(o){c+=`(${o})`;l="PATCH"}try{const e=await fetch(c,{method:l,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(n)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertTotalConsuExt:async function(e,t){var o=this._idTotalRecInter;var a=parseFloat(this.byId("inputServi2").getValue());var s=parseFloat(this.byId("inputOtroSer2").getValue());var i=parseFloat(this.byId("inptGastoVi2").getValue());var r=parseFloat(this.byId("totalConsuExternot").getValue());var n={servicios:a,OtrosServicios:s,GastosdeViaje:i,Total:r,datosProyect_ID:e};let c="/odata/v4/datos-cdo/ConsuExterTotal";let l="POST";if(o){c+=`(${o})`;l="PATCH"}try{const e=await fetch(c,{method:l,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(n)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertTotalRecuExterTotal:async function(e,t){var o=this._idtotalRecurExter;var a=parseFloat(this.byId("inputServi").getValue(),10);var s=parseFloat(this.byId("input10_1724757017406").getValue(),10);var i=parseFloat(this.byId("input9_1724757015442").getValue(),10);var r=parseFloat(this.byId("totaRecurExterno").getValue(),10);var n={servicios:a,OtrosServicios:s,GastosdeViaje:i,Total:r,datosProyect_ID:e};let c="/odata/v4/datos-cdo/RecuExterTotal";let l="POST";if(o){c+=`(${o})`;l="PATCH"}try{const e=await fetch(c,{method:l,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(n)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertTotalInfraestrLicencia:async function(e,t){var o=this._idInfraLicencia;var a=parseFloat(this.byId("totalInfraestruc").getValue());var s=parseFloat(this.byId("input0_1724758359").getValue());var i={totalInfraestruc:a,totalLicencia:s,datosProyect_ID:e};let r="/odata/v4/datos-cdo/InfraestrLicencia";let n="POST";if(o){r+=`(${o})`;n="PATCH"}try{const e=await fetch(r,{method:n,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(i)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertResumenCostesTotal:async function(e,t){var o=this._ResumenTotal;var a=parseFloat(this.byId("totalSubtotal").getValue());var s=parseFloat(this.byId("input2_172475612").getValue());var i=parseFloat(this.byId("input2_1724756105").getValue());var r=parseFloat(this.byId("input2_17221205").getValue());var n=parseFloat(this.byId("input2_1756121205").getValue());var c=parseFloat(this.byId("input0_1725625161348").getValue());var l={Subtotal:a,CosteEstruPorce:s,Costeestructura:i,MargenPorce:r,Margeingresos:n,total:c,datosProyect_ID:e};let d="/odata/v4/datos-cdo/ResumenCostesTotal";let u="POST";if(o){d+=`(${o})`;u="PATCH"}try{const e=await fetch(d,{method:u,headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify(l)});if(e.ok){}else{const t=await e.json();console.error("Error:",t)}}catch(e){console.error("Error en fetch:",e)}},insertPlanServicio:async function(e,t){const o=this.getView().getModel("fechasModel");const a=o.getProperty("/fechas");if(!a||a.length===0){console.warn("No hay datos en fechasModel para insertar");return}const s=a[0];const i=function(e,t){const o=new Date(e);const a=new Date(t);if(isNaN(o)||isNaN(a))return 0;const s=a-o;return Math.ceil(s/(1e3*60*60*24))};const r={hito:"Plan de servicio",fecha_inicio:s.fechaInicio,fecha_fin:s.fechaFin,duracion:i(s.fechaInicio,s.fechaFin),datosProyect_ID:e};try{const o=await fetch(`/odata/v4/datos-cdo/planServicio?$filter=datosProyect_ID eq '${e}'`);const a=await o.json();const s=a.value.map(e=>e.hito);if(s.includes(r.hito)){const e=a.value.find(e=>e.hito===r.hito);if(e&&e.ID){const o=typeof e.ID==="string"?`'${e.ID}'`:e.ID;const a=await fetch(`/odata/v4/datos-cdo/planServicio(${o})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(r)});if(!a.ok){const e=await a.text();console.error("Error al actualizar planServicio:",e)}}else{console.warn("ID no válido para actualizar planServicio:",e)}}else{const e=await fetch("/odata/v4/datos-cdo/planServicio",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(r)});if(!e.ok){const t=await e.text();console.error("Error al crear planServicio:",t)}}}catch(e){console.error("Error en insertPlanServicio:",e)}},inserChart:async function(e,t){const o=this._aChartData;const a=this._idPlani;const s=function(e){const t=String(Math.floor(e/60)).padStart(2,"0");const o=String(e%60).padStart(2,"0");return`${t}:${o}:00`};const i=o.map(t=>({hito:t.fase,fecha_inicio:t.fechaInicio,fecha_fin:t.fechaFin,duracion:s(t.duracion),datosProyect_ID:e}));try{const o=await fetch(`/odata/v4/datos-cdo/planificacion?$filter=datosProyect_ID eq '${e}'`,{headers:{"x-csrf-token":t}});const a=await o.json();const s=a.value.map(e=>e.hito);for(const e of i){if(s.includes(e.hito)){const o=a.value.find(t=>t.hito===e.hito);if(o&&o.id){const a=await fetch(`/odata/v4/datos-cdo/planificacion(${o.id})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(e)});if(a.ok){const e=await a.json()}else{const e=await a.text()}}else{}}else{const o=await fetch("/odata/v4/datos-cdo/planificacion",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(e)});if(o.ok){const e=await o.json()}else{const e=await o.text()}}}}catch(e){console.error("Error en la operación:",e)}},insertFacturacion:async function(e){const t=this._sCsrfToken;const o=this.byId("table0");const a=o.getItems();const s=[];const i=parseFloat(this.byId("text73_172746565340569997").getText());const r=this._FacturacionID;a.forEach(function(t){const o=t.getCells();let a="";if(o[0]){if(typeof o[0].getDateValue==="function"){const e=o[0].getDateValue();if(e&&!isNaN(e.getTime())){a=e.toISOString().split("T")[0]}}else if(typeof o[0].getValue==="function"){const e=o[0].getValue();const t=e.split("/");if(t.length===3){const e=new Date(t[2],t[1]-1,t[0]);if(!isNaN(e.getTime())){a=e.toISOString().split("T")[0]}}}}const r=o[1]&&o[1].getValue?o[1].getValue():"";const n=o[2]&&o[2].getValue?parseFloat(o[2].getValue(),10):0;if(a){s.push({fechaEstimida:a,descripcionHito:r,facturacion:n,total:i,datosProyect_ID:e})}});for(let e of s){let o="POST";let a="/odata/v4/datos-cdo/Facturacion";let s={...e};if(r){if(r&&typeof r==="string"){o="PATCH";a=`/odata/v4/datos-cdo/Facturacion(${r})`}else{console.error("ID de facturación no válido:",r);return}}const i=await fetch(a,{method:o,headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(s)});if(i.ok){const e=await i.json()}else{const e=await i.text();console.error("Error al guardar la Facturación:",e)}}},insertarProveedor:async function(e,t){const o=this._sCsrfToken;var a=this.byId("table2");var s=a.getItems();for(let t=0;t<s.length;t++){var i=s[t];var r=i.getCells();var n=this.byId("box_condi").getSelected();var c=this.byId("box_prove").getSelected();var l={checkCondi:n,checkProveedor:c,valueCondi:r[0].getValue(),valueProvee:r[1].getValue(),datosProyect_ID:e};if(this._proveedoresIDs&&this._proveedoresIDs[t]){var d=this._proveedoresIDs[t];await fetch(`/odata/v4/datos-cdo/ProveedoresC(${d})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(l)})}else{await fetch(`/odata/v4/datos-cdo/ProveedoresC`,{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(l)})}}},insertRecursosInternos:async function(e){const t=this._sCsrfToken;const o=this.byId("table_dimicFecha");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._recursosIDs&&this._recursosIDs[o]?this._recursosIDs[o]:null;const r=s.getCells()[0]?.getSelectedKey()||"";const n=s.getCells()[1]?.getSelectedKey()||"";const c=s.getCells()[2]?.getSelectedKey()||"";const l=s.getCells()[3]?.getValue()||"";const d=parseFloat(s.getCells()[4]?.getText()||"0");const u=parseFloat(s.getCells()[5]?.getText()||"0",10);const h=parseFloat(s.getCells()[6]?.getText()||"0",10);const f=parseFloat(s.getCells()[7]?.getText()||"0",10);const p=parseFloat(s.getCells()[8]?.getText()||"0",10);const g=parseFloat(s.getCells()[9]?.getText()||"0",10);const x=parseFloat(s.getCells()[10]?.getText()||"0",10);const y=parseFloat(s.getCells()[11]?.getText()||"0");const I=parseFloat(s.getCells()[12]?.getText()||"0");if(!r||!n||!c){continue}const v={Vertical_ID:r,ConceptoOferta:l,PMJ:d,year1:Number(u.toFixed(2)),year2:Number(h.toFixed(2)),year3:Number(f.toFixed(2)),year4:Number(p.toFixed(2)),year5:Number(g.toFixed(2)),year6:Number(x.toFixed(2)),total:Number(y.toFixed(2)),totalE:Number(I.toFixed(2)),tipoServicio_ID:n,PerfilServicio_ID:c,datosProyect_ID:e};let m;if(i){m=await fetch(`/odata/v4/datos-cdo/RecursosInternos(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}else{m=await fetch("/odata/v4/datos-cdo/RecursosInternos",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}if(m.ok){const e=await m.json();const t=e.ID;if(!t){console.error("    La API no devolvió un ID válido.");return}this._RecursoInt=t;await this.InsertMesAñoRecurInterno(s)}else{const e=await m.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}},"InsertMesAñoRecurInterno":async function(e){const t=this._RecursoInt;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(` Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(` Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn(" No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(` No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuReInter?$filter=mesAno eq '${e}' and RecursosInternos_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMes[a]=i}}else{console.warn(` No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error(" Error al verificar existencia del registro:",e)}const r={RecursosInternos_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuReInter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuReInter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(` Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}}catch(e){console.error(" Error durante envío de datos:",e)}}},"InsertMesAñoServRecurInterno":async function(e){const t=this._idOtrosGastos;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=13;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(` Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn(" No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(` No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(` Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(` Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuServReInter?$filter=mesAno eq '${e}' and otrosGastoRecu_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesServInt=this._IdFechasPorMesServInt||{};this._IdFechasPorMesServInt[a]=i}}else{console.warn(` Error al verificar existencia. Código: ${s.status}`)}}catch(e){console.error(" Error al verificar existencia del registro:",e)}const r={otrosGastoRecu_ID:t,mesAno:e,valor:s};try{let e;if(i){e=await fetch(`/odata/v4/datos-cdo/ValorMensuServReInter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{e=await fetch("/odata/v4/datos-cdo/ValorMensuServReInter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!e.ok){const t=await e.text();console.error(` Error ${e.status} - ${e.statusText}:`,t);throw new Error(`Error al enviar: ${e.statusText}`)}else{}}catch(e){console.error(" Error durante envío de datos:",e)}}},"InsertMesAñoGastoViajRecuInterno":async function(e){const t=this._idOtrosRecu;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=13;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(` Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(` Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn(" No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(` No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(` Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(` Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuGastViaReInter?$filter=mesAno eq '${e}' and otrosRecursos_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesGVinter[a]=i}}else{console.warn(` No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error(" Error al verificar existencia del registro:",e)}const r={otrosRecursos_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuGastViaReInter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuGastViaReInter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(` Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}}catch(e){console.error(" Error durante envío de datos:",e)}}},convertToInt:function(e){const t=parseFloat(e,10);return isNaN(t)?0:t},"InsertmesAñoConsumoExterno":async function(e){const t=this._ConsuExt;const o=this._sCsrfToken;const a=this._idleeConsu;const s={};const i=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let a;if(typeof o.getValue==="function"){a=o.getValue()}else if(typeof o.getText==="function"){a=o.getText()}else{console.warn(`Tipo de celda inesperado en la columna dinámica (índice ${t}):`,o);continue}if(a===null||a===undefined||a===""){console.warn(`Celda vacía o nula en columna ${t}, se omite el envío para esta columna.`);continue}let r=`Columna_${t}`;if(i[t]){const e=i[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("No se pudo obtener el texto del encabezado en la columna",t)}}else{console.warn(`No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`Se omite la columna ${r} porque es un total.`);continue}s[r]=this.convertToInt(a)}for(const[e,a]of Object.entries(s)){if(a===null||a===undefined){console.warn(`No se puede enviar un valor nulo para mes ${e}.`);continue}const s=`${e}_${t}`;let i=null;try{const a=await fetch(`/odata/v4/datos-cdo/ValorMensuConsuEx?$filter=mesAno eq '${e}' and ConsumoExternos_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(a.ok){const e=await a.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesConsuEx[s]=i}}else{console.warn(`No se pudo verificar existencia. Código: ${a.status}`)}}catch(e){console.error("Error al verificar existencia del registro:",e)}const r={ConsumoExternos_ID:t,mesAno:e,valor:a};try{let e;if(i){e=await fetch(`/odata/v4/datos-cdo/ValorMensuConsuEx(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{e=await fetch("/odata/v4/datos-cdo/ValorMensuConsuEx",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!e.ok){const t=await e.text();throw new Error(`Error en la llamada al servicio: ${e.statusText}, Detalles: ${t}`)}else{}}catch(e){console.error("Error al enviar los datos:",e)}}},"InsertmesAñoServConExterno":async function(e){const t=this._idSerConsu;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=13;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(` Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=`/odata/v4/datos-cdo/ValorMensuServConsuEx?$filter=mesAno eq '${e}' and otrosServiciosConsu_ID eq '${t}'`;const r=await fetch(s,{headers:{Accept:"application/json","x-csrf-token":o}});if(r.ok){const e=await r.json();if(e.value.length>0){i=e.value[0].ID;this._IdFechasPorMesServiConsu=this._IdFechasPorMesServiConsu||{};this._IdFechasPorMesServiConsu[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${r.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={otrosServiciosConsu_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuServConsuEx(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuServConsuEx",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertmesAñoGViajeConExterno":async function(e){const t=this._idGasViaConsu;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=13;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en la columna dinámica (índice ${t}):`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, se omite el envío para esta columna.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en la columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Se omite la columna ${r} porque es un total.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    No se puede enviar un valor nulo para mes ${e}.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuGastoViaConsuEx?$filter=mesAno eq '${e}' and GastoViajeConsumo_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesGasViaConsuEx=this._IdFechasPorMesGasViaConsuEx||{};this._IdFechasPorMesGasViaConsuEx[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={GastoViajeConsumo_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuGastoViaConsuEx(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuGastoViaConsuEx",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertMesAñoRecursoExterno":async function(e){const t=this._idRecursoEx;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, se omite.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuRecuExter?$filter=mesAno eq '${e}' and RecursosExternos_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesREExt[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={RecursosExternos_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuRecuExter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuRecuExter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertMesAñosSerRecursoExterno":async function(e){const t=this._idServiExterno;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=13;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuSerExter?$filter=mesAno eq '${e}' and ServiRecurExterno_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesSerReEx[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={ServiRecurExterno_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuSerExter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuSerExter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertMesAñosGastoRecursoExterno":async function(e){const t=this._idGastoRecuExter;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuGastoViExter?$filter=mesAno eq '${e}' and GastoViajeRecExter_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesReEx[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={GastoViajeRecExter_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuGastoViExter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuGastoViExter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertMesAñosOtrosConceptos":async function(e){const t=this._idOtrosConcep;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensuOtrConcep?$filter=mesAno eq '${e}' and otrosConceptos_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesOtConp=this._IdFechasPorMesOtConp||{};this._IdFechasPorMesOtConp[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={otrosConceptos_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensuOtrConcep(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensuOtrConcep",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}}catch(e){console.error("    Error durante envío de datos:",e)}}},"InsertMesAñosLicencia":async function(e){const t=this._idLicencia;const o=this._sCsrfToken;const a={};const s=e.getParent().getColumns();for(let t=12;t<e.getCells().length;t++){const o=e.getCells()[t];let i;if(typeof o.getValue==="function"){i=o.getValue()}else if(typeof o.getText==="function"){i=o.getText()}else{console.warn(`    Tipo de celda inesperado en columna ${t}:`,o);continue}if(i===null||i===undefined||i===""){console.warn(`    Celda vacía o nula en columna ${t}, omitida.`);continue}let r=`Columna_${t}`;if(s[t]){const e=s[t].getHeader();if(e&&typeof e.getText==="function"){r=e.getText()||r}else{console.warn("    No se pudo obtener el texto del encabezado en columna",t)}}else{console.warn(`    No se puede acceder a la columna en índice ${t}`)}if(r.toLowerCase().includes("total")){console.warn(`    Columna ${r} omitida por ser TOTAL.`);continue}a[r]=this.convertToInt(i)}for(const[e,s]of Object.entries(a)){if(s===null||s===undefined){console.warn(`    Valor nulo/undefined para '${e}', se omite.`);continue}const a=`${e}_${t}`;let i=null;try{const s=await fetch(`/odata/v4/datos-cdo/ValorMensulicencia?$filter=mesAno eq '${e}' and licencia_ID eq '${t}'`,{headers:{Accept:"application/json","x-csrf-token":o}});if(s.ok){const e=await s.json();const t=e.value;if(t.length>0){i=t[0].ID;this._IdFechasPorMesLicencia=this._IdFechasPorMesLicencia||{};this._IdFechasPorMesLicencia[a]=i}}else{console.warn(`    No se pudo verificar existencia. Código: ${s.status}`)}}catch(e){console.error("    Error al verificar existencia del registro:",e)}const r={licencia_ID:t,mesAno:e,valor:s};let n;try{if(i){n=await fetch(`/odata/v4/datos-cdo/ValorMensulicencia(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}else{n=await fetch("/odata/v4/datos-cdo/ValorMensulicencia",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":o},body:JSON.stringify(r)})}if(!n.ok){const e=await n.text();console.error(`    Error ${n.status} - ${n.statusText}:`,e);throw new Error(`Error al enviar: ${n.statusText}`)}else{}}catch(e){console.error("    Error durante envío de datos (Licencia):",e)}}},insertServicioInterno:async function(e){const t=this._sCsrfToken;let o;const a=this.byId("tableServicioInterno");const s=a.getItems();for(let a=0;a<s.length;a++){const i=s[a];const r=this._idServiInterno&&this._idServiInterno[a]?this._idServiInterno[a]:null;const n=i.getCells()[0].getSelectedKey();const c=i.getCells()[1].getSelectedKey();const l=i.getCells()[3].getValue();const d=this.convertToInt(i.getCells()[4].getText());const u=parseFloat(i.getCells()[5]?.getText()||"0");const h=parseFloat(i.getCells()[6]?.getText()||"0");const f=parseFloat(i.getCells()[7]?.getText()||"0");const p=parseFloat(i.getCells()[8]?.getText()||"0");const g=parseFloat(i.getCells()[9]?.getText()||"0");const x=parseFloat(i.getCells()[10]?.getText()||"0");const y=this.convertToInt(i.getCells()[11].getText());const I=this.convertToInt(i.getCells()[12].getText());if(!n||!c||!l){continue}const v={Vertical_ID:n,ConceptoOferta:l,PMJ:d,year1:Number(u.toFixed(2)),year2:Number(h.toFixed(2)),year3:Number(f.toFixed(2)),year4:Number(p.toFixed(2)),year5:Number(g.toFixed(2)),year6:Number(x.toFixed(2)),total:Number(y),totalE:I,tipoServicio_ID:c,datosProyect_ID:e};try{if(r){o=await fetch(`/odata/v4/datos-cdo/otrosGastoRecu(${r})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}else{o=await fetch("/odata/v4/datos-cdo/otrosGastoRecu",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}if(o.ok){const e=await o.json();const t=e.ID;this._idOtrosGastos=t;await this.InsertMesAñoServRecurInterno(i,t)}else{const e=await o.text();console.error("Error al guardar la fila "+(a+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(a+1)+":",e)}}},insertGastoViajeInterno:async function(e){const t=this._sCsrfToken;const o=this.byId("tablGastoViajeInterno");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._IdGastoViajInter&&this._IdGastoViajInter[o]?this._IdGastoViajInter[o]:null;const r=s.getCells()[0].getSelectedKey();const n=s.getCells()[1].getSelectedKey();const c=s.getCells()[3].getValue();const l=this.convertToInt(s.getCells()[4].getText());const d=parseFloat(s.getCells()[5]?.getText()||"0");const u=parseFloat(s.getCells()[6]?.getText()||"0");const h=parseFloat(s.getCells()[7]?.getText()||"0");const f=parseFloat(s.getCells()[8]?.getText()||"0");const p=parseFloat(s.getCells()[9]?.getText()||"0");const g=parseFloat(s.getCells()[10]?.getText()||"0");const x=this.convertToInt(s.getCells()[11].getText());const y=this.convertToInt(s.getCells()[12].getText());if(!r||!n||!c){continue}const I={Vertical_ID:r,ConceptoOferta:c,PMJ:l,year1:Number(d.toFixed(2)),year2:Number(u.toFixed(2)),year3:Number(h.toFixed(2)),year4:Number(f.toFixed(2)),year5:Number(p.toFixed(2)),year6:Number(g.toFixed(2)),total:Number(x.toFixed(2)),totalE:y,tipoServicio_ID:n,datosProyect_ID:e};let v;try{if(i){v=await fetch(`/odata/v4/datos-cdo/otrosRecursos(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}else{v=await fetch("/odata/v4/datos-cdo/otrosRecursos",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}if(v.ok){const e=await v.json();const t=e.ID;this._idOtrosRecu=t;await this.InsertMesAñoGastoViajRecuInterno(s)}else{const e=await v.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},insertCosumoExterno:async function(e){const t=this._sCsrfToken;const o=this.byId("tablaConsuExter");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._consumoExternosIDs&&this._consumoExternosIDs[o]?this._consumoExternosIDs[o]:null;const r=s.getCells()[0].getSelectedKey()||"ValorPorDefecto";const n=s.getCells()[1].getSelectedKey()||"ValorPorDefecto";const c=s.getCells()[2].getSelectedKey()||"ValorPorDefecto";const l=s.getCells()[3].getValue()||"";const d=this.convertToInt(s.getCells()[4].getText())||0;const u=parseFloat(s.getCells()[5]?.getText()||"0");const h=parseFloat(s.getCells()[6]?.getText()||"0");const f=parseFloat(s.getCells()[7]?.getText()||"0");const p=parseFloat(s.getCells()[8]?.getText()||"0");const g=parseFloat(s.getCells()[9]?.getText()||"0");const x=parseFloat(s.getCells()[10]?.getText()||"0");const y=parseFloat(s.getCells()[11].getText())||0;const I=parseFloat(s.getCells()[12].getText())||0;if(!r||!n||!c||!l){continue}const v={Vertical_ID:r,ConceptoOferta:l,PMJ:d,year1:Number(u.toFixed(2)),year2:Number(h.toFixed(2)),year3:Number(f.toFixed(2)),year4:Number(p.toFixed(2)),year5:Number(g.toFixed(2)),year6:Number(x.toFixed(2)),total:y,totalC:I,tipoServicio_ID:n,PerfilConsumo_ID:c,datosProyect_ID:e};let m;if(i){m=await fetch(`/odata/v4/datos-cdo/ConsumoExternos(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}else{m=await fetch("/odata/v4/datos-cdo/ConsumoExternos",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}if(m.ok){const e=await m.json();const t=e.ID;this._ConsuExt=t;await this.InsertmesAñoConsumoExterno(s)}else{const e=await m.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}},insertServiConsu:async function(e){const t=this._sCsrfToken;const o=this._idConOS;const a=this.byId("idOtroserConsu");const s=a.getItems();for(let o=0;o<s.length;o++){const a=s[o];const i=this._idConsuOtrser&&this._idConsuOtrser[o]?this._idConsuOtrser[o]:null;const r=a.getCells()[0].getSelectedKey();const n=a.getCells()[1].getSelectedKey();const c=a.getCells()[3].getValue();const l=this.convertToInt(a.getCells()[4].getText());const d=parseFloat(a.getCells()[5]?.getText()||"0");const u=parseFloat(a.getCells()[6]?.getText()||"0");const h=parseFloat(a.getCells()[7]?.getText()||"0");const f=parseFloat(a.getCells()[8]?.getText()||"0");const p=parseFloat(a.getCells()[9]?.getText()||"0");const g=parseFloat(a.getCells()[10]?.getText()||"0");const x=this.convertToInt(a.getCells()[11].getText());const y=this.convertToInt(a.getCells()[12].getText());if(!r||!n||!c){continue}const I={Vertical_ID:r,ConceptoOferta:c,PMJ:l,year1:Number(d.toFixed(2)),year2:Number(u.toFixed(2)),year3:Number(h.toFixed(2)),year4:Number(f.toFixed(2)),year5:Number(p.toFixed(2)),year6:Number(g.toFixed(2)),total:Number(x.toFixed(2)),totalE:y,tipoServicio_ID:n,datosProyect_ID:e};let v;try{if(i){v=await fetch(`/odata/v4/datos-cdo/otrosServiciosConsu(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}else{v=await fetch("/odata/v4/datos-cdo/otrosServiciosConsu",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}if(v.ok){const e=await v.json();const t=e.ID;this._idSerConsu=t;await this.InsertmesAñoServConExterno(a)}else{const e=await v.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},insertGastoConsu:async function(e){const t=this._sCsrfToken;const o=this.byId("idGastoViajeConsu");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._idGastoViajeCOnsu&&this._idGastoViajeCOnsu[o]?this._idGastoViajeCOnsu[o]:null;const r=s.getCells()[0].getSelectedKey();const n=s.getCells()[1].getSelectedKey();const c=s.getCells()[3].getValue();const l=this.convertToInt(s.getCells()[4].getText());const d=parseFloat(s.getCells()[5]?.getText()||"0");const u=parseFloat(s.getCells()[6]?.getText()||"0");const h=parseFloat(s.getCells()[7]?.getText()||"0");const f=parseFloat(s.getCells()[8]?.getText()||"0");const p=parseFloat(s.getCells()[9]?.getText()||"0");const g=parseFloat(s.getCells()[10]?.getText()||"0");const x=this.convertToInt(s.getCells()[11].getText());const y=this.convertToInt(s.getCells()[12].getText());if(!r||!n||!c){continue}const I={Vertical_ID:r,ConceptoOferta:c,PMJ:l,year1:Number(d.toFixed(2)),year2:Number(u.toFixed(2)),year3:Number(h.toFixed(2)),year4:Number(f.toFixed(2)),year5:Number(p.toFixed(2)),year6:Number(g.toFixed(2)),total:x,totalE:y,tipoServicio_ID:n,datosProyect_ID:e};let v;try{if(i){v=await fetch(`/odata/v4/datos-cdo/GastoViajeConsumo(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}else{v=await fetch("/odata/v4/datos-cdo/GastoViajeConsumo",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}if(v.ok){const e=await v.json();const t=e.ID;this._idGasViaConsu=t;await this.InsertmesAñoGViajeConExterno(s);console.log("Fila "+(o+1)+" guardada con éxito: INSERTVIAJES CONSUMO ",e)}else{const e=await v.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},insertRecursoExterno:async function(e){const t=this._sCsrfToken;const o=this.byId("tablaRecExterno");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._RecursoExterno&&this._RecursoExterno[o]?this._RecursoExterno[o]:null;const r=s.getCells()[0].getSelectedKey()||"";const n=s.getCells()[1].getSelectedKey()||"";const c=s.getCells()[2].getValue()||"";const l=s.getCells()[3].getValue()||"";const d=parseFloat(s.getCells()[4].getValue())||0;const u=parseFloat(s.getCells()[5]?.getText()||"0");const h=parseFloat(s.getCells()[6]?.getText()||"0");const f=parseFloat(s.getCells()[7]?.getText()||"0");const p=parseFloat(s.getCells()[8]?.getText()||"0");const g=parseFloat(s.getCells()[9]?.getText()||"0");const x=parseFloat(s.getCells()[10]?.getText()||"0");const y=parseFloat(s.getCells()[11].getText())||0;const I=parseFloat(s.getCells()[12].getText())||0;if(!r&&!n&&!c&&!l){continue}const v={Vertical_ID:r,ConceptoOferta:l,PMJ:d,year1:Number(u.toFixed(2)),year2:Number(h.toFixed(2)),year3:Number(f.toFixed(2)),year4:Number(p.toFixed(2)),year5:Number(g.toFixed(2)),year6:Number(x.toFixed(2)),total:y,totalR:I,tipoServicio_ID:n,PerfilServicio:c,datosProyect_ID:e};let m;try{if(i){m=await fetch(`/odata/v4/datos-cdo/RecursosExternos(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}else{m=await fetch("/odata/v4/datos-cdo/RecursosExternos",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(v)})}if(m.ok){const e=await m.json();const t=e.ID;this._idRecursoEx=t;await this.InsertMesAñoRecursoExterno(s)}else{const e=await m.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},insertServicioRecuExter:async function(e){const t=this._sCsrfToken;const o=this.byId("idServiExterno");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._idOtroSerEx&&this._idOtroSerEx[o]?this._idOtroSerEx[o]:null;const r=s.getCells()[0].getSelectedKey();const n=s.getCells()[1].getSelectedKey();const c=s.getCells()[3].getValue();const l=this.convertToInt(s.getCells()[4].getText());const d=parseFloat(s.getCells()[5]?.getText()||"0");const u=parseFloat(s.getCells()[6]?.getText()||"0");const h=parseFloat(s.getCells()[7]?.getText()||"0");const f=parseFloat(s.getCells()[8]?.getText()||"0");const p=parseFloat(s.getCells()[9]?.getText()||"0");const g=parseFloat(s.getCells()[10]?.getText()||"0");const x=this.convertToInt(s.getCells()[11].getText());const y=this.convertToInt(s.getCells()[12].getText());if(!r||!n||!c){continue}const I={Vertical_ID:r,ConceptoOferta:c,PMJ:l,year1:Number(d.toFixed(2)),year2:Number(u.toFixed(2)),year3:Number(h.toFixed(2)),year4:Number(f.toFixed(2)),year5:Number(p.toFixed(2)),year6:Number(g.toFixed(2)),total:x,totalE:y,tipoServicio_ID:n,datosProyect_ID:e};let v;if(i){v=await fetch(`/odata/v4/datos-cdo/serviRecurExter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}else{v=await fetch("/odata/v4/datos-cdo/serviRecurExter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}if(v.ok){const e=await v.json();const t=e.ID;this._idServiExterno=t;await this.InsertMesAñosSerRecursoExterno(s)}else{const e=await v.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}},insertGastoViajeExterno:async function(e){const t=this._sCsrfToken;const o=this._idReExGas;const a=this.byId("idGastoRecuExter");const s=a.getItems();for(let o=0;o<s.length;o++){const a=s[o];const i=this._idGasViaReEx&&this._idGasViaReEx[o]?this._idGasViaReEx[o]:null;const r=a.getCells()[0].getSelectedKey();const n=a.getCells()[1].getSelectedKey();const c=a.getCells()[3].getValue();const l=this.convertToInt(a.getCells()[4].getText());const d=parseFloat(a.getCells()[5]?.getText()||"0");const u=parseFloat(a.getCells()[6]?.getText()||"0");const h=parseFloat(a.getCells()[7]?.getText()||"0");const f=parseFloat(a.getCells()[8]?.getText()||"0");const p=parseFloat(a.getCells()[9]?.getText()||"0");const g=parseFloat(a.getCells()[10]?.getText()||"0");const x=this.convertToInt(a.getCells()[11].getText());const y=this.convertToInt(a.getCells()[12].getText());if(!r||!n||!c){continue}const I={Vertical_ID:r,ConceptoOferta:c,PMJ:l,year1:Number(d.toFixed(2)),year2:Number(u.toFixed(2)),year3:Number(h.toFixed(2)),year4:Number(f.toFixed(2)),year5:Number(p.toFixed(2)),year6:Number(g.toFixed(2)),total:x,totalE:y,tipoServicio_ID:n,datosProyect_ID:e};let v;if(i){v=await fetch(`/odata/v4/datos-cdo/GastoViajeRecExter(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}else{v=await fetch("/odata/v4/datos-cdo/GastoViajeRecExter",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(I)})}if(v.ok){const e=await v.json();const t=e.ID;this._idGastoRecuExter=t;await this.InsertMesAñosGastoRecursoExterno(a)}else{const e=await v.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}},insertarOtrosConceptos:async function(e){const t=this._sCsrfToken;const o=this.byId("tablaInfrestuctura");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._OtrosConceptos&&this._OtrosConceptos[o]?this._OtrosConceptos[o]:null;const r=s.getCells()[0].getSelectedKey();const n=s.getCells()[2].getValue();const c=parseFloat(s.getCells()[3]?.getText());const l=parseFloat(s.getCells()[4]?.getText()||"0");const d=parseFloat(s.getCells()[5]?.getText()||"0");const u=parseFloat(s.getCells()[6]?.getText()||"0");const h=parseFloat(s.getCells()[7]?.getText()||"0");const f=parseFloat(s.getCells()[8]?.getText()||"0");const p=parseFloat(s.getCells()[9]?.getText()||"0");const g=parseFloat(s.getCells()[10]?.getText());const x=parseFloat(s.getCells()[11]?.getText());if(!r||!n){continue}const y={Vertical_ID:r,ConceptoOferta:n,PMJ:c,year1:Number(l.toFixed(2)),year2:Number(d.toFixed(2)),year3:Number(u.toFixed(2)),year4:Number(h.toFixed(2)),year5:Number(f.toFixed(2)),year6:Number(p.toFixed(2)),total:g,totalC:x,datosProyect_ID:e};let I;try{if(i){I=await fetch(`/odata/v4/datos-cdo/otrosConceptos(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(y)})}else{I=await fetch("/odata/v4/datos-cdo/otrosConceptos",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(y)})}if(I.ok){const e=await I.json();const t=e.ID;this._idOtrosConcep=t;await this.InsertMesAñosOtrosConceptos(s)}else{const e=await I.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},insertarLicencia:async function(e){const t=this._sCsrfToken;const o=this.byId("tablaLicencia");const a=o.getItems();for(let o=0;o<a.length;o++){const s=a[o];const i=this._idLicencia&&this._idLicencia[o]?this._idLicencia[o]:null;const r=s.getCells()[0].getSelectedKey();const n=s.getCells()[2].getValue();const c=parseFloat(s.getCells()[3]?.getText());const l=parseFloat(s.getCells()[5]?.getText()||"0");const d=parseFloat(s.getCells()[6]?.getText()||"0");const u=parseFloat(s.getCells()[7]?.getText()||"0");const h=parseFloat(s.getCells()[8]?.getText()||"0");const f=parseFloat(s.getCells()[9]?.getText()||"0");const p=parseFloat(s.getCells()[10]?.getText()||"0");const g=parseFloat(s.getCells()[4]?.getText());const x=parseFloat(s.getCells()[5]?.getText());if(!r||!n){continue}const y={Vertical_ID:r,ConceptoOferta:n,PMJ:c,year1:Number(l.toFixed(2)),year2:Number(d.toFixed(2)),year3:Number(u.toFixed(2)),year4:Number(h.toFixed(2)),year5:Number(f.toFixed(2)),year6:Number(p.toFixed(2)),total:g,totalC:x,datosProyect_ID:e};let I;try{if(i){I=await fetch(`/odata/v4/datos-cdo/LicenciasCon(${i})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(y)})}else{I=await fetch("/odata/v4/datos-cdo/LicenciasCon",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(y)})}if(I.ok){const e=await I.json();const t=e.ID;this._idLicencia=t;await this.InsertMesAñosLicencia(s)}else{const e=await I.text();console.error("Error al guardar la fila "+(o+1)+":",e)}}catch(e){console.error("Error en la llamada al servicio para la fila "+(o+1)+":",e)}}},convertToInt:function(e){const t=parseFloat(e,10);return isNaN(t)?null:t},insertClientFactura:async function(e){const t=this._sCsrfToken;var o=this.byId("table_clienteFac");var a=o.getItems();var s=[];var i=0;a.forEach(function(t){var o=t.getCells();var a=o[0]?o[0].getMetadata().getName()==="sap.m.Input"?o[0].getValue():o[0].getText():"";var r=o[1]?o[1].getMetadata().getName()==="sap.m.Input"?o[1].getValue():o[1].getText():"";if(a.trim()==="Total"){return}var n=this.byId("text73_172746565340567").getText();var n=parseFloat(n.replace("%","").replace(",","."))||0;if(a===""&&r===""){return}s.push({juridica:a,oferta:r,total:n,datosProyect_ID:e});i+=parseFloat(r)||0}.bind(this));try{const o=await fetch(`/odata/v4/datos-cdo/ClientFactura?$filter=datosProyect_ID eq '${e}'`,{method:"GET",headers:{Accept:"application/json","x-csrf-token":t}});if(!o.ok)throw new Error("Error al verificar existencia de las Facturas");const a=await o.json();const i=a.value||[];for(let e of s){let o=i.find(t=>t.juridica===e.juridica);if(o){const a=await fetch(`/odata/v4/datos-cdo/ClientFactura(${o.ID})`,{method:"PATCH",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(e)});if(a.ok){}else{}}else{const o=await fetch("/odata/v4/datos-cdo/ClientFactura",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":t},body:JSON.stringify(e)});if(o.ok){}else{}}}}catch(e){console.error("Error en la operación:",e)}},metodoSumar:function(){var e=this.byId("table_clienteFac");var t=e.getItems();var o=0;t.forEach(function(e,a){if(a<t.length-1){var s=e.getCells();var i=s[1];var r="";if(i.getMetadata().getName()==="sap.m.Input"){r=i.getValue()}else if(i.getMetadata().getName()==="sap.m.Text"){r=i.getText()}var n=parseFloat((r||"").toString().trim());if(!isNaN(n)){o+=n}}});this.byId("text73_172746565340567").setText(o.toFixed(2)+"%");this._totalOferta=o;if(o.toFixed(2)!=100){}},metodoSumarFac:function(){var e=this.byId("table0");var t=e.getItems();var o=0;t.forEach(function(e,a){if(a<t.length-1){var s=e.getCells();var i="";var r=s[2];if(r.getMetadata().getName()==="sap.m.Input"){i=r.getValue()}i=i.trim();var n=parseFloat(i);if(!isNaN(n)){o+=n}}});this.byId("text73_172746565340569997").setText(o.toFixed(2))},formatDuration:function(e){const t=Math.floor(e);const o=Math.floor((e-t)*60);const a=0;return`${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(a).padStart(2,"0")}`},onClearFields:function(){var e=this.getView();function t(e){if(e instanceof sap.m.Input){e.setValue("")}else if(e instanceof sap.m.Select||e instanceof sap.m.ComboBox){e.setSelectedKey("")}else if(e instanceof sap.m.DatePicker){e.setDateValue(null)}else if(e instanceof sap.m.TextArea){e.setValue("")}else if(e instanceof sap.m.CheckBox){e.setSelected(false)}if(e.getAggregation){const o=e.getMetadata().getAllAggregations();for(let a in o){const o=e.getAggregation(a);if(Array.isArray(o)){o.forEach(t)}else if(o instanceof sap.ui.core.Control){t(o)}}}}e.findAggregatedObjects(false,t)},onSelectIniMethod:function(e){this.onInputChange(e);this.onSelectOpx(e)},onselectmethodsetinfo:function(e){this.fechasDinamicas(e);this.CaseAno()},CaseAno:function(e){var t=this.getView().byId("date_inico");var o=this.getView().byId("date_fin");var a=t.getDateValue();var s=o.getDateValue();if(a&&s){var i=a.getFullYear();var r=s.getFullYear();if(i>r){sap.m.MessageToast.show("La fecha de inicio no puede ser mayor que la fecha de fin.");return}var n=[];for(var c=i;c<=r;c++){n.push(c)}let e=this.calcularDistribucionInput();if(!e||!e.valoresDistribuidos)return;let t=e.valoresDistribuidos;let o=e.acumuladoTextPorTablaYAnio;if(!t||Object.keys(t).length===0){return}var l=this;var d=0;var u={};var h={};var f={};n.forEach(e=>{u[e]=0;h[e]={}});Object.keys(t).forEach(function(e){n.forEach(function(o){if(t[e]&&t[e][o]){t[e][o].forEach(e=>{var t=e.elemento;var a=parseFloat(e.valor)||0;u[o]+=a;d+=a;if(!h[o][t]){h[o][t]=0}h[o][t]+=a;if(!f[t]){f[t]=0}f[t]+=a})}})});n.forEach(e=>{switch(e){case 2025:l.getView().byId("tipoS2025").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteT2025").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("cellCostesTotales_1_1").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecurso2025").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteD2025").setText((h[e]["Input2"]||0).toFixed(2)+"€");l.getView().byId("costes_indirectos2025").setText((h[e]["Input3"]||0).toFixed(2)+"€");this.getView().byId("text129CosteDi").setText((o[e]?.table_dimicFecha??0).toFixed(2)+"€");this.getView().byId("text130CosteDi").setText((o[e]?.tablaConsuExter??0).toFixed(2)+"€");this.getView().byId("text210").setText((o[e]?.tablGastoViajeInterno??0).toFixed(2)+"€");this.getView().byId("text400").setText((o[e]?.tablaRecExterno??0).toFixed(2)+"€");this.getView().byId("text133").setText((o[e]?.tablaLicencia??0).toFixed(2)+"€");this.getView().byId("text200").setText((o[e]?.tablaInfrestuctura??0).toFixed(2)+"€");let t=(o[2025]?.table_dimicFecha||0)+(o[2025]?.tablaConsuExter||0)+(o[2025]?.tablGastoViajeInterno||0)+(o[2025]?.tablaRecExterno||0)+(o[2025]?.tablaLicencia||0)+(o[2025]?.tablaInfrestuctura||0);l.getView().byId("text75_1729073618729").setText(t.toFixed(2)+"€");break;case 2026:l.getView().byId("tipoS2026").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecurso2026").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteT2026").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("cellCostesTotales_1_2").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteD2026").setText((h[e]["Input2"]||0).toFixed(2)+"€");l.getView().byId("costes_indirectos2026").setText((h[e]["Input3"]||0).toFixed(2)+"€");l.getView().byId("text128CosteDi").setText((o[e]?.table_dimicFecha??0).toFixed(2)+"€");l.getView().byId("text134CosteDi").setText((o[e]?.tablaConsuExter??0).toFixed(2)+"€");this.getView().byId("text211").setText((o[e]?.tablGastoViajeInterno??0).toFixed(2)+"€");this.getView().byId("text401").setText((o[e]?.tablaRecExterno??0).toFixed(2)+"€");this.getView().byId("text1341").setText((o[e]?.tablaLicencia??0).toFixed(2)+"€");this.getView().byId("text201").setText((o[e]?.tablaInfrestuctura??0).toFixed(2)+"€");let a=(o[2026]?.table_dimicFecha||0)+(o[2026]?.tablaConsuExter||0)+(o[2026]?.tablGastoViajeInterno||0)+(o[2026]?.tablaRecExterno||0)+(o[2026]?.tablaLicencia||0)+(o[2026]?.tablaInfrestuctura||0);l.getView().byId("text76_1729073618732").setText(a.toFixed(2)+"€");break;case 2027:l.getView().byId("tipoS2027").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecurso2027").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteT2027").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteD2027").setText((h[e]["Input2"]||0).toFixed(2)+"€");l.getView().byId("costes_indirectos2027").setText((h[e]["Input3"]||0).toFixed(2)+"€");l.getView().byId("text135").setText((o[e]?.tablaConsuExter??0).toFixed(2)+"€");l.getView().byId("text140CosteDi").setText((o[e]?.table_dimicFecha??0).toFixed(2)+"€");this.getView().byId("text212").setText((o[e]?.tablGastoViajeInterno??0).toFixed(2)+"€");this.getView().byId("text402").setText((o[e]?.tablaRecExterno??0).toFixed(2)+"€");this.getView().byId("text1352").setText((o[e]?.tablaLicencia??0).toFixed(2)+"€");this.getView().byId("text202").setText((o[e]?.tablaInfrestuctura??0).toFixed(2)+"€");let s=(o[2027]?.table_dimicFecha||0)+(o[2027]?.tablaConsuExter||0)+(o[2027]?.tablGastoViajeInterno||0)+(o[2027]?.tablaRecExterno||0)+(o[2027]?.tablaLicencia||0)+(o[2027]?.tablaInfrestuctura||0);l.getView().byId("text77_1729073618734").setText(s.toFixed(2)+"€");break;case 2028:l.getView().byId("tipoS2028").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecurso2027").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteT2028").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("text141CosteDi").setText((o[e]?.table_dimicFecha??0).toFixed(2)+"€");l.getView().byId("text136").setText((o[e]?.tablaConsuExter??0).toFixed(2)+"€");this.getView().byId("text213").setText((o[e]?.tablGastoViajeInterno??0).toFixed(2)+"€");this.getView().byId("text403").setText((o[e]?.tablaRecExterno??0).toFixed(2)+"€");this.getView().byId("text1363").setText((o[e]?.tablaLicencia??0).toFixed(2)+"€");this.getView().byId("text203").setText((o[e]?.tablaInfrestuctura??0).toFixed(2)+"€");let i=(o[2028]?.table_dimicFecha||0)+(o[2028]?.tablaConsuExter||0)+(o[2028]?.tablGastoViajeInterno||0)+(o[2028]?.tablaRecExterno||0)+(o[2028]?.tablaLicencia||0)+(o[2028]?.tablaInfrestuctura||0);l.getView().byId("text300").setText(i.toFixed(2)+"€");break;case 2029:l.getView().byId("tipoS2029").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecurso2027").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteT2029").setText((h[e]["Input1"]||0).toFixed(2)+"€");l.getView().byId("text143CosteDi").setText((o[e]?.table_dimicFecha??0).toFixed(2)+"€");this.getView().byId("text214").setText((o[e]?.tablGastoViajeInterno??0).toFixed(2)+"€");this.getView().byId("text138").setText((o[e]?.tablaConsuExter??0).toFixed(2)+"€");this.getView().byId("text404").setText((o[e]?.tablaRecExterno??0).toFixed(2)+"€");this.getView().byId("text1374").setText((o[e]?.tablaLicencia??0).toFixed(2)+"€");this.getView().byId("text204").setText((o[e]?.tablaInfrestuctura??0).toFixed(2)+"€");let r=(o[2029]?.table_dimicFecha||0)+(o[2029]?.tablaConsuExter||0)+(o[2029]?.tablGastoViajeInterno||0)+(o[2029]?.tablaRecExterno||0)+(o[2029]?.tablaLicencia||0)+(o[2029]?.tablaInfrestuctura||0);l.getView().byId("text301").setText(r.toFixed(2)+"€");break}});l.getView().byId("tipoSTotal").setText((f["Input1"]||0).toFixed(2)+"€");l.getView().byId("TRecursoTotal").setText((f["Input1"]||0).toFixed(2)+"€");l.getView().byId("TSCosteTotalD").setText((f["Input2"]||0).toFixed(2)+"€");l.getView().byId("TSCosteTotal").setText((f["Input1"]||0).toFixed(2)+"€");l.getView().byId("cellCostesTotales_1_7").setText((f["Input1"]||0).toFixed(2)+"€");l.getView().byId("costes_indirectosTotal").setText((f["Input3"]||0).toFixed(2)+"€");l.getView().byId("text70_1729079344938").setText((f["Text1"]||0).toFixed(2)+"€");l.getView().byId("text137").setText((f["Text4"]||0).toFixed(2)+"€")}else{}},onDateChange:function(){this.updateVizFrame()},fechasDinamicas:function(){var e=this.getView().getModel("dynamicInputs");var t=null;if(!e){e=new sap.ui.model.json.JSONModel;this.getView().setModel(e,"dynamicInputs")}else{t=e.getData()}this._inputsDinamicos={};this._tableValues={};this._yearlySums={};this._monthlySums={};var o=this.getView().byId("date_inico");var a=this.getView().byId("date_fin");if(!o||!a){console.error("Error: No se pudieron obtener los DatePickers.");return}var s=o.getDateValue();var i=a.getDateValue();if(!s||!i){return}var r=this.getMonthsDifference(s,i);var n=["box0_1714747137718","box0_1727879568594","box0_1727879817594","box0_1721815443829","box0_1727948724833","box0_1727950351451","box0_17218154429","box0_1727953252765","box1_1727953468615","box0_17254429","box0_1727955568380"];n.forEach(e=>{var t=this.getView().byId(e);if(t){t.setWidth(r>3?"3000px":"100%")}});var c=["tablaConsuExter","table_dimicFecha","tablaRecExterno","idOtroserConsu","idGastoViajeConsu","idServiExterno","idGastoRecuExter","tablaInfrestuctura","tablaLicencia","tableServicioInterno","tablGastoViajeInterno"];var l={};c.forEach(e=>{var o=this.getView().byId(e);if(!o){console.error("Error: No se pudo obtener la tabla con ID "+e);return}var a=o.getColumns().length;for(var i=a-1;i>=0;i--){var n=o.getColumns()[i].getHeader();if(n&&/\d{4}-\w+/.test(n.getText())){o.removeColumn(o.getColumns()[i])}}o.getItems().forEach(e=>{var t=e.getCells();var a=o.getColumns().filter(e=>{var t=e.getHeader();return!(t&&/\d{4}-\w+/.test(t.getText()))}).length;while(e.getCells().length>a){e.removeCell(e.getCells().length-1)}});var c=this.findTotalColumnIndex(o);l[e]={};for(var d=0;d<=r;d++){var u=new Date(s.getFullYear(),s.getMonth()+d,1);var h=u.getFullYear();var f=u.toLocaleString("default",{month:"long"});var p=h+"-"+f;var g=new sap.m.Column({header:new sap.m.Label({text:p}),width:"100px"});o.insertColumn(g,c+1+d);o.getItems().forEach((o,a)=>{l[e][a]=l[e][a]||{};var s="";if(t&&t[e]&&t[e][a]){s=t[e][a][p]||""}var i=new sap.m.Input({placeholder:"0.00",value:s,change:this.handleInputChange.bind(this,e,a,d,h)});i.attachBrowserEvent("paste",this._onPasteValues.bind(this));o.addCell(i);this._inputsDinamicos=this._inputsDinamicos||{};this._inputsDinamicos[e]=this._inputsDinamicos[e]||{};this._inputsDinamicos[e][a]=this._inputsDinamicos[e][a]||{};this._inputsDinamicos[e][a][p]=i;l[e][a][p]=s;if(s!==""){this.handleInputChange(e,a,d,h,{getParameter:()=>s})}})}var x=this.getView().byId("scroll_container_"+e);if(x){x.setHorizontal(true);x.setVertical(false);x.setWidth("100%")}});e.setData(l)},_onPasteValues:function(e){e.preventDefault();var t=e.originalEvent.clipboardData;if(!t)return;var o=t.getData("text");var a=o.split(/\t/);var s=e.target;var i=false;for(var r in this._inputsDinamicos){var n=this._inputsDinamicos[r];for(var c in n){for(var l in n[c]){var d=n[c][l];if(!d||typeof d.getDomRef!=="function")continue;var u=d.getDomRef();if(!u)continue;if(u.contains(s)){var h=jQuery(s).closest("td");var f=jQuery(s).closest("tr");if(!h.length||!f.length)return;var p=f.find("td");var g=p.index(h);for(var x=0;x<a.length;x++){var y=g+x;var I=p[y];if(!I)continue;var v=jQuery(I).find("input")[0];if(v){v.value=a[x].trim();v.dispatchEvent(new Event("input",{bubbles:true}));v.dispatchEvent(new Event("change",{bubbles:true}))}}i=true;break}}if(i)break}if(i)break}if(!i){console.warn("    No se pudo identificar el input en _inputsDinamicos.")}},resetTableAccumulations:function(e){if(!this._yearlySums[e]){this._yearlySums[e]={}}if(!this._yearlySums[e][this.currentRow]){this._yearlySums[e][this.currentRow]={}}},handleInputChange:function(e,t,o,a,s){this._handleInputChangeCounter=(this._handleInputChangeCounter||0)+1;var i=parseFloat(s.getParameter("value"))||0;if(!this._tableValues)this._tableValues={};if(!this._tableValues[e])this._tableValues[e]={};if(!this._tableValues[e][t])this._tableValues[e][t]={};var r=this._tableValues[e][t][o]||0;if(i!==r){this._tableValues[e][t][o]=i;if(!this._editedRows)this._editedRows={};if(!this._editedRows[e])this._editedRows[e]=new Set;this._editedRows[e].add(t);this._tableChanged=true;if(!this._yearlySums)this._yearlySums={};if(!this._yearlySums[t])this._yearlySums[t]={};if(this._yearlySums[t][a]!==undefined){this._yearlySums[t][a]-=r}this._yearlySums[t][a]=(this._yearlySums[t][a]||0)+i;if(!this._yearlySums[e])this._yearlySums[e]={};if(!this._yearlySums[e][t])this._yearlySums[e][t]={};if(!this._yearlySums[e][t][a])this._yearlySums[e][t][a]=0;this._yearlySums[e][t][a]-=r;this._yearlySums[e][t][a]+=i;this.updateTotalField(e,t,i);if(!this._insercionesPorAnoYTabla)this._insercionesPorAnoYTabla={};if(!this._insercionesPorAnoYTabla[a])this._insercionesPorAnoYTabla[a]={};if(!this._insercionesPorAnoYTabla[a][e])this._insercionesPorAnoYTabla[a][e]=0;this._insercionesPorAnoYTabla[a][e]++;if(!this._insercionesPorTabla)this._insercionesPorTabla={};if(!this._insercionesPorTabla[e])this._insercionesPorTabla[e]=0;this._insercionesPorTabla[e]++;this.calcularPorcentajeInserciones();this.CaseAno(e);var n=this.getView().getModel("dynamicInputs");var c=n.getData();if(!c[e]){c[e]={}}if(!c[e][t]){c[e][t]={}}var l=new Date(this.getView().byId("date_inico").getDateValue().getFullYear(),this.getView().byId("date_inico").getDateValue().getMonth()+o,1);var d=l.getFullYear();var u=l.toLocaleString("default",{month:"long"});var h=d+"-"+u;c[e][t][h]=i;n.setData(c);n.refresh()}else{}},calcularPorcentajeInserciones:function(){let e=0;for(let t in this._insercionesPorTabla){e+=this._insercionesPorTabla[t]}if(e===0){return}this._porcentajesPorTabla={};for(let t in this._insercionesPorTabla){let o=this._insercionesPorTabla[t]/e*100;this._porcentajesPorTabla[t]=o}if(this._insercionesPorAnoYTabla){for(let t in this._insercionesPorAnoYTabla){for(let o in this._insercionesPorAnoYTabla[t]){const a=this._insercionesPorAnoYTabla[t][o]||0;let s=a/e*100}}}},calcularDistribucionInput:function(){let e=[{id:"input0_1725625161348",nombre:"Input1",tipo:"input"},{id:"totalSubtotal",nombre:"Input2",tipo:"input"},{id:"input2_1724756105",nombre:"Input3",tipo:"input"},{id:"text33",nombre:"Text1",tipo:"text",tabla:"table_dimicFecha"},{id:"text32_1723542481599",nombre:"Text2",tipo:"text",tabla:"table_dimicFecha"},{id:"text32_172341599",nombre:"Text3",tipo:"text",tabla:"table_dimicFecha"},{id:"text560",nombre:"Text4",tipo:"text",tabla:"tablaConsuExter"},{id:"text56",nombre:"Text5",tipo:"text",tabla:"tablaConsuExter"},{id:"text50006",nombre:"Text6",tipo:"text",tabla:"tablaConsuExter"},{id:"text32_172354299",nombre:"Text7",tipo:"text",tabla:"tableServicioInterno"},{id:"text3888",nombre:"Text8",tipo:"text",tabla:"tablGastoViajeInterno"},{id:"text32_172354299",nombre:"text40",tipo:"text",tabla:"tablGastoViajeInterno"},{id:"text56000",nombre:"Text8",tipo:"text",tabla:"tablaRecExterno"},{id:"text5644",nombre:"text9",tipo:"text",tabla:"tablaRecExterno"},{id:"text500406",nombre:"text10",tipo:"text",tabla:"tablaRecExterno"},{id:"text90_1729173466313",nombre:"text11",tipo:"text",tabla:"tablaLicencia"},{id:"text75_1729177384465",nombre:"text12",tipo:"text",tabla:"tablaLicencia"},{id:"text78_1729173199360",nombre:"t ext13",tipo:"text",tabla:"tablaInfrestuctura"},{id:"text32_171145299",nombre:"text14",tipo:"text",tabla:"tablaInfrestuctura"}];let t={};let o={};e.forEach(e=>{let a=this.byId(e.id);if(!a){console.error(`    No se encontró el elemento con ID '${e.id}'`);return}let s=e.tipo==="input"?parseFloat(a.getValue())||0:parseFloat(a.getText())||0;if(s===0){return}for(let a in this._porcentajesPorTabla){if(e.tipo==="text"&&a!==e.tabla){continue}let i=this._porcentajesPorTabla[a];let r=e.tipo==="text"?s:s*i/100;if(!t[a]){t[a]={}}let n=Object.entries(this._insercionesPorAnoYTabla).filter(([e,t])=>t[a]).map(([e])=>e);n.forEach(i=>{let r=this._insercionesPorAnoYTabla[i][a];if(!this._insercionesPorTabla[a]||this._insercionesPorTabla[a]===0){return}if(!t[a][i]){t[a][i]=[]}if(!o[i]){o[i]={}}if(!o[i][a]){o[i][a]=0}if(e.tipo==="text"){let r=n.length;if(r>1){let n=100/r;let c=s*n/100;t[a][i].push({elemento:e.nombre,porcentaje:n.toFixed(2),valor:c.toFixed(2)});o[i][a]+=parseFloat(c.toFixed(2))}else{t[a][i].push({elemento:e.nombre,porcentaje:100,valor:s.toFixed(2)});o[i][a]+=parseFloat(s.toFixed(2))}}else{let o=r/this._insercionesPorTabla[a]*100;let n=s*o/100;t[a][i].push({elemento:e.nombre,porcentaje:o.toFixed(2),valor:n.toFixed(2)})}})}});return{valoresDistribuidos:t,acumuladoTextPorTablaYAnio:o}},updateTotalField:function(e,t,o,a,s){var i=0;var r=0;var n=0;var c=0;var l=0;let d=0;var u,h,f;var p=this.getTotalForYear(2025,t,e);var g=this.getTotalForYear(2026,t,e);var x=this.getTotalForYear(2027,t,e);var y=this.getTotalForYear(2028,t,e);var I=this.getTotalForYear(2029,t,e);var v=this.getTotalForYear(2030,t,e);if(e==="tablaConsuExter"){var m=this.byId("tablaConsuExter");if(!m){console.error(" 2. La tabla 'tablaConsuExter' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){i=o[4].getText();o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");r=p+g+x+y+I+v;var a=i*r;o[11].setText(r.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="table_dimicFecha"){var m=this.byId("table_dimicFecha");if(!m){console.error("3. La tabla 'table_dimicFecha' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){var a=o[4].getText();o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");n=p+g+x+y+I+v;var s=a*n;o[11].setText(n.toFixed(2));o[12].setText(s.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="tablaRecExterno"){var m=this.byId("tablaRecExterno");if(!m){console.error("4. La tabla 'tablaRecExterno' no fue encontrada.");return}this._editedRows[e].forEach(function(t){var o=m.getItems()[t];if(o){var a=o.getCells();if(a&&a.length>=13){var s=parseFloat(a[4].getValue().replace(",","."));if(isNaN(s)){s=0}a[5].setText(p.toFixed(2)+"€");a[6].setText(g.toFixed(2)+"€");a[7].setText(x.toFixed(2)+"€");a[8].setText(y.toFixed(2)+"€");a[9].setText(I.toFixed(2)+"€");a[10].setText(v.toFixed(2)+"€");var i=p+g+x+y+I+v;a[11].setText(i.toFixed(2)+"€");var r=s*i;a[12].setText(r.toFixed(2)+"€");a[4].attachLiveChange(function(t){var o=parseFloat(t.getSource().getValue().replace(",","."));if(!isNaN(o)){var s=o*i;a[12].setText(s.toFixed(2)+"€")}else{a[12].setText("0.00€")}this.onSumarColumna(e)}.bind(this))}}}.bind(this));this.onSumarColumna(e)}else if(e==="idOtroserConsu"){var m=this.byId("idOtroserConsu");if(!m){console.error("La tabla 'idOtroserConsu' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="idGastoViajeConsu"){var m=this.byId("idGastoViajeConsu");if(!m){console.error("La tabla 'idGastoViajeConsu' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="idServiExterno"){var m=this.byId("idServiExterno");if(!m){console.error("La tabla 'idServiExterno' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="idGastoRecuExter"){var m=this.byId("idGastoRecuExter");if(!m){console.error("La tabla 'idGastoRecuExter' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="tablaInfrestuctura"){var m=this.byId("tablaInfrestuctura");if(!m){console.error("La tabla 'tablaInfrestuctura' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[4].setText(p.toFixed(2)+"€");o[5].setText(g.toFixed(2)+"€");o[6].setText(x.toFixed(2)+"€");o[7].setText(y.toFixed(2)+"€");o[8].setText(I.toFixed(2)+"€");o[9].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[10].setText(a.toFixed(2)+"€");o[11].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="tablaLicencia"){var m=this.byId("tablaLicencia");if(!m){console.error("La tabla 'tablaLicencia' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=12){o[4].setText(p.toFixed(2)+"€");o[5].setText(g.toFixed(2)+"€");o[6].setText(x.toFixed(2)+"€");o[7].setText(y.toFixed(2)+"€");o[8].setText(I.toFixed(2)+"€");o[9].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[10].setText(a.toFixed(2)+"€");o[11].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="tableServicioInterno"){var m=this.byId("tableServicioInterno");if(!m){console.error("La tabla 'tableServicioInterno' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else if(e==="tablGastoViajeInterno"){var m=this.byId("tablGastoViajeInterno");if(!m){console.error("La tabla 'tablGastoViajeInterno' no fue encontrada.");return}this._editedRows[e].forEach(function(e){var t=m.getItems()[e];if(t){var o=t.getCells();if(o&&o.length>=11){o[5].setText(p.toFixed(2)+"€");o[6].setText(g.toFixed(2)+"€");o[7].setText(x.toFixed(2)+"€");o[8].setText(y.toFixed(2)+"€");o[9].setText(I.toFixed(2)+"€");o[10].setText(v.toFixed(2)+"€");var a=p+g+x+y+I+v;o[11].setText(a.toFixed(2)+"€");o[12].setText(a.toFixed(2)+"€")}}});this.onSumarColumna(e)}else{console.error("Tabla no reconocida: "+e)}if(this._editedRows&&this._editedRows[e]&&typeof this._editedRows[e].clear==="function"){this._editedRows[e].clear()}else{console.warn("No es un Set, se reinicia correctamente");this._editedRows[e]=new Set}},getTotalForYear:function(e,t,o){if(Number(t)!==Number(this.currentRow)||o!==this.currentTableId){this.resetTableAccumulations(o);this.currentRow=Number(t);this.currentTableId=o}if(!this._yearlySums[o]){console.warn(`    No hay datos para la tabla ${o}. Creando estructura.`);this._yearlySums[o]={}}if(!this._yearlySums[o][t]){console.warn(`    No hay datos para la fila ${t} en la tabla ${o}. Creando estructura.`);this._yearlySums[o][t]={}}if(this._yearlySums[o][t][e]===undefined){this._yearlySums[o][t][e]=0}return this._yearlySums[o][t][e]},onSumarColumna:function(e){var t=this.byId(e);var o=t.getItems();var a=0;var s=0;var i=0;var r=0;var n=0;o.forEach(function(e){var t=e.getCells();var o=t.length>11&&t[11].getText?t[11].getText():"0";var c=t.length>12&&t[12].getText?t[12].getText():"0";a+=parseFloat(o)||0;s+=parseFloat(c)||0;i+=parseFloat(o)||0;r+=parseFloat(o)||0;n+=parseFloat(o)||0});if(e==="table_dimicFecha"){this.byId("inputReInter").setValue(a.toFixed(2));this.byId("inputServi1").setValue(s.toFixed(2)+"€")}else if(e==="tableServicioInterno"){this.byId("inputOtrosServi1").setValue(i.toFixed(2)+"€")}else if(e==="tablGastoViajeInterno"){this.byId("inputGastoVia1").setValue(r.toFixed(2)+"€")}else if(e==="tablaLicencia"){this.byId("input0_1724758359").setValue(i.toFixed(2)+"€")}else if(e==="tablaRecExterno"){this.byId("inputRcurExtern").setValue(a.toFixed(2)+"€");this.byId("inputServi").setValue(s.toFixed(2)+"€")}else if(e==="idServiExterno"){this.byId("input10_1724757017406").setValue(a.toFixed(2)+"€")}else if(e==="idGastoRecuExter"){this.byId("input9_1724757015442").setValue(a.toFixed(2)+"€")}else if(e==="tablaConsuExter"){this.byId("inputServi2").setValue(s.toFixed(2));this.byId("inputConsuEx").setValue(a.toFixed(2))}else if(e==="idOtroserConsu"){this.byId("inputOtroSer2").setValue(i.toFixed(2)+"€")}else if(e==="idGastoViajeConsu"){this.byId("inptGastoVi2").setValue(i.toFixed(2)+"€")}else if(e==="tablaInfrestuctura"){this.byId("totalInfraestruc").setValue(a.toFixed(2)+"€")}this.onColumnTotales();return a},onColumnTotales:function(){var e=0;var t=0;var o=0;var a=0;var s=0;var i=parseFloat(this.byId("inputReInter").getValue())||0;var r=parseFloat(this.byId("inputConsuEx").getValue())||0;var n=parseFloat(this.byId("inputRcurExtern").getValue())||0;e=i+r+n;this.byId("inputTotalJor").setValue(e.toFixed(2));var c=parseFloat(this.byId("inputServi1").getValue())||0;var l=parseFloat(this.byId("inputOtrosServi1").getValue())||0;var d=parseFloat(this.byId("inputGastoVia1").getValue())||0;t=c+l+d;this.byId("totalRecuInter").setValue(t.toFixed(2));var u=parseFloat(this.byId("inputServi2").getValue())||0;var h=parseFloat(this.byId("inputOtroSer2").getValue())||0;var f=parseFloat(this.byId("inptGastoVi2").getValue())||0;o=u+h+f;this.byId("totalConsuExternot").setValue(o.toFixed(2));var p=parseFloat(this.byId("inputServi").getValue())||0;var g=parseFloat(this.byId("input10_1724757017406").getValue())||0;var x=parseFloat(this.byId("input9_1724757015442").getValue())||0;a=p+g+x;this.byId("totaRecurExterno").setValue(a.toFixed(2));var y=parseFloat(this.byId("totalInfraestruc").getValue())||0;var I=parseFloat(this.byId("input0_1724758359").getValue())||0;s=t+o+a+y+I;var v=new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s);this.byId("totalSubtotal").setValue(v);var m=parseFloat(this.byId("input2_172475612").getValue())||0;var b=s*(m/100);this.byId("input2_1724756105").setValue(b.toFixed(2));var T=parseFloat(this.byId("input2_17221205").getValue())/100||0;var C=s+b;var w=C/(1-T)-C;this.byId("input2_1756121205").setValue(w.toFixed(2));var _=C+w;var F=new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_);var S=F+" €";this.byId("input0_1725625161348").setValue(S);this.CaseAno();if(this._insercionesPorAnoYTabla){this.CaseAno()}var E=this.byId("inputCambioEu").getValue().trim();var V=this.byId("input0_1725625132423424361348");if(E!==""){var D=parseFloat(parseFloat(E).toFixed(4));var P=_*D;var F=new Intl.NumberFormat("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2}).format(P);V.setVisible(true);V.setValue(F+" $")}else{V.setVisible(false);V.setValue("")}},findTotalColumnIndex:function(e){var t=e.getColumns();var o=t.length-1;for(var a=0;a<t.length;a++){var s=t[a].getHeader();if(s&&(s.getText()==="Total €"||s.getText()==="")){return a}}return o+1},getMonthsDifference:function(e,t){var o=(t.getFullYear()-e.getFullYear())*12;o-=e.getMonth();o+=t.getMonth();return o<0?0:o},onNavToView1:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("appNoparame")},onSelectOpx:function(e){var t=this.byId("slct_inic").getSelectedItem();if(!t){console.warn("No se ha seleccionado ningún item en slct_inic");return}var o=t.getText();var a=this.getView().byId("table0");if(o==="Opex Servicios"||o==="Proyecto/Servicio de Inversión"){this.byId("input2_172475612").setValue("0.00");this.byId("text67_1728582763477").setText("Opex Servicios  - El Margen debe ser establecido al 0%")}else{this.byId("input2_172475612").setValue("0.00");this.byId("text67_1728582763477").setText("0.00")}if(o==="Proyecto/Servicio a Cliente Externo"){a.setVisible(true);this.byId("idCheckMensual").setVisible(true);this.byId("idComentarioTipo").setVisible(true);this.byId("TextoCon").setVisible(true);this.byId("input2_17221205").setValue("20.00");this.byId("text67_1728582763477").setText("Margen por defecto 20%, si es inferior al 14,29% la propuesta debe pasar por comité")}else if(o==="Proyecto/Servicio Interno PdV"){this.byId("idComenpVd").setEditable(true);this.byId("input2_17221205").setValue("10.00");this.byId("text67_1728582763477").setText("Margen por defecto 10%, si el Margen es inferior al 5% la propuesta debe pasar por comité")}else if(o==="Proyecto/Servicio de Inversión"){this.byId("input2_17221205").setValue("0.00");this.byId("text67_1728582763477").setText("Proyecto/Servicio de Inversión - El Margen debe ser establecido al 0%")}else if(o==="Opex Servicios"){this.byId("input2_17221205").setValue("0.00");this.byId("text67_1728582763477").setText("Opex Servicios - El Margen debe ser establecido al 0%")}else{a.setVisible(false);this.byId("idComenpVd").setEditable(false);this.byId("idComentarioTipo").setVisible(false);this.byId("TextoCon").setVisible(false);this.byId("idCheckMensual").setVisible(false);this.byId("input2_17221205").setValue("")}var s=this.byId("idNatu");var i=["Proyecto/Servicio Inversión"];var r=i.includes(o)?"CAPEX":"OPEX";s.getItems().forEach(function(e){if(e.getText().trim()===r){s.setSelectedKey(e.getKey())}})},onCheckBoxSelectMulti:function(e){var t=e.getSource();var o=t.getSelected();var a=this.byId("table_clienteFac");if(a){a.setVisible(o)}},onInputChange:function(){var e=this.getView();var t=this.byId("input0").getValue();var o=this.byId("input1").getValue();var a=this.byId("id_Cfactur").getValue();var s=this.byId("int_clienteFun").getValue();var i=this.byId("slct_area");var r="";var n="";if(i&&i.getSelectedItem()){r=i.getSelectedItem().getText();n=i.getSelectedItem().getKey()}var c=this.byId("slct_Jefe");var l="";if(c&&c.getSelectedItem()){l=c.getSelectedItem().getText()}var d=this.byId("slct_client");var u="";if(d&&d.getSelectedItem()){u=d.getSelectedItem().getText()}var h=this.byId("date_inico");var f=h?h.getDateValue():null;var p="";if(f){p=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd"}).format(f)}var g=this.byId("slct_inic");var x="";if(g&&g.getSelectedItem()){x=g.getSelectedItem().getText()}var y=this.byId("idNatu");var I="";if(y&&y.getSelectedItem()){I=y.getSelectedItem().getText()}var v=this.byId("date_fin");var m=v?v.getDateValue():null;var b="";if(m){b=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy-MM-dd"}).format(m)}this.byId("txt_codig").setText(t);this.byId("txt_nomPro").setText(o);this.byId("txt_area").setText(r);this.byId("txt_NomJefe").setText(l);this.byId("txt_funcio").setText(s);this.byId("txt_feIni").setText(p);this.byId("txt_feFin").setText(b);this.byId("txt_ini").setText(x);this.byId("text72_1731325324246").setText(x);this.byId("text73_1731325328049").setText(I);this.byId("txt_client").setText(s);this.byId("txt_cFactura").setText(a);this.byId("txt_Codi2").setText(t);this.byId("txt_Nombre2").setText(o);this.byId("txt_area2").setText(r);this.byId("txt_Fe_ini2").setText(p);this.byId("txt_Fe_fin2").setText(b);this.byId("textClitFu3").setText(s);this.byId("textCliFac3").setText(a);this.byId("textCodigo3").setText(t);this.byId("textNatural3").setText(I);this.byId("txtNombre3").setText(o);this.byId("txtAre3").setText(r);this.byId("txtFechInici3").setText(p);this.byId("txtFechFin3").setText(b)},onSelectCheckbox:function(e){try{var t=this.byId("table2");if(!t){console.error("Tabla no encontrada.");return}var o=t.getItems();var a=e.getSource().getSelected();if(a===undefined){console.error("Error al obtener el estado del checkbox.");return}var s=e.getSource().getParent().getParent().indexOfColumn(e.getSource().getParent());var i=s===0?"box_prove":"box_condi";var r=this.byId(i);if(!r){console.error("El otro checkbox no se encontró.");return}if(i==="box_prove"){this.byId("idTextComProve").setEditable(true)}else{this.byId("idTextComProve").setEditable(false)}r.setEnabled(!a);o.forEach(function(e){var t=e.getCells();t.forEach(function(e,t){if(e.setEditable){e.setEditable(t===s?a:!a)}})})}catch(e){console.error("Error en la función onSelectCheckbox:",e)}}})});
sap.ui.predefine("project1/model/EmptyProject", [],function(){"use strict";return{ID:"",codigoProyect:null,nameProyect:"",pluriAnual:false,funcionalString:"",clienteFacturacion:"",multijuridica:false,IPC_apli:null,costeEstructura:null,objetivoAlcance:"",AsuncionesyRestricciones:"",datosExtra:"",CambioEuRUSD:null,Estado:"",Email:"",Empleado:"",fechaCreacion:null,descripcion:"",mensual:false,comentarioTipoCompra:"",comentarioFacturacion:"",comentarioProveedor:"",comentarioPvD:"",Total:null,Fechainicio:null,FechaFin:null,FechaModificacion:null,clienteFuncional:{},TipoServicio:{},Vertical:{},Naturaleza:{},Seguimiento:{},EjecucionVia:{},AmReceptor:{},Iniciativa:{},Area:{},jefeProyectID:{},TipoCompra:{},MotivoCondi:{},RecursosInternos:[],otrosGastoRecu:[],otrosRecursos:[],ProveedoresC:[],planificacion:[],Facturacion:[],ClientFactura:[],ConsumoExternos:[],otrosServiciosConsu:[],GastoViajeConsumo:[],RecursosExternos:[],serviRecurExter:[],GastoViajeRecExter:[],otrosConceptos:[],LicenciasCon:[],WorkflowInstancias:[],PerfilTotal:[],RecurInterTotal:{},ConsuExterTotal:{},RecuExterTotal:{},InfraestrLicencia:[],ResumenCostesTotal:[]}});
sap.ui.predefine("project1/model/formatter", [],function(){"use strict";return{formatOfertaIcon:function(t){return t?"sap-icon://accept":"sap-icon://decline"},formatOfertaColor:function(t){return t?"green":"red"},testFormatter:function(t){console.log("Formatter testFormatter value:",t);return t?"Sí hay oferta":"No hay oferta"},statusText:function(t){return t?"true":"false"},statusState:function(t){return t?"Success":"Error"}}});
sap.ui.predefine("project1/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"project1/i18n/i18n.properties":'# This is the resource bundle for project1\r\n\r\n#Texts for manifest.json\r\n\r\n#XTIT: Application name\r\nappTitle=SolicitudCDO\r\n\r\n#YDES: Application description\r\nappDescription=An SAP Fiori application.\r\n#XTIT: Main view title\r\ntitle=SolicitudCDO\r\n\r\n#XFLD,54\r\nflpTitle=SolicitudCDO (CAP)\r\n',
	"project1/i18n/i18n_en.properties":'welcome=Welcome\r\ngreeting=Hello\r\nerror=An error occurred\r\n\r\n',
	"project1/i18n/i18n_es.properties":'# This is the resource bundle for project1\r\n\r\n#Texts for manifest.json\r\n\r\n#XTIT: Application name\r\nappTitle=SolicitudCDO\r\n\r\n#YDES: Application description\r\nappDescription=An SAP Fiori application.\r\n#XTIT: Main view title\r\ntitle=SolicitudCDO\r\n\r\n#XFLD,54\r\nflpTitle=SolicitudCDO (CAP)\r\n',
	"project1/manifest.json":'{"_version":"1.59.0","sap.app":{"id":"project1","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":["","en","es"]},"fallbackLocale":"es","supportedLocales":["","es"],"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.14.2","toolsId":"81f37a08-20c4-4e38-b86d-f29c6dc5756e"},"dataSources":{"mainService":{"uri":"odata/v4/datos-cdo/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"Solicitud CDO-display":{"semanticObject":"Solicitud CDO","action":"display","title":"{{flpTitle}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"preload":"async","flexEnabled":false,"dependencies":{"minUI5Version":"1.126.2","libs":{"sap.m":{},"sap.ui.core":{},"sap.f":{},"sap.suite.ui.generic.template":{},"sap.ui.comp":{},"sap.ui.generic.app":{},"sap.ui.table":{},"sap.ushell":{},"sap.suite.ui.commons":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"project1.i18n.i18n","supportedLocales":["","en","es"]}},"":{"dataSource":"mainService","preload":true,"settings":{"synchronizationMode":"None","operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","viewType":"XML","async":true,"viewPath":"project1.view","controlAggregation":"pages","controlId":"app","clearControlAggregation":false},"routes":[{"name":"app","pattern":"app/{newId}","target":"app"},{"name":"appNoparame","pattern":"app","target":"app"},{"name":"view","pattern":"view/{sProjectID}/{sourceModel}","target":"view"},{"name":"viewNoParam","pattern":"view/{mode}","target":"view"},{"name":"DialogNoparam","pattern":"Dialog","target":"Dialog"},{"name":"viewWithMode","pattern":"view/{sourceModel}/{mode}/{sProjectID}","target":"view"},{"pattern":"viewWithAprobacion/{sourceModel}/{mode}/{sProjectID};aprobacion={aprobacion}","name":"viewWithAprobacion","target":"view"}],"targets":{"app":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"app","viewName":"App"},"view":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"view","viewName":"View1","viewLevel":1},"Dialog":{"viewType":"XML","transition":"slide","clearControlAggregation":false,"viewId":"Dialog","viewName":"Dialog1","viewLevel":1}}},"rootView":{"viewName":"project1.view.App","type":"XML","async":true,"id":"App"}},"sap.cloud":{"public":true,"service":"datosCdo2"}}',
	"project1/view/App.view.xml":'<mvc:View\r\n    xmlns:layout="sap.ui.layout"\r\n    xmlns:html="http://www.w3.org/1999/xhtml"\r\n    xmlns:mvc="sap.ui.core.mvc"\r\n    xmlns:core="sap.ui.core"\r\n    xmlns:table="sap.ui.table"\r\n    xmlns:suite="sap.suite.ui.commons"\r\n    xmlns:m="sap.m"\r\n    controllerName="project1.controller.App"\r\n    displayBlock="true"\r\n    xmlns:controller="controller"\r\n><m:App id="app"><m:pages><Page\r\n                xmlns="sap.m"\r\n                id="pageId"\r\n                title="Page Title"\r\n                floatingFooter="true"\r\n                class="miClase"\r\n            ><customHeader><Bar\r\n                        xmlns="sap.m"\r\n                        class="sapContrastPlus miHeader2 "\r\n                        id="bar0"\r\n                        busyIndicatorSize="Large"\r\n                        design="Header"\r\n                    ><contentLeft><Image\r\n                                src="https://freelogopng.com/images/all_img/1682997299telefonica-icon-png.png"\r\n                                height="38px"\r\n                                id="image0"\r\n                            /><ToolbarSpacer /></contentLeft></Bar></customHeader><content><VBox id="vbox0"><items><ObjectHeader\r\n                                xmlns="sap.m"\r\n                                title="Fichas CDO"\r\n                                id="header0"\r\n                                responsive="true"\r\n                                fullScreenOptimized="true"\r\n                                intro="Solicitud de proyecto a presentar en el Comité de Oportunidades según procedimiento ST-DDGL004-GADE."\r\n                                titleActive="true"\r\n                                titlePress="handleTitlePress"\r\n                                numberState="Success"\r\n                                backgroundDesign="Translucent"\r\n                                class="sapUiResponsivePadding--header sapUiMediumMarginBottom "\r\n                            ><ObjectAttribute\r\n                                    id="attrEmpleado"\r\n                                    title="Empleado"\r\n                                    text=""\r\n                                    active="true"\r\n                                /><ObjectAttribute\r\n                                    id="attrSolicitudes"\r\n                                    title="📄 Solicitudes"\r\n                                    text="{modelTotal>/Count}"\r\n                                    active="true"\r\n                                /><ObjectAttribute\r\n                                    id="2"\r\n                                    title="Departamento"\r\n                                    text=""\r\n                                /><statuses><ObjectStatus\r\n                                        id="status0"\r\n                                        title="Aprobación"\r\n                                        text=""\r\n                                        state="Warning"\r\n                                    /></statuses><attributes><ObjectAttribute\r\n                                        text=""\r\n                                        id="attribute0"\r\n                                    /></attributes><headerContainer><IconTabBar\r\n                                        id="itb1"\r\n                                        selectedKey="key3"\r\n                                        upperCase="true"\r\n                                        class="sapUiResponsiveContentPadding"\r\n                                        backgroundDesign="Translucent"\r\n                                        select="onIconTabSelect"\r\n                                    ><items><IconTabFilter\r\n                                                id="ma3"\r\n                                                key="attachments"\r\n                                                icon="sap-icon://attachment"\r\n                                                tooltip="Solicitudes pendientes"\r\n                                                count="{modelPendientes>/Count}"\r\n                                            ><table:Table\r\n                                                    id="idPendientes"\r\n                                                    rows="{modelPendientes>/DatosProyect}"\r\n                                                    enableBusyIndicator="true"\r\n                                                    selectionMode="None"\r\n                                                    class="sapFDynamicPageAlignContent sapUiTableColHdrCell"\r\n                                                    width="auto"\r\n                                                ><table:extension><m:OverflowToolbar\r\n                                                            style="Clear"\r\n                                                        ><m:Title\r\n                                                                id="title"\r\n                                                                text="Pendientes a Aprobación"\r\n                                                                class="customTitle"\r\n                                                            /><m:ToolbarSpacer /></m:OverflowToolbar></table:extension><table:Column\r\n                                                        id="colNombreProyecto"\r\n                                                        sortProperty="nameProyect"\r\n                                                        filterProperty="nameProyect"\r\n                                                        width="auto"\r\n                                                        hAlign="Center"\r\n                                                    ><Label\r\n                                                            text="Nombre Proyecto"\r\n                                                            class="customTitle"\r\n                                                        /><table:template><Text\r\n                                                                text="{modelPendientes>nameProyect}"\r\n                                                                class="boldText"\r\n                                                                textAlign="Center"\r\n                                                            /></table:template></table:Column><table:Column\r\n                                                        id="colArea"\r\n                                                        sortProperty="NombreArea"\r\n                                                        filterProperty="NombreArea"\r\n                                                        width="auto"\r\n                                                        hAlign="Center"\r\n                                                    ><Label\r\n                                                            text="Área"\r\n                                                            class="customTitle"\r\n                                                        /><table:template><Text\r\n                                                                text="{modelPendientes>NombreArea}"\r\n                                                                class="boldText"\r\n                                                            /></table:template></table:Column><table:Column\r\n                                                        id="colJefeProyecto"\r\n                                                        sortProperty="NombreJefe"\r\n                                                        filterProperty="NombreJefe"\r\n                                                        width="auto"\r\n                                                        hAlign="Center"\r\n                                                    ><Label\r\n                                                            text="Jefe de Proyecto"\r\n                                                            class="customTitle"\r\n                                                        /><table:template><Text\r\n                                                                text="{modelPendientes>NombreJefe}"\r\n                                                                class="boldText"\r\n                                                                textAlign="Center"\r\n                                                            /></table:template></table:Column><table:Column\r\n    id="Oferta"\r\n    sortProperty="Oferta"\r\n    filterProperty="OfertaTexto"\r\n    hAlign="Center"\r\n     tooltip="Filtrar por \'Sí\' o \'No\'"\r\n    width="auto"\r\n><Label text="Oferta" class="customTitle"            \r\n/><table:template><HBox         justifyContent="Center"\r\n        alignItems="Center"\r\n        width="100%"><core:Icon\r\n                src="{modelPendientes>OfertaIcon}"\r\n                color="{modelPendientes>OfertaColor}"\r\n                size="1.5rem"\r\n            /><Text\r\n                text="{modelPendientes>OfertaTexto}"\r\n                visible="false"\r\n            /></HBox></table:template></table:Column><table:Column\r\n    id="idComentarioPendi"\r\n    sortProperty="UltimaEtapaComentario"\r\n    filterProperty="UltimaEtapaComentario"\r\n    width="auto"\r\n    hAlign="Center"><Label text="Comentario Etapa Actual" class="customTitle" /><table:template><Text text="{modelPendientes>UltimaEtapaComentario}"\r\n            maxLines="1"      \r\n                      wrapping="true"\r\n                      tooltip="Si quieres ver el comentario completo accede a ver historial del proceso"    textAlign="Center"/></table:template></table:Column><table:Column\r\n                                                        id="colEstado"\r\n                                                        sortProperty="Estado"\r\n                                                        filterProperty="Estado"\r\n                                                        hAlign="Center"\r\n                                                        width="auto"\r\n                                                    ><Label\r\n                                                            text="Estado"\r\n                                                            class="customTitle"\r\n                                                        /><table:template><ObjectStatus\r\n                                                                id="status02"\r\n                                                                text="{modelPendientes>Estado}"\r\n                                                                state="Warning"\r\n                                                            /></table:template></table:Column><table:Column\r\n                                                        id="colOferta"\r\n                                                        sortProperty="modalidad"\r\n                                                        filterProperty="modalidad"\r\n                                                        hAlign="Center"\r\n                                                        width="auto"\r\n                                                    ><Label\r\n                                                            text="Presentación"\r\n                                                            class="customTitle"\r\n                                                        /><table:template><m:ObjectStatus\r\n                                                                text="{modelPendientes>modalidad}"\r\n                                                                state="Success"\r\n                                                            /></table:template></table:Column><table:Column\r\n                                                        id="colFechaComite"\r\n                                                        sortProperty="fechaComiteForm"\r\n                                                        filterProperty="fechaComiteForm"\r\n                                                        hAlign="Center"\r\n                                                        width="auto"\r\n                                                    ><VBox class="sapUiSmallMargin"><HBox justifyContent="Center" alignItems="Center" ><core:Icon src="sap-icon://calendar" size="1rem" class="sapUiTinyMargin"      color="#0070f2"  /><Label text=" Comité" class="customTitle" /></HBox></VBox><table:template><m:ObjectStatus\r\n                                                                text="{modelPendientes>fechaComiteForm}"\r\n                                                                state="Information"\r\n                                                                \r\n\r\n                                                            /></table:template></table:Column><table:Column\r\n                                                        id="colBotones"\r\n                                                        width="auto"\r\n                                                        hAlign="Center"\r\n                                                    ><Label\r\n                                                            text="Acciones"\r\n                                                            class="customTitle"\r\n                                                            textAlign="Center"\r\n                                                        /><table:template><HBox\r\n                                                                justifyContent="Center"\r\n                                                                alignItems="Center"\r\n                                                                renderType="Bare"\r\n                                                            ><Button\r\n                                                                    icon="sap-icon://message-information"\r\n                                                                    type="Transparent"\r\n                                                                    tooltip="Información del Proyecto"\r\n                                                                    press="DialogInfo"\r\n                                                                ><customData><core:CustomData\r\n                                                                            key="projectId"\r\n                                                                            value="{modelPendientes>ID}"\r\n                                                                        /></customData></Button><Button\r\n                                                                    icon="sap-icon://edit"\r\n                                                                    type="Transparent"\r\n                                                                    tooltip="Editar Proyecto"\r\n                                                                    press="onEditPress"\r\n                                                                ><customData><core:CustomData\r\n                                                                            key="projectId"\r\n                                                                            value="{modelPendientes>ID}"\r\n                                                                        /></customData></Button><Button\r\n                                                                    icon="sap-icon://delete"\r\n                                                                    type="Reject"\r\n                                                                    tooltip="Eliminar Proyecto"\r\n                                                                    press="onDeletePress"\r\n                                                                ><customData><core:CustomData\r\n                                                                            key="projectId"\r\n                                                                            value="{modelPendientes>ID}"\r\n                                                                        /><core:CustomData\r\n                                                                            key="etapaId"\r\n                                                                            value="{modelPendientes>workflowId}"\r\n                                                                        /></customData></Button><Button\r\n                                                                    icon="sap-icon://activity-2"\r\n                                                                    type="Transparent"\r\n                                                                    tooltip="Ver Historial de Solicitud"\r\n                                                                    press="onVerHistorial"\r\n                                                                ><customData><core:CustomData\r\n                                                                            key="nameProyect"\r\n                                                                            value="{modelPendientes>nameProyect}"\r\n                                                                        /><core:CustomData\r\n                                                                            key="projectId"\r\n                                                                            value="{modelPendientes>ID}"\r\n                                                                        /></customData></Button></HBox></table:template></table:Column></table:Table></IconTabFilter><IconTabFilter\r\n                                                id="ma55"\r\n                                                key="notes"\r\n                                                icon="sap-icon://multi-select"\r\n                                                tooltip="Solicitudes Aprobadas"\r\n                                                count="{modelAprobados>/Count}"\r\n                                            ><table:Table\r\n                                                    id="idTableAprobados"\r\n                                                    rows="{modelAprobados>/DatosProyect}"\r\n                                                    enableBusyIndicator="true"\r\n                                                    selectionMode="None"\r\n                                                    visibleRowCount="10"\r\n                                                    width="auto"\r\n                                                    ariaLabelledBy="title"\r\n                                                    class="sapFDynamicPageAlignContent sapUiTableColHdrCell"\r\n                                                ><table:extension><m:OverflowToolbar\r\n                                                            style="Clear"\r\n                                                        ><m:Title\r\n                                                                id="titleAprobado"\r\n                                                                text="Solicitudes Procesadas"\r\n                                                                class="customTitle"\r\n                                                            /><m:ToolbarSpacer /></m:OverflowToolbar></table:extension><table:columns><table:Column\r\n                                                            id="colCodigoProyecto"\r\n                                                            sortProperty="codigoProyect"\r\n                                                            filterProperty="codigoProyect"\r\n                                                            width="auto"\r\n\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Código Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelAprobados>codigoProyect}"\r\n                                                                    textAlign="Center"\r\n                                                                    class="boldText"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colNombreProyecto1"\r\n                                                            sortProperty="nameProyect"\r\n                                                            filterProperty="nameProyect"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Nombre Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelAprobados>nameProyect}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colArea1"\r\n                                                            sortProperty="Area/NombreArea"\r\n                                                            filterProperty="Area/NombreArea"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Área"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelAprobados>Area/NombreArea}"\r\n                                                                    class="boldText"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colJefeProyecto1"\r\n                                                            sortProperty="jefeProyectID/name"\r\n                                                            filterProperty="jefeProyectID/name"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Jefe de Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelAprobados>jefeProyectID/name}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colFechaAprobacion"\r\n                                                            sortProperty="actualizadoEnFormateada"\r\n                                                            filterProperty="actualizadoEnFormateada"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Fecha de Aprobación"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelAprobados>actualizadoEnFormateada}"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colEstado1"\r\n                                                            sortProperty="Estado"\r\n                                                            filterProperty="Estado"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Estado"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelAprobados>Estado}"\r\n                                                                        state="{modelAprobados>EstadoStatus}"\r\n\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colAcciones"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Acciones"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><HBox\r\n                                                                    justifyContent="Center"\r\n                                                                    alignItems="Center"\r\n                                                                    renderType="Bare"\r\n                                                                ><Button\r\n                                                                        icon="sap-icon://message-information"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Información del Proyecto"\r\n                                                                        press="DialogInfo"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                key="projectId"\r\n                                                                                value="{modelAprobados>ID}"\r\n                                                                            /></customData></Button><Button\r\n                                                                        id="butn346"\r\n                                                                        icon="sap-icon://show"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Ver Proyecto"\r\n                                                                        press="onEditPress"\r\n                                                                        enabled="true"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                id="idButonEdit"\r\n                                                                                key="nameProyect"\r\n                                                                                value="{nameProyect}"\r\n                                                                            /><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{ID}"\r\n                                                                            /></customData></Button><Button\r\n                                                                        xmlns="sap.m"\r\n                                                                        icon="sap-icon://activity-2"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Ver Historial de Solicitud"\r\n                                                                        id="button20"\r\n                                                                        press="onVerHistorial"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                id="mivop3"\r\n                                                                                key="nameProyect"\r\n                                                                                value="{modelAprobados>nameProyect}"\r\n                                                                            /><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelAprobados>ID}"\r\n                                                                            /></customData></Button></HBox></table:template></table:Column></table:columns></table:Table></IconTabFilter><IconTabFilter\r\n                                                id="idIconBorrador"\r\n                                                key="info"\r\n                                                icon="sap-icon://request"\r\n                                                tooltip="Mis borradores"\r\n                                                count="{modelBorrador>/Count}"\r\n                                            ><table:Table\r\n                                                    id="TableBorrador"\r\n                                                    rows="{modelBorrador>/DatosProyect}"\r\n                                                    selectionMode="None"\r\n                                                    enableBusyIndicator="true"\r\n                                                    visibleRowCount="10"\r\n                                                    width="auto"\r\n                                                    class="sapFDynamicPageAlignContent customHeaderColor2 sapUiTableColHdrCell"\r\n                                                ><table:extension><m:OverflowToolbar\r\n                                                            style="Clear"\r\n                                                        ><m:Title\r\n                                                                id="titleBorradores"\r\n                                                                text="Mis Borradores"\r\n                                                                class="customTitle"\r\n                                                            /><m:ToolbarSpacer /></m:OverflowToolbar></table:extension><table:columns><table:Column\r\n                                                            id="newId_colFecha"\r\n                                                            sortProperty="FechaCreacionFormateada"\r\n                                                            filterProperty="FechaCreacionFormateada"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblFecha"\r\n                                                                text="Fecha Creación"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelBorrador>FechaCreacionFormateada}"\r\n                                                                    class="boldText"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="newId_colNombreProyecto"\r\n                                                            sortProperty="nameProyect"\r\n                                                            filterProperty="nameProyect"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblNombreProyecto"\r\n                                                                text="Nombre Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelBorrador>nameProyect}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="newId_colDescripcion"\r\n                                                            sortProperty="descripcion"\r\n                                                            filterProperty="descripcion"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblDescripcion"\r\n                                                                text="Descripción"\r\n                                                                class="customTitle"\r\n                                                            /></table:Column><table:Column\r\n                                                            id="newId_colArea"\r\n                                                            sortProperty="NombreArea"\r\n                                                            filterProperty="NombreArea"\r\n                                                           width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblArea"\r\n                                                                text="Área"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelBorrador>NombreArea}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="newId_colJefeProyecto"\r\n                                                            sortProperty="NombreJefe"\r\n                                                            filterProperty="NombreJefe"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblJefeProyecto"\r\n                                                                text="Jefe de Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelBorrador>NombreJefe}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="newId_colEstado"\r\n                                                            sortProperty="Estado"\r\n                                                            filterProperty="Estado"\r\n                                                              width="auto"\r\n\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblEstado"\r\n                                                                text="Estado"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelBorrador>Estado}"\r\n                                                                    state="Warning"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="newId_colAcciones"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                id="newId_lblAcciones"\r\n                                                                text="Acciones"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><HBox\r\n                                                                    justifyContent="Center"\r\n                                                                    alignItems="Center"\r\n                                                                    renderType="Bare"\r\n                                                                ><Button\r\n                                                                        id="newId_btnInfo"\r\n                                                                        press="DialogInfo"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Información del Proyecto"\r\n                                                                        icon="sap-icon://message-information"\r\n                                                                        ariaHasPopup="Dialog"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelBorrador>ID}"\r\n                                                                            /></customData></Button><Button\r\n                                                                        id="newId_btnEditar"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Editar Proyecto"\r\n                                                                        icon="sap-icon://edit"\r\n                                                                        press="onEditPress"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                id="newId_customName"\r\n                                                                                key="nameProyect"\r\n                                                                                value="{modelBorrador>nameProyect}"\r\n                                                                            /><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelBorrador>ID}"\r\n                                                                            /></customData></Button><Button\r\n                                                                        id="newId_btnEliminar"\r\n                                                                        icon="sap-icon://delete"\r\n                                                                        type="Reject"\r\n                                                                        tooltip="Eliminar Proyecto"\r\n                                                                        press="onDeletePress"\r\n                                                                        enabled="true"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelBorrador>ID}"\r\n                                                                            /></customData></Button></HBox></table:template></table:Column></table:columns></table:Table></IconTabFilter><IconTabFilter\r\n                                                id="ma77"\r\n                                                key="people"\r\n                                                tooltip="Seguimiento de Proceso"\r\n                                                icon="sap-icon://process"\r\n                                                visible="false"\r\n                                            ><Panel\r\n                                                    xmlns="sap.m"\r\n                                                    width="auto"\r\n                                                    expandable="true"\r\n                                                    expanded="true"\r\n                                                    id="panel5887540"\r\n                                                ><headerToolbar><Toolbar\r\n                                                            id="toolbar1_1728554177158"\r\n                                                        ><Title\r\n                                                                id="idTitleProceso"\r\n                                                                text="Proceso"\r\n                                                            /><ToolbarSpacer /><Button\r\n                                                                id="kfsldkfjwo"\r\n                                                                icon="sap-icon://settings"\r\n                                                            /></Toolbar></headerToolbar><content><ObjectAttribute\r\n                                                            id="3434"\r\n                                                            title="Flujo de Aprobación"\r\n                                                            text="Fichas CDO"\r\n                                                            active="true"\r\n                                                            press="pressFichas"\r\n                                                        /><ToolbarSpacer /><Text\r\n                                                            text="Proceso de Solictud"\r\n                                                            id="text1881"\r\n                                                            class="color"\r\n                                                        /><suite:ProcessFlow\r\n                                                            id="processflow1"\r\n                                                            nodePress="onNodePress"\r\n                                                        ><suite:lanes><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane0"\r\n                                                                    laneId="0"\r\n                                                                    iconSrc="sap-icon://crm-service-manager"\r\n                                                                    text="Solicitud CDO"\r\n                                                                    position="0"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane1"\r\n                                                                    laneId="1"\r\n                                                                    iconSrc="sap-icon://approvals"\r\n                                                                    text="Notificación de Aprobación"\r\n                                                                    position="1"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane2"\r\n                                                                    laneId="2"\r\n                                                                    iconSrc="sap-icon://notes"\r\n                                                                    text="Aprobación Técnica (Basis/TQ/Factoría)"\r\n                                                                    position="2"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane3"\r\n                                                                    laneId="3"\r\n                                                                    iconSrc="sap-icon://activity-individual"\r\n                                                                    text="Notificación a PMO"\r\n                                                                    position="3"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane4"\r\n                                                                    laneId="4"\r\n                                                                    iconSrc="sap-icon://factory"\r\n                                                                    text="Aprobación PMO"\r\n                                                                    position="4"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane5"\r\n                                                                    laneId="5"\r\n                                                                    iconSrc="sap-icon://calendar"\r\n                                                                    text="Notificación Control de Gestión"\r\n                                                                    position="5"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane6"\r\n                                                                    laneId="6"\r\n                                                                    iconSrc="sap-icon://accept"\r\n                                                                    text="Aprobación Control de Gestión"\r\n                                                                    position="6"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane8"\r\n                                                                    laneId="8"\r\n                                                                    iconSrc="sap-icon://message-error"\r\n                                                                    text="Notificación Dirección"\r\n                                                                    position="7"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane9"\r\n                                                                    laneId="9"\r\n                                                                    iconSrc="sap-icon://payment-approval"\r\n                                                                    text="Aprobación Dirección"\r\n                                                                    position="8"\r\n                                                                /><suite:ProcessFlowLaneHeader\r\n                                                                    id="lane99"\r\n                                                                    laneId="99"\r\n                                                                    iconSrc="sap-icon://decline"\r\n                                                                    text="Finalizado / Rechazado"\r\n                                                                    position="9"\r\n                                                                /></suite:lanes></suite:ProcessFlow></content></Panel></IconTabFilter><IconTabFilter\r\n                                                id="id34"\r\n                                                key="people"\r\n                                                tooltip="Lista pendientes a Aprobar"\r\n                                                icon="sap-icon://pending"\r\n                                                visible="false"\r\n                                                count="{modelEtapasAsignadas>/Count}"\r\n                                                \r\n                                            ><table:Table\r\n                                                    rows="{modelEtapasAsignadas>/Etapas}"\r\n                                                    id="tabla_Aprobadores"\r\n                                                    selectionMode="None"\r\n                                                    class="customHeaderColor2 sapFDynamicPageAlignContent"\r\n                                                ><table:extension><m:OverflowToolbar\r\n                                                            style="Clear"\r\n                                                        ><m:Title\r\n                                                                id="titleAprobadore"\r\n                                                                text="Tus pendientes a Aprobar"\r\n                                                                class="customTitle"\r\n                                                            /><m:ToolbarSpacer /></m:OverflowToolbar></table:extension><table:columns><table:Column\r\n                                                            id="colEtapa"\r\n                                                            sortProperty="nombreEtapa"\r\n                                                            filterProperty="nombreEtapa"\r\n                                                             width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Etapa"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelEtapasAsignadas>nombreEtapa}"\r\n                                                                    state="Information"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colProyecto"\r\n                                                            sortProperty="nameProyect"\r\n                                                            filterProperty="nameProyect"\r\n                                                             width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Proyecto"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelEtapasAsignadas>nameProyect}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colDescripcion2"\r\n                                                            sortProperty="descripcion"\r\n                                                            filterProperty="descripcion"\r\n                                                          width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Descripción"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><Text\r\n                                                                    text="{modelEtapasAsignadas>descripcion}"\r\n                                                                    class="boldText"\r\n                                                                    textAlign="Center"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colAsignadoA"\r\n                                                            sortProperty="asignadoA"\r\n                                                            filterProperty="asignadoA"\r\n                                                             width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Asignado A"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><ObjectStatus\r\n                                                                    text="{modelEtapasAsignadas>asignadoA}"\r\n                                                                    state="Information"\r\n                                                                /></table:template></table:Column><table:Column\r\n                                                            id="colAcciones2"\r\n                                                            width="auto"\r\n                                                            hAlign="Center"\r\n                                                        ><Label\r\n                                                                text="Acciones"\r\n                                                                class="customTitle"\r\n                                                            /><table:template><HBox\r\n                                                                    justifyContent="Center"\r\n                                                                    alignItems="Center"\r\n                                                                    renderType="Bare"\r\n                                                                ><Button\r\n                                                                        press="DialogInfo"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Información del Proyecto"\r\n                                                                        icon="sap-icon://message-information"\r\n                                                                        ariaHasPopup="Dialog"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelEtapasAsignadas>projectId}"\r\n                                                                            /></customData></Button><Button\r\n                                                                        id="butn3462"\r\n                                                                        icon="sap-icon://show"\r\n                                                                        press="onEditPress"\r\n                                                                        type="Transparent"\r\n                                                                        tooltip="Ver Proyecto"\r\n                                                                        enabled="true"\r\n                                                                    ><customData\r\n                                                                        ><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                id="idButonEdit2"\r\n                                                                                key="nameProyect"\r\n                                                                                value="{modelEtapasAsignadas> nameProyect}"\r\n                                                                            /><core:CustomData\r\n                                                                                xmlns:core="sap.ui.core"\r\n                                                                                key="projectId"\r\n                                                                                value="{modelEtapasAsignadas>projectId}"\r\n                                                                            /></customData></Button></HBox></table:template></table:Column></table:columns></table:Table></IconTabFilter></items><content /></IconTabBar></headerContainer></ObjectHeader></items></VBox></content><footer><OverflowToolbar id="toolbar1"><ToolbarSpacer id="22" /><Button\r\n                            id="33"\r\n                            type="Accept"\r\n                            enabled="true"\r\n                            icon="sap-icon://add"\r\n                            text="Nueva Solicitud"\r\n                            tooltip="Crear una nueva solicitud"\r\n                            press="onNavToView1"\r\n                        /></OverflowToolbar></footer></Page></m:pages></m:App></mvc:View>\r\n',
	"project1/view/ComiteDialog.fragment.xml":'<core:FragmentDefinition\r\n  xmlns="sap.m"\r\n  xmlns:core="sap.ui.core"><Dialog\r\n    id="dialogModalidad"\r\n    title="Presentar Solicitud"\r\n    contentWidth="400px"\r\n    type="Message"  ><VBox><Label text="¿Cómo deseas presentar la solicitud?" /><RadioButtonGroup id="radioGroupModalidad" columns="2" select="onSelectModalidad"><buttons><RadioButton text="Offline" selected="true" /><RadioButton text="En Comité" /></buttons></RadioButtonGroup><DatePicker id="datePickerComite" placeholder="Selecciona un jueves" visible="false" change="onComiteDateChange" /><Text id="infoText" text="⚠️ Las solicitudes solo pueden presentarse en Comité los días jueves." visible="false" wrapping="true"/></VBox><beginButton><Button text="Confirmar" press="onConfirmModalidad" type="Emphasized"/></beginButton><endButton><Button text="Cancelar" press="onCancelarComiteDialog"/></endButton></Dialog></core:FragmentDefinition>\r\n',
	"project1/view/Dialog.fragment.xml":'<core:FragmentDefinition\r\n    xmlns="sap.m"\r\n    xmlns:f="sap.ui.layout.form"\r\n    xmlns:mvc="sap.ui.core.mvc"\r\n    xmlns:core="sap.ui.core"\r\n    \r\n><Dialog\r\n        title="Ficha CDO"\r\n        afterClose="onDialogClose"\r\n        class="color"\r\n    ><content><VBox><f:SimpleForm\r\n                    id="SimpleFormChangeColumn_twoGroups234"\r\n                    editable="true"\r\n                    layout="ColumnLayout"\r\n                    title="Solicitud Informacion"\r\n                    columnsM="2"\r\n                    columnsL="2"\r\n                    columnsXL="2"\r\n                ><f:content><core:Title text="Information General" /><Label text="Creado por" /><Text\r\n                            text=""\r\n                            id="idCreador"\r\n                        /><Label text="Fecha Creacion del Proyecto" /><Text\r\n                            id="idCreacion"\r\n                            text=""\r\n                        /><Label text="Email" /><Text\r\n                            text=""\r\n                            id="idEMail" class="onEmailPress2"\r\n                        /><Label text="PEP" /><Text text="PK-23344-AA"><layoutData><f:ColumnElementData\r\n                                    cellsSmall="2"\r\n                                    cellsLarge="2"\r\n                                /></layoutData></Text><Label text="Nombre Proyecto: " /><Text\r\n                            text=""\r\n                            id="idNombreProyecto"\r\n                        /><Label text="Descripción" /><Text\r\n                            text="Proyecto prueba"\r\n                            id="idDescripcion1"\r\n                        /><Label text="Fecha Inicio" /><Label text="Fecha Inicio del Proyecto " /><Text\r\n                            text=""\r\n                            id="fechainitProyect"\r\n                        ><layoutData><f:ColumnElementData\r\n                                    cellsSmall="2"\r\n                                    cellsLarge="2"\r\n                                /></layoutData></Text><Label text="Fecha Fin del Proyecto " /><Text\r\n                            text=""\r\n                            id="idFechaFinProyect"\r\n                        ><layoutData><f:ColumnElementData\r\n                                    cellsSmall="2"\r\n                                    cellsLarge="2"\r\n                                /></layoutData></Text><Label text="Area" /><Text\r\n                            text=""\r\n                            id="idArea"\r\n                        /><Label text="Jefe Proyecto " /><Text\r\n                            text=""\r\n                            id="idJefeProyect"\r\n                        ><layoutData><f:ColumnElementData\r\n                                    cellsSmall="2"\r\n                                    cellsLarge="2"\r\n                                /></layoutData></Text><Label text="Total Resumen vs Costes" /><Text\r\n                            text=""\r\n                            id="idtotal"\r\n                        /><Label text="Estado" /><ObjectStatus id="idEstadoProyect" text="" state="None" /><Label text="Fecha Modificacion" /><Text\r\n                            text=""\r\n                            id="idModifi"\r\n                        /></f:content></f:SimpleForm></VBox></content><footer><Toolbar><content><ToolbarSpacer /><Button\r\n                        type="Accept"\r\n                        text="Aceptar"\r\n                        press="._closeDialog"\r\n                    /></content></Toolbar></footer></Dialog></core:FragmentDefinition>\r\n',
	"project1/view/View1.view.xml":'<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:dnd="sap.ui.core.dnd" xmlns:microchart="sap.suite.ui.microchart" xmlns:table="sap.ui.table" xmlns:core="sap.ui.core" xmlns:chart="sap.chart" xmlns:l="sap.ui.layout" xmlns:smartChart="sap.ui.comp.smartchart" xmlns:viz="sap.viz.ui5.controls" xmlns:viz.data="sap.viz.ui5.data" xmlns:gantt="sap.gantt.simple" xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds" xmlns:smartFilter="sap.ui.comp.smartfilterbar" xmlns:layout="sap.ui.layout" xmlns:u="sap.ui.unified" controllerName="project1.controller.View1" displayBlock="true"><App id="app2"><Page id="page" title="{i18n>title}"><customHeader><Bar xmlns="sap.m" class="sapContrastPlus myCustomBar" id="bar120" busyIndicatorSize="Large" design="Header"><contentLeft><Button icon="sap-icon://arrow-left" tooltip="" id="button3" press="onNavToView1"/><Image src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/79/Telef%C3%B3nica_2021_logo.svg/1200px-Telef%C3%B3nica_2021_logo.svg.png" width="120px" id="image034"/></contentLeft></Bar></customHeader><content><VBox id="vbox1230"><items><ObjectHeader id="oh1" responsive="true" fullScreenOptimized="true" intro="Comite de oportunidades" title="Ficha Solicitud Aprobación Proyecto - Comité de Oportunidades" numberUnit="" numberState="Success" backgroundDesign="Translucent" class="sapUiResponsivePadding--header  miHeader"><ObjectAttribute id="23d3" title="Empleado" text="" active="true"/><ObjectAttribute id="dddtg" title="Email" text="" tooltip="" active="true" press=".onEmailPress"/><ObjectAttribute id="unam" title="Area" text=""/><statuses><ObjectStatus id="23437" title="Aprobación" text="Pending" state="Warning"/></statuses><headerContainer><IconTabBar id="itb1333" selectedKey="key2" upperCase="true" select="onTabSelect"><items><IconTabFilter id="idIniu" text="Activities" count="" key="key2" class=".miClase"><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel1"><headerToolbar><Toolbar id="toolbar3341"><Title text="Solicitud de proyecto" id="titulo1" class="miTitulo color"/><ToolbarSpacer id="333d"/><Button icon="sap-icon://hint" type="Transparent" press="onInfoGeneralPress" tooltip="Ver ayuda de los campos"/></Toolbar></headerToolbar><content><FlexBox width="100%" id="flx_1" justifyContent="Center"><items><VBox class="sapUiSmallMarginBottom"><items><HBox justifyContent="End"><items><CheckBox id="ofertaCheckBox" text="Marcar si esta solicitud es una Oferta" selected="false" select=".onOfertaSelect"/></items></HBox><Table ariaLabelledBy="__label0 __label2" noDataText="Drop column list items here and columns in the area above" id="table1" class="onAfterShow  customHeaderColor2" width="auto" headerText="Datos Proyecto"><items><ColumnListItem type="Active" id="item1"><cells><Input xmlns="sap.m" id="input0" type="Number" value="" placeholder="5524455" liveChange="onInputChange" editable="false" tooltip="Codigo Proyecto asignado por la PMO" showSuggestion="true"/><Input xmlns="sap.m" id="input1" value="" placeholder="Proyect...." liveChange="onInputChange" showSuggestion="true"/><Input xmlns="sap.m" value="" id="idDescripcion"/><Select xmlns="sap.m" id="slct_area" change="onInputChange" selectedKey="{Area>valueArea}" items="{/Area}" width="100%" forceSelection="false" tooltip="Area Funcional de la DAGC que pertenece a la solicitud"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreArea}" id="item155"/></items></Select><Select xmlns="sap.m" id="slct_Jefe" selectedKey="{Jefeproyect>valueJefe}" items="{/Jefeproyect}" width="100%" tooltip="Nombre del Jefe de Proyecto preasignado: si el jefe de proyecto no está disponible en el despegable escribir" change="onInputChange" forceSelection="false"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{name}" id="item155p"/></items></Select><Select xmlns="sap.m" id="slct_verti" selectedKey="{Vertical>valueVertical}" forceSelection="false" width="100%" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item156"/></items></Select><Select xmlns="sap.m" id="slct_client" selectedKey="{ClienteNuevo>valueClienteNuevo}" forceSelection="false" width="100%" items="{/ClienteNuevo}" change="onInputChange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreClienteNuevo}" id="item158"/></items></Select></cells></ColumnListItem></items><columns><Column id="column3" hAlign="Center"><header><Label text="Codigo" id="label3"/></header></Column><Column id="column4" hAlign="Center"><header><Label text="Nombre Proyecto" id="label4"/></header></Column><Column id="column0_1742402609837" hAlign="Center"><header><Label text="Descripcion" id="text63" textAlign="Center"/></header></Column><Column id="column5" hAlign="Center" width="270px"><header><Label text="Area" id="label5"/></header></Column><Column id="column0" hAlign="Center" width="260px"><header><Label text="Jefe  Proyecto" id="label0"/></header></Column><Column id="column1" hAlign="Center"><header><Label text="Vertical" id="label1"/></header></Column><Column id="column2" hAlign="Center"><header><Label text="Cliente Nuevo" id="label2"/></header></Column></columns></Table></items></VBox></items></FlexBox><FlexBox width="100%" id="box1" justifyContent="Center"><items><Table ariaLabelledBy="__xmlview0--label4 __label10" noDataText="Drop column list items here and columns in the area above" id="table4" class="sapUiTinyMargin customHeaderColor2" width="auto"><items><ColumnListItem type="Active" id="item8"><cells><Select xmlns="sap.m" id="slct_inic" change="onSelectIniMethod" selectedKey="{TipoIniciativa>valueinicia}" width="100%" forceSelection="false" items="{/TipoIniciativa}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreIniciativa}" id="item159"/></items></Select><Input xmlns="sap.m" id="int_clienteFun" liveChange="onInputChange" tooltip="En caso de que exista más de una juridica marca el checkbox de \'Multijurida\' y completar la informacion en la tabla Cliente Facturación / Juridicas. En caso contrario indicar la juridica en Cliente Facturación  "/><Input xmlns="sap.m" id="id_Cfactur" placeholder="Facturacion..." liveChange="onInputChange"/><Select xmlns="sap.m" id="idNatu" selectedKey="{Naturaleza>valueNaturaleza}" forceSelection="false" items="{/Naturaleza}" change="onInputChange" tooltip="OPEX o CAPEX"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreNaturaleza}" id="item160"/></items></Select><Select xmlns="sap.m" id="selc_Segui" selectedKey="{Seguimiento>valueSeguimiento}" forceSelection="false" items="{/Seguimiento}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreSeguimiento}" id="item161"/></items></Select><Select xmlns="sap.m" id="selc_ejcu" selectedKey="{EjecucionVia>valueEjecuVia}" forceSelection="false" items="{/EjecucionVia}" tooltip="Aplica a iniciativas GlobalSAP"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreEjecuVia}" id="item162"/></items></Select><Select xmlns="sap.m" id="selct_Amrecp" selectedKey="{AMreceptor>valueAMreceptor}" forceSelection="false" items="{/AMreceptor}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreAMreceptor}" id="item163"/></items></Select></cells></ColumnListItem></items><columns><Column id="column12" hAlign="Center" width="290px"><header><Label text="Tipo Iniciativa" id="label12"/></header></Column><Column id="column0_1724664686677"><header><Label text="Cliente Funcional" id="text66_1724664686677"/></header></Column><Column id="column13" hAlign="Center"><header><Label text="Cliente Facturación" id="label13"/></header></Column><Column id="column14" hAlign="Center"><header><Label text="Naturaleza" id="label14"/></header></Column><Column id="column9" hAlign="Center"><header><Label id="label9" text="Seguimiento"/></header></Column><Column id="column10" hAlign="Center"><header><Label id="label10" text="Ejecucion Via Nuevo Modelo"/></header></Column><Column id="column11" hAlign="Center"><header><Label text="AM receptor" id="label11"/></header></Column></columns></Table></items></FlexBox><FlexBox width="100%" id="box0" justifyContent="Center"><items><Table ariaLabelledBy="__label1" noDataText="Drop column list items here and columns in the area above" id="table1_1714405548914" class="sapUiTinyMargin  customHeaderColor2" width="auto"><items><ColumnListItem type="Active" id="item1_1714405548913"><cells><CheckBox xmlns="sap.m" text=" " selected="false" select=".onCheckBoxSelectMulti" id="box_multiJuridica"/><CheckBox xmlns="sap.m" text="" selected="false" id="box_pluriAnual"/><Input xmlns="sap.m" value="2,5%" id="input_ipc" placeholder="2,5%" textAlign="End" width="6rem" tooltip="En los proyecto PluriAnuales se considera un incremento del IPC del 2,5% para Recursos Internos a partir del segundo año, para Recursos Externos el responsable de la cotizacion tiene que considerar si es necesario incrementar la tarifa en cada uno de los años sucesivos"/><Input xmlns="sap.m" value="" id="inputCambioEu" placeholder="$" textAlign="End" change="onTipoCambioLive" tooltip="En caso de querer obtener el total de la tabla oferta en $ indicar el tipo de cambio aplicado. Consultar a Control el tipo de cambio vigente en el momento de la realización de la ficha "/><DatePicker xmlns="sap.m" id="date_inico" change="onselectmethodsetinfo" displayFormat="dd-MM-yyyy" valueFormat="dd-MM-yyyy" tooltip="Inserta la Fecha inicio del proyecto"/><DatePicker xmlns="sap.m" id="date_fin" change="onselectmethodsetinfo" displayFormat="dd-MM-yyyy" valueFormat="dd-MM-yyyy" tooltip="Inserta la Fecha fin del proyecto"/></cells></ColumnListItem></items><columns><Column id="column3_1714405548913" hAlign="Center"><header><Label text="Multi Jurídica" id="label3_1714405548913"/></header></Column><Column id="column4_1714405548913" hAlign="Center"><header><Label text="PluriAnual" id="label4_1714405548913"/></header></Column><Column id="column5_1714405548914" hAlign="Center"><header><Label text="IPC Aplicable " id="label5_1714405548914"/></header></Column><Column id="column5_17144055489768686676814" hAlign="Center"><header><Label text="Cambio EUR - USD " id="label5_171687678678674405548914"/></header></Column><Column id="column0_1714405544374" hAlign="Center"><header><Label text="Fecha inicio" id="label0_1714405544374"/></header></Column><Column id="column1_1714405544375" hAlign="Center"><header><Label text="Fecha fin " id="label1_1714405544374"/></header></Column></columns></Table></items></FlexBox></content></Panel><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel2" class="sapUiTinyMarginTop"><headerToolbar><Toolbar id="toolbar2"><Title text="Planificación " id="titulo_2" class="customHeaderTitle color"/><ToolbarSpacer id="f"/><Button icon="sap-icon://settings" id="btn2"/></Toolbar></headerToolbar><content><Text text="Fechas Planificación" id="text10_1714468462964" class="sapUiSmallMarginBottom myText2"/><FlexBox width="100%" id="box0_1714468536656"><items><Table ariaLabelledBy="__label7" id="table3_1714468867118" class="table1  customHeaderColor" items="{planning>/milestones}" width="500px"><headerToolbar><Toolbar id="dhyff"><Title id="2ff" text="Planificación Preliminar del Proyecto" level="H2" class="myText2"/></Toolbar></headerToolbar><columns><Column id="column9_1714468867115" hAlign="Center"><header><Label text="Hito/Fase" id="label9_1714468867114" tooltip="Indicar las fechas de las fases que apliquen a la iniciativa"/></header></Column><Column id="column10_1714468867116"><header><Label text="Fecha Inicio " id="label10_1714468867116" textAlign="Center"/></header></Column><Column id="column11_1714468867118"><header><Label text="Fecha FIn " id="label11_1714468867117" textAlign="Center"/></header></Column></columns><items><ColumnListItem type="Active" id="colum4"><cells><Label id="texty" text="{planning>fase}"/><DatePicker id="Fechainicio" value="{planning>fechaInicio}" change="onFechaChange" displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"/><DatePicker id="fecha_fin1" value="{planning>fechaFin}" change="onFechaChange" displayFormat="dd-MM-yyyy" valueFormat="yyyy-MM-dd"/></cells></ColumnListItem></items></Table><viz:VizFrame id="idVizFrame" height="400px" width="500px" uiConfig="{ \'applicationSet\': \'fiori\' }" legendVisible="true" vizType="bar" visible="true"><viz:dataset><viz.data:FlattenedDataset id="fnor" data="{planning>/chartData}"><viz.data:dimensions><viz.data:DimensionDefinition id="suyel" name="Fase" value="{planning>fase}"/></viz.data:dimensions><viz.data:measures><viz.data:MeasureDefinition id="mied" name="Duración (días)" value="{planning>duracion}"/><viz.data:MeasureDefinition id="miedLabel" name="Información" value="{planning>label}"/></viz.data:measures></viz.data:FlattenedDataset></viz:dataset><viz:feeds><viz.feeds:FeedItem id="juras" uid="valueAxis" type="Measure" values="Duración (días)"/><viz.feeds:FeedItem id="nopue" uid="color" type="Dimension" values="Fase"/></viz:feeds><viz:feeds><viz.feeds:FeedItem id="feedLabel" uid="tooltip" type="Measure" values="Información"/></viz:feeds></viz:VizFrame></items></FlexBox><FlexBox width="100%" id="box0_1714472600967"><items><Table noDataText="Drop column list items here and columns in the area above" id="table0_1714472906427" class="customHeaderColor2 customHeaderColor1" items="{fechasModel>/fechas}" width="500px"><headerToolbar><Toolbar id="plsn" class="toolbar-con-borde"><Title id="tuilo45" text="Plan de servicio" level="H2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1714472906426"><cells><Text id="text9" text="Plan"/><DatePicker   value ="{fechasModel>fechaInicio}" displayFormat="dd-MM-yyyy"  valueFormat="yyyy-MM-dd"  change="onFechaManualChange"  id="text11"/><DatePicker   value ="{fechasModel>fechaFin}" displayFormat="dd-MM-yyyy"  valueFormat="yyyy-MM-dd"   change="onFechaManualChange"   id="text100052881"/></cells></ColumnListItem></items><columns><Column id="column0_1714472906426" class="sapUiSmallMarginBottom"><header><Label text="Hito/Fase" id="label0_1714472906426"/></header></Column><Column id="column1_1714472906427"><header><Label text="Fecha Inicio " id="label1_1714472906427"/></header></Column><Column id="column2_1714472906427"><header><Label text="Fecha Fin " id="label2_1714472906427"/></header></Column></columns></Table><viz:VizFrame id="idVizFrame2" height="280px" width="400px"\r\n              uiConfig="{ \'applicationSet\': \'fiori\' }"\r\n              legendVisible="true" vizType="bar" visible="true"><viz:dataset><viz.data:FlattenedDataset id="fnor2" data="{fechasModel>/chartData}"><viz.data:dimensions><viz.data:DimensionDefinition id="suyel2" name="Fase" value="{fechasModel>fase}"/></viz.data:dimensions><viz.data:measures><viz.data:MeasureDefinition id="mied2" name="Duración (días)" value="{fechasModel>duracion}"/><viz.data:MeasureDefinition id="miedLabel2" name="Información" value="{fechasModel>label}"/></viz.data:measures></viz.data:FlattenedDataset></viz:dataset><viz:feeds><viz.feeds:FeedItem id="juras2" uid="valueAxis" type="Measure" values="Duración (días)"/><viz.feeds:FeedItem id="nopue2" uid="categoryAxis" type="Dimension" values="Fase"/></viz:feeds><viz:feeds><viz.feeds:FeedItem id="feedLabel2" uid="tooltip" type="Measure" values="Información"/></viz:feeds></viz:VizFrame></items></FlexBox><FlexBox width="100%" id="box0_1721815442596"><HBox id="cambfgiDFSDFggy" justifyContent="SpaceAround" width="1900px" class="sapUiSmallMargin  sapUiLargeMarginEnd"><Table ariaLabelledBy="__xmlview0--label9_1714468867114" noDataText="Drop column list items here and columns in the area above" id="table2" width="400px" class="customHeaderColor2"><items><ColumnListItem id="item2_1723105790552"><cells><Input xmlns="sap.m" id="input4"/><Input xmlns="sap.m" id="input5"/></cells></ColumnListItem><ColumnListItem id="item1_1723105787832"><cells><Input xmlns="sap.m" id="input0_1723105930068"/><Input xmlns="sap.m" id="input3"/></cells></ColumnListItem><ColumnListItem id="item3_1723105794572"><cells><Input xmlns="sap.m" id="input1_1723105936805"/><Input xmlns="sap.m" id="input6"/></cells></ColumnListItem><ColumnListItem id="item0_1723105785244"><cells><Input xmlns="sap.m" id="input7"/><Input xmlns="sap.m" id="input8_1723105979796"/></cells></ColumnListItem><ColumnListItem type="Active" id="item0_1723105402188"><cells><Input xmlns="sap.m" id="input9_1723106964685"/><Input xmlns="sap.m" id="input10_1723106967478"/></cells></ColumnListItem></items><columns><Column id="column0_1723105402188"><header><CheckBox xmlns="sap.m" text="Condicionado" selected="false" id="box_condi" select="onSelectCheckbox" tooltip="Si es una contratación condicionada marca el checkbox e indicar los proveedores condicionados, asi como el motivo del condicionamiento en el apartado Motivo de Condicionamiento  "/></header></Column><Column id="column1_1723105402189"><header><CheckBox xmlns="sap.m" text="Proveedores" selected="false" id="box_prove" select="onSelectCheckbox" tooltip="Si se va a abrir a Licitación marca el checkbox e indicar los proveedores a ser invitados al proceso (Contratación ordinaria) "/></header></Column></columns></Table><ToolbarSpacer/><VBox id="cambio2" class="sapUiLargeMarginBegin" justifyContent="End" alignItems="End" width="100%"><HBox class="sapUiLargeMarginBottom" justifyContent="Center" alignItems="Center"><VBox class="sapUiSmallMarginEnd  sapUiLargeMarginBegin" justifyContent="Center" alignItems="Center"><Label text="Tipo Compra" class="color"/><Select id="select_tipoCom" selectedKey="{TipoCompra>valor}" change="onInputChange" width="300px" items="{/TipoCompra}" forceSelection="false"><items><core:Item key="{ID}" text="{tipo}"/></items></Select></VBox><VBox justifyContent="Center" alignItems="Center"><Label text="Motivo Condicionamiento" class="color"/><Select id="selectMotivo" width="520px" selectedKey="{MotivoCondi>valor}" change="onInputChange" items="{/MotivoCondi}" forceSelection="false"><items><core:Item key="{ID}" text="{tipo}"/></items></Select></VBox></HBox><Label text="Comentarios tipo Compra" textAlign="Center" id="titul23445" class="color" tooltip="Comentarios sobre la facturación si aplica"/><TextArea id="idComentariosFac" placeholder="Escribe aquí..." rows="2" cols="60" class="sapUiSmallMarginBottom"/><HBox class="sapUiLargeMarginBottom" justifyContent="Center" alignItems="Center"><VBox class="sapUiSmallMarginEnd  sapUiLargeMarginBegin" justifyContent="Center" alignItems="Center"><Label text="Justificación del Condicionamiento y/o Información de licitación" textAlign="End" id="tituloCome" class="color" visible="true" tooltip="Comentarios sobre la facturación si aplica"/><TextArea xmlns="sap.m" placeholder="Escribe aquí..." id="idTextComProve" rows="2" cols="60" editable="false" visible="true"/></VBox><VBox class="sapUiSmallMarginEnd  sapUiLargeMarginBegin" justifyContent="End" alignItems="Center"><Label text="Contacto en la Operadora" textAlign="End" id="titulo12984" class="color" visible="true" tooltip="Comentarios sobre la facturación si aplica"/><TextArea xmlns="sap.m" placeholder="Escribe aquí..." id="idComenpVd" rows="2" cols="60" editable="false" visible="true"/></VBox></HBox></VBox></HBox></FlexBox></content></Panel><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel3" class="sapUiTinyMarginTop"><headerToolbar><Toolbar id="toolbar1_1714475868856"><Title text="Objetivos" id="titu" class="customHeaderTitle color"/><ToolbarSpacer id="ddd"/><Button icon="sap-icon://settings" id="btn_3"/></Toolbar></headerToolbar><content><FlexBox width="100%" id="box0_1714476532308" justifyContent="Center"><items><VBox id="cambfgiggy" class="sapUiSmallMargin"><Toolbar id="d5gc5c"><Title id="text9_1714476556932c" text="Objectivo y Alcance" level="H2" class="color"/></Toolbar><TextArea xmlns="sap.m" placeholder="Escribe aquí..." id="idObje" rows="4" cols="60"/></VBox></items><items><VBox id="cambio34gg4" justifyContent="End" class="sapUiSmallMargin"><Toolbar id="d5g5c"><Title id="ds2654" text="Asunciones y Restricciones" level="H2" class="color"/></Toolbar><TextArea xmlns="sap.m" placeholder="Escribe aquí..." id="idAsunyRestri" rows="4" cols="60"/></VBox></items></FlexBox><FlexBox width="100%" id="box0_1714486261986" justifyContent="Center" alignItems="Center"><items><Label text="" id="label25466427"/><Label text="" id="la3423423442342306427" class="sapUiLargeMarginTop"/><Label text="" id="frted"/><Label text="" id="3234324"/><Label text="" id="la342344232323442306427"/><Label text="" id="frt234234ed" class="sapUiLargeMarginTop"/><Table noDataText="Drop column list items here and columns in the area above" id="table_clienteFac" class="sapUiLargeMargin sapUiLargeMarginTop sapUiLargeMarginBottom  customHeaderColor" visible="false" width="600px"><headerToolbar><Toolbar id="d55"><Title id="d2654" text="Cliente Facturación" level="H2" class="color" tooltip="Indicar las jurídicas y sus correspondientes porcentajes aplicables"/></Toolbar></headerToolbar><items><ColumnListItem id="item4"><cells><Input xmlns="sap.m" value="" id="input3_1721377434240"/><Input xmlns="sap.m" value="" id="input4_1721377439916" placeholder="%" liveChange="metodoSumar" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item2"><cells><Input xmlns="sap.m" value="" id="input5_1721377442858"/><Input xmlns="sap.m" value="" id="input6_1721377445026" placeholder="%" liveChange="metodoSumar" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item3"><cells><Input xmlns="sap.m" value="" id="input8_1721377454370"/><Input xmlns="sap.m" value="" id="input11_1721377485489" placeholder="%" liveChange="metodoSumar" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item1_1721377335122"><cells><Input xmlns="sap.m" value="" id="input7_17213749328"/><Input xmlns="sap.m" value="" id="input7_1721377449328" placeholder="%" liveChange="metodoSumar" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item0_1721377331534"><cells><Input xmlns="sap.m" value="" id="input9"/><Input xmlns="sap.m" value="" id="input10" placeholder="%" liveChange="metodoSumar" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item0_172137731534"><cells><Title xmlns="sap.m" text="Total " id="titl4498465562859635552"/><Text id="text73_172746565340567" text="" textAlign="Right"/></cells></ColumnListItem></items><columns><Column id="column0_1721311953574"><header><Label text="Jurídicas" id="label0_1721311953574"/></header></Column><Column id="column1_1721311953574"><header><Label text="Oferta" id="label1_1721311953574"/></header></Column></columns></Table><VBox id="vboxFactura" class="sapUiMediumMarginBegin" justifyContent="End" alignItems="End" width="100%"><HBox class="sapUiSmallMarginBottom" justifyContent="End" alignItems="End"><VBox class="sapUiSmallMarginEnd" justifyContent="End"><CheckBox text="Mensual " id="idCheckMensual" selected="false" visible="false" class="customCheck" tooltip="Marcar en caso de facturación mensual (Mantenimiento, servicios,... )"/></VBox><VBox justifyContent="End"><Label text="Comentarios de Facturación" textAlign="End" id="TextoCon" class="color" visible="false" tooltip="Comentarios sobre la facturación si aplica"/><TextArea xmlns="sap.m" placeholder="Escribe aquí..." id="idComentarioTipo" rows="1" cols="60" visible="false"/></VBox></HBox><Table noDataText="Drop column list items here and columns in the area above" id="table0" class="sapUiSmallMargin  customHeaderColor" width="600px" visible="false"><headerToolbar><Toolbar id="dfff"><HBox alignItems="Center"><Button icon="sap-icon://hint" type="Transparent" press="onInfoPress" tooltip="Ver más información"/><Title id="d2ff" text="Facturación Proyecto / Servicio Cliente Externo" level="H2" class="color"/></HBox></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1718882030913"><cells><DatePicker xmlns="sap.m" id="picker0" displayFormat="yyyy-MM-dd"/><Input xmlns="sap.m" value="" id="input6_1718884539620"/><Input xmlns="sap.m" value="" id="input8" liveChange="metodoSumarFac" placeholder="%" textAlign="Right"/></cells></ColumnListItem><ColumnListItem type="Active" id="ite"><cells><DatePicker xmlns="sap.m" id="picker1" displayFormat="yyyy-MM-dd"/><Input xmlns="sap.m" value="" id="input5_1718884535732"/><Input xmlns="sap.m" value="" id="input4_1718884530459" liveChange="metodoSumarFac" placeholder="%" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item0_1718884640237"><cells><DatePicker xmlns="sap.m" id="picker2" displayFormat="yyyy-MM-dd"/><Input xmlns="sap.m" value="" id="input3_1718884677565"/><Input xmlns="sap.m" value="" id="input1_1718884666668" liveChange="metodoSumarFac" placeholder="%" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item1_1718884655263"><cells><DatePicker xmlns="sap.m" id="picker3" displayFormat="yyyy-MM-dd"/><Input xmlns="sap.m" value="" id="input4_1718884681583"/><Input xmlns="sap.m" value="" id="input7_1718884705972" liveChange="metodoSumarFac" placeholder="%" textAlign="Right"/></cells></ColumnListItem><ColumnListItem type="Active" id="itefttt"><cells><DatePicker xmlns="sap.m" id="picker4" displayFormat="yyyy-MM-dd"/><Input xmlns="sap.m" value="" id="input3_1718884526227"/><Input xmlns="sap.m" value="" id="input0_1718884628484" liveChange="metodoSumarFac" placeholder="%" textAlign="Right"/></cells></ColumnListItem><ColumnListItem id="item0_17213773153499"><cells><Title xmlns="sap.m" text="Total " id="titl4498465552"/><Text xmlns="sap.m" id="text66_1728298016626"/><Text id="text73_172746565340569997" text="" class="metodoSumarFac" textAlign="Right"/></cells></ColumnListItem></items><columns><Column id="column0_1718882030913"><header><Label text="Fecha Estimada" id="label0_1718882030913" textAlign="Center"/></header></Column><Column id="column1_1718882030914"><header><Label text="Descripción Hito" id="label1_1718882030913" textAlign="Center"/></header></Column><Column id="column2_1718882030914"><header><Label text="Facturación" id="label2_1718882030914" textAlign="Center"/></header></Column></columns></Table></VBox></items></FlexBox></content></Panel></IconTabFilter><IconTabFilter id="coste52" text="Costes Mensualizados " count="" key="key1"><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel4"><headerToolbar><Toolbar id="toolbar1_1714730282344"><Title text="Comité de Oportunidades" id="titulo4" class="customHeaderTitle color"/><ToolbarSpacer id="t"/><Button icon="sap-icon://hint" type="Transparent" press="onInfoPressRecursos" tooltip="Ver más información"/></Toolbar></headerToolbar><content><Text text="Comité de Oportunidades" id="text9_1714730282344" class="sapUiSmallMargin myText2 "/><FlexBox width="100%" id="box0_1714732707799" justifyContent="Center"><items><Table noDataText="Drop column list items here and columns in the area above" id="tabla_datos" class="sapUiMediumMargin customHeaderColor2" width="1000px"><items><ColumnListItem type="Active" id="item0_1714732717715"><cells><Text text="" id="txt_ini"/><Text text="" id="txt_funcio"/><Text text="" id="txt_codig"/><Text text="" id="txt_nomPro"/><Text text="" id="txt_area"/><Text text="" id="txt_NomJefe"/><Text text="" id="txt_feIni"/><Text text="" id="txt_feFin"/></cells></ColumnListItem></items><columns><Column id="column0_1714732717716" hAlign="Center"><header><Label text="Iniciativa " id="label0_1714732717716" class=".myText2"/></header></Column><Column id="column1_1714732717716" hAlign="Center"><header><Label text="Cliente Funcional " id="label1_1714732717716" class=".myText2"/></header></Column><Column id="column2_1714732717716" hAlign="Center"><header><Label text="Codigo" id="label2_1714732717716" class=".myText2"/></header></Column></columns><columns><Column id="column0_1714732h717716" hAlign="Center"><header><Label text="Nombre Proyecto" id="label0_171r4732717716" class=".myText2"/></header></Column><Column id="column1_171473s2717716" hAlign="Center"><header><Label text="Area" id="label1_17147s32717716" class=".myText2"/></header></Column><Column id="column2_171w4732717716" hAlign="Center"><header><Label text="Jefe de Proyecto" id="label2_171sw4732717716" class=".myText2"/></header></Column></columns><columns><Column id="column0_171473717716" hAlign="Center"><header><Label text="Fecha Inicio " id="label0_171r47717716" class=".myText2"/></header></Column><Column id="column1_171473s27716" hAlign="Center"><header><Label text="Fecha Fin " id="label1_177s32717716" class=".myText2"/></header></Column></columns></Table></items></FlexBox><FlexBox width="2000px" id="box0_1714747137718" class="sapUiTinyMargin"><items><ScrollContainer id="scroll_container" width="100%" height="auto"><Text text="Por favor, asegúrese de seleccionar la Vertical, el Tipo de Servicio y el Perfil/Servicio, ya que estos tres campos son obligatorios. También debe indicar el valor correspondiente en el campo Oferta (Adicionales, Formación, Soporte). En caso de no completar los campos obligatorios, no se realizará el registro y no se registrará la información ingresada" class="sapUiSmallMarginBottom" wrapping="true" width="100%"/><Table noDataText="Drop column list items here and columns in the area above" id="table_dimicFecha" width="auto" class="customHeaderColor"><headerToolbar><Toolbar id="toolbr1" class=".customTableHeader"><HBox><Title text="Recursos Interno" id="tituo1" class="customTextColor "/></HBox><ToolbarSpacer id="d45"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item1_174747617887"><cells><Select xmlns="sap.m" id="selec0" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}" tooltip="En todas las secciones Seleccionar la Vertical, Tipo de Servicio, Perfil / Servicio (Estos tres campos son obligatorios) e indicar el Concepto de Oferta (adicionales, formacion, soporte... )"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item0_1716637548"/></items></Select><Select xmlns="sap.m" id="select0_17163029264" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item"/></items></Select><Select xmlns="sap.m" id="selct3" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change=".onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="item2_1716302986"/></items></Select><Input xmlns="sap.m" value = "" id="input0_2958934"/><Text xmlns="sap.m" text="" id="pmj2" class="boldText"/><Text xmlns="sap.m" text="" id="text26"/><Text xmlns="sap.m" text=""  id="idtest5"/><Text xmlns="sap.m" text=""  id="txt2026r"/><Text xmlns="sap.m" text="" id="migt5"/><Text xmlns="sap.m" text="" id="text30"/><Text xmlns="sap.m" text="" id="text31"/><Text xmlns="sap.m"  text="" id="text32" class="boldText"/><Text xmlns="sap.m" text=""  id="text33" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0"><cells><Select xmlns="sap.m" id="select2_17242325367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item6"/></items></Select><Select xmlns="sap.m" id="select3" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item9"/></items></Select><Select xmlns="sap.m" id="select4" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change="onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="item11"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723542368780"/><Text xmlns="sap.m" text="" id="pmj3" class="boldText"/><Text xmlns="sap.m" text="" id="text25_1723542407010"/><Text xmlns="sap.m" text="" id="text26_1723542427727"/><Text xmlns="sap.m" text="" id="text27"/><Text xmlns="sap.m" text="" id="text28"/><Text xmlns="sap.m" text="" id="text29"/><Text xmlns="sap.m" text="" id="text30_1723542463030"/><Text xmlns="sap.m" text="" id="text31_1723542471572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_1723542481599" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_1723542179949"><cells><Select xmlns="sap.m" id="select2_1723542325367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item212"/></items></Select><Select xmlns="sap.m" id="select334" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item332"/></items></Select><Select xmlns="sap.m" id="select409" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change="onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="itewm11"/></items></Select><Input xmlns="sap.m" value="" id="input0_17235428780"/><Text xmlns="sap.m" text="" id="pmj5" class="boldText"/><Text xmlns="sap.m" text="" id="text25_1723407010"/><Text xmlns="sap.m" text="" id="text26_17235427727"/><Text xmlns="sap.m" text="" id="text334d"/><Text xmlns="sap.m" text="" id="text2t56"/><Text xmlns="sap.m" text="" id="text29666"/><Text xmlns="sap.m" text="" id="text30_172463030"/><Text xmlns="sap.m" text="" id="text31_172351572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_172341599" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_new"><cells><Select xmlns="sap.m" id="select2_new1" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item6_new"/></items></Select><Select xmlns="sap.m" id="select3_new" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item9_new"/></items></Select><Select xmlns="sap.m" id="select4_new" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change="onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="item11_new"/></items></Select><Input xmlns="sap.m" value="" id="input0_new1"/><Text xmlns="sap.m" text="" id="pmj3_new" class="boldText"/><Text xmlns="sap.m" text="" id="text25_new"/><Text xmlns="sap.m" text="" id="text26_new"/><Text xmlns="sap.m" text="" id="text27_new"/><Text xmlns="sap.m" text="" id="text28_new"/><Text xmlns="sap.m" text="" id="text29_new"/><Text xmlns="sap.m" text="" id="text30_new"/><Text xmlns="sap.m" text="" id="text31_new" class="boldText"/><Text xmlns="sap.m" text="" id="text32_new" class="boldText"/></cells></ColumnListItem><ColumnListItem id="Column234345"><cells><Select xmlns="sap.m" id="select1_1749565933756" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item634"/></items></Select><Select xmlns="sap.m" id="select2" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item6_1749565978362"/></items></Select><Select xmlns="sap.m" id="select0_1749566678136" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change="onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="item2_1749566678135"/></items></Select><Input xmlns="sap.m" value="" id="input0_1749566689065"/><Text xmlns="sap.m"  text="" id="pmj23" class="boldText"/><Text xmlns="sap.m" text="" id="text97_1749566900765"/><Text xmlns="sap.m" text="" id="text98_1749566908601"/><Text xmlns="sap.m" text="" /><Text xmlns="sap.m"  text="" id="text100_1749566961856"/><Text xmlns="sap.m"  text="" id="text101_1749566974942"/><Text xmlns="sap.m" text="" id="text102_1749567001265"/><Text xmlns="sap.m" text="" id="text103_1749567071319" class="boldText"/><Text xmlns="sap.m" text="" id="text104_1749567079346" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_custom_001"><cells><Select xmlns="sap.m" id="select2_custom_001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_custom_001"/></items></Select><Select xmlns="sap.m" id="select3_custom_001" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_custom_002"/></items></Select><Select xmlns="sap.m" id="select4_custom_001" selectedKey="{PerfilServicio>valuePerfil}" forceSelection="false" items="{/PerfilServicio}" change="onPerfilChangeTabla1"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombrePerfil}" id="item_custom_003"/></items></Select><Input xmlns="sap.m" value="" id="input0_custom_001"/><Text xmlns="sap.m" text="" id="text1_custom_001" class="boldText"/><Text xmlns="sap.m" text="" id="text2_custom_001"/><Text xmlns="sap.m" text="" id="text3_custom_001"/><Text xmlns="sap.m" text="" id="text4_custom_001"/><Text xmlns="sap.m" text="" id="text5_custom_001"/><Text xmlns="sap.m" text="" id="text6_custom_001"/><Text xmlns="sap.m" text="" id="text7_custom_001"/><Text xmlns="sap.m" text="" id="text8_custom_001" class="boldText"/><Text xmlns="sap.m" text="" id="text9_custom_001" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column3_1714747617887" hAlign="Center"><header><Label text="Vertical" id="lbl_ver" class="color" textAlign="Center" tooltip="En todas las secciones Seleccionar la Vertical, Tipo de Servicio, Perfil / Servicio (Estos tres campos son obligatorios) e indicar el Concepto de Oferta (adicionales, formacion, soporte... )"/></header></Column><Column id="column4_1714747617887" hAlign="Center"><header><Label text="Tipo Servicios" id="lbl_tipoSe"/></header></Column><Column id="column5_1714747617888" vAlign="Bottom"><header><Label text="Perfil/Servicio" id="lbl_perSer"/></header></Column><Column id="column5_171461788" vAlign="Bottom"><header><Label text="Concepto Oferta" id="lbl_conOfer"/></header></Column><Column id="column5_17476188" vAlign="Bottom"><header><Label text="PMJ" id="lbl_pmj"/></header></Column><Column id="column5_1476188" vAlign="Bottom"><header><Label text="2025" id="anio1"/></header></Column><Column id="column5_76188" vAlign="Bottom"><header><Label text="2026" id="anio2"/></header></Column><Column id="column5_7688" vAlign="Bottom"><header><Label text="2027" id="anio3"/></header></Column><Column id="column5_768" vAlign="Bottom"><header><Label text="2028" id="anio4"/></header></Column><Column id="column5_788" vAlign="Bottom"><header><Label text="2029" id="anio5"/></header></Column><Column id="column5_76" vAlign="Bottom"><header><Label text="2030" id="anio6"/></header></Column><Column id="column5_78" vAlign="Bottom"><header><Label text="Total" id="lbl_total"/></header></Column><Column id="column5_8" vAlign="Bottom"><header><Label text="Total €" id="total_1"/></header></Column></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_1727879568594"><items><ScrollContainer id="scroll_container23" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="tableServicioInterno" width="auto" class="customHeaderColor2 "><items><ColumnListItem id="item3_1723544157941"><cells><Select xmlns="sap.m" id="select2_1325367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item456"/></items></Select><Select xmlns="sap.m" id="select165678" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item5423547174354"/></items></Select><Text xmlns="sap.m" text="" id="text27_172792"/><Input xmlns="sap.m" value="" id="input0_17235423780"/><Text xmlns="sap.m" id="pmj1" text="" class="boldText"/><Text xmlns="sap.m" text="" id="text25_172354240710"/><Text xmlns="sap.m" text="" id="text26_1723542467727"/><Text xmlns="sap.m" text="" id="text2767"/><Text xmlns="sap.m" text="" id="text2558"/><Text xmlns="sap.m" text="" id="text2559"/><Text xmlns="sap.m" text="" id="text30_17235424030"/><Text xmlns="sap.m" text="" id="text31_17251572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_172354299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_9999999999999"><cells><Select xmlns="sap.m" id="select2_999001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item999001"/></items></Select><Select xmlns="sap.m" id="select165999" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item999002"/></items></Select><Text xmlns="sap.m" text="" id="text999001"/><Input xmlns="sap.m" value="" id="input999001"/><Text xmlns="sap.m" id="pmj999001" text="" class="boldText"/><Text xmlns="sap.m" text="" id="text999002"/><Text xmlns="sap.m" text="" id="text999003"/><Text xmlns="sap.m" text="" id="text999004"/><Text xmlns="sap.m" text="" id="text999005"/><Text xmlns="sap.m" text="" id="text999006"/><Text xmlns="sap.m" text="" id="text999007"/><Text xmlns="sap.m" text="" id="text999008" class="boldText"/><Text xmlns="sap.m" text="" id="text999009" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_8888888888888"><cells><Select xmlns="sap.m" id="select2_888001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item888001"/></items></Select><Select xmlns="sap.m" id="select165888" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item888002"/></items></Select><Text xmlns="sap.m" text="" id="text888001"/><Input xmlns="sap.m" value="" id="input888001"/><Text xmlns="sap.m" id="pmj888001" text="" class="boldText"/><Text xmlns="sap.m" text="" id="text888002"/><Text xmlns="sap.m" text="" id="text888003"/><Text xmlns="sap.m" text="" id="text888004"/><Text xmlns="sap.m" text="" id="text888005"/><Text xmlns="sap.m" text="" id="text888006"/><Text xmlns="sap.m" text="" id="text888007"/><Text xmlns="sap.m" text="" id="text888008" class="boldText"/><Text xmlns="sap.m" text="" id="text888009" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_7777777777777"><cells><Select xmlns="sap.m" id="select2_777001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item777001"/></items></Select><Select xmlns="sap.m" id="select165777" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item777002"/></items></Select><Text xmlns="sap.m" text="" id="text777001"/><Input xmlns="sap.m" value="" id="input777001"/><Text xmlns="sap.m" id="pmj777001" text="" class="boldText"/><Text xmlns="sap.m" text="" id="text777002"/><Text xmlns="sap.m" text="" id="text777003"/><Text xmlns="sap.m" text="" id="text777004"/><Text xmlns="sap.m" text="" id="text777005"/><Text xmlns="sap.m" text="" id="text777006"/><Text xmlns="sap.m" text="" id="text777007"/><Text xmlns="sap.m" text="" id="text777008" class="boldText"/><Text xmlns="sap.m" text="" id="text777009" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1727879576856"><header><Title xmlns:mvc="sap.ui.core.mvc" text="Otros Servicios" id="title43_copy" class="color"/></header></Column><Column id="column5_84" vAlign="Bottom"><header/></Column><Column id="column1_172879576857"/><Column id="column1_172787582676857"/><Column id="colum8279576857"/><Column id="column1_1728279576857"/><Column id="col8279576857"/><Column id="column729576857"/><Column id="column858279576857"/><Column id="column1_1728776857"/><Column id="column1_1727576857"/><Column id="column1_172779576857"/><Column id="column2_179576857"><header><Text xmlns="sap.m" id="text71_1729582650577"/></header></Column></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_1727879817594"><items><ScrollContainer id="scroll_container2983" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="tablGastoViajeInterno" width="auto" class="customHeaderColor2"><items><ColumnListItem id="item0_172354393445"><cells><Select xmlns="sap.m" id="select187" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item2_17235452431"/></items></Select><Select xmlns="sap.m" id="select2_172354530484" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item085"/></items></Select><Text xmlns="sap.m" text="" id="text27_17235452792"/><Input xmlns="sap.m" id="input0552587" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="pmj6" class="boldText"/><Text xmlns="sap.m" text="" id="text30_1235430075"/><Text xmlns="sap.m" text="" id="text31_172354536874"/><Text xmlns="sap.m" text="" id="text32_172545344700"/><Text xmlns="sap.m" text="" id="text33_17354532636"/><Text xmlns="sap.m" text="" id="text084"/><Text xmlns="sap.m" text="" id="tex05"/><Text xmlns="sap.m" text="" id="text3887" class="boldText"/><Text xmlns="sap.m" text="" id="text3888" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_new_id"><cells><Select xmlns="sap.m" id="select_vertical_new" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_vertical_new"/></items></Select><Select xmlns="sap.m" id="select_tipo_servicio_new" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_tipo_servicio_new"/></items></Select><Text xmlns="sap.m" text="" id="text_empty_1_new"/><Input xmlns="sap.m" id="input_codigo_proyecto_new" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text_bold_1_new" class="boldText"/><Text xmlns="sap.m" text="" id="text_empty_2_new"/><Text xmlns="sap.m" text="" id="text_empty_3_new"/><Text xmlns="sap.m" text="" id="text_empty_4_new"/><Text xmlns="sap.m" text="" id="text_empty_5_new"/><Text xmlns="sap.m" text="" id="text_empty_6_new"/><Text xmlns="sap.m" text="" id="text_empty_7_new"/><Text xmlns="sap.m" text="" id="text_bold_2_new" class="boldText"/><Text xmlns="sap.m" text="" id="text_bold_3_new" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_1723544014499"><cells><Select xmlns="sap.m" id="select0" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item0_1723547152451"/></items></Select><Select xmlns="sap.m" id="select1" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item3_1723547174354"/></items></Select><Text xmlns="sap.m" text="" id="text31_17235471659"/><Input xmlns="sap.m" id="input855025865"/><Text xmlns="sap.m" text="" id="pmj4" class="boldText"/><Text xmlns="sap.m" text="" id="text33_1723547184800"/><Text xmlns="sap.m" text="" id="text34"/><Text xmlns="sap.m" text="" id="text35"/><Text xmlns="sap.m" text="" id="text36"/><Text xmlns="sap.m" text="" id="text37"/><Text xmlns="sap.m" text="" id="text38"/><Text xmlns="sap.m" text="" id="text39" class="boldText"/><Text xmlns="sap.m" text="" id="text40" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1727879940115"><header><Title xmlns="sap.m" text="Gastos de Viaje" id="title44" class="color"/></header></Column><Column id="column1_1727879940115"/><Column id="column2_1700000115"/><Column id="column2_17278791940115"/><Column id="column1727879940115"/><Column id="column2t_1727815"/><Column id="columtn2_1727845"/><Column id="colum79940415456"/><Column id="columt8579940115"/><Column id="coluomn787994540115"/><Column id="coluomn7879945465850115"/><Column id="coluomn78799454890115"/><Column id="co6890115"/></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_1721815443829" class="sapUiTinyMargin"><items><ScrollContainer id="scroll_containe2" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="tablaConsuExter" width="auto" class="customHeaderColor sapUiMediumMarginTop"><headerToolbar><Toolbar id="toolbr3"><Title text="Consumo Externo" id="tituo5" class="customTextColor"/><ToolbarSpacer id="d4ds5"/></Toolbar></headerToolbar><items><ColumnListItem id="item1_1721815314200"><cells><Select xmlns="sap.m" id="select2_1723539571816" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_1723539571815"/></items></Select><Select xmlns="sap.m" id="select5" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item13"/></items></Select><Select xmlns="sap.m" id="select6" selectedKey="{PerfilConsumo>valuePerfilC}" forceSelection="false" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item145"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723560526473"/><Text xmlns="sap.m" text="" id="text481" class="boldText"/><Text xmlns="sap.m" text="" id="text492"/><Text xmlns="sap.m" text="" id="text503"/><Text xmlns="sap.m" text="" id="text514"/><Text xmlns="sap.m" text="" id="text552"/><Text xmlns="sap.m" text="" id="text536"/><Text xmlns="sap.m" text="" id="text547"/><Text xmlns="sap.m" text="" id="text558" class="boldText"/><Text xmlns="sap.m" text="" id="text560" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_1723561579633"><cells><Select xmlns="sap.m" id="select2_1723539576" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_17235395"/></items></Select><Select xmlns="sap.m" id="select2345" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item13888"/></items></Select><Select xmlns="sap.m" id="select6543" selectedKey="{PerfilConsumo>valuePerfilC}" forceSelection="false" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item15"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723560523"/><Text xmlns="sap.m" text="" id="text4898" class="boldText"/><Text xmlns="sap.m" text="" id="text49"/><Text xmlns="sap.m" text="" id="text50"/><Text xmlns="sap.m" text="" id="text51"/><Text xmlns="sap.m" text="" id="text52"/><Text xmlns="sap.m" text="" id="text53"/><Text xmlns="sap.m" text="" id="text54"/><Text xmlns="sap.m" text="" id="text55" class="boldText"/><Text xmlns="sap.m" text="" id="text56" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_1723561596033"><cells><Select xmlns="sap.m" id="select2_1723559576" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_17535395"/></items></Select><Select xmlns="sap.m" id="select23455" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item135888"/></items></Select><Select xmlns="sap.m" id="select65443" selectedKey="{PerfilConsumo>valuePerfilC}" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" forceSelection="false" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item44415"/></items></Select><Input xmlns="sap.m" value="" id="input0_100723560523"/><Text xmlns="sap.m" text="" id="text48098" class="boldText"/><Text xmlns="sap.m" text="" id="text0049"/><Text xmlns="sap.m" text="" id="text5000"/><Text xmlns="sap.m" text="" id="text5100"/><Text xmlns="sap.m" text="" id="text5002"/><Text xmlns="sap.m" text="" id="text5003"/><Text xmlns="sap.m" text="" id="text5004"/><Text xmlns="sap.m" text="" id="text5005" class="boldText"/><Text xmlns="sap.m" text="" id="text50006" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_1753091785858"><cells><Select xmlns="sap.m" id="select2_new001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_new001"/></items></Select><Select xmlns="sap.m" id="select2_new002" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item8_new002"/></items></Select><Select xmlns="sap.m" id="select2_new003" selectedKey="{PerfilConsumo>valuePerfilC}" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" forceSelection="false" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item8_new003"/></items></Select><Input xmlns="sap.m" value="" id="input0_new001"/><Text xmlns="sap.m" text="" id="text_new001" class="boldText"/><Text xmlns="sap.m" text="" id="text_new002"/><Text xmlns="sap.m" text="" id="text_new003"/><Text xmlns="sap.m" text="" id="text_new004"/><Text xmlns="sap.m" text="" id="text_new005"/><Text xmlns="sap.m" text="" id="text_new006"/><Text xmlns="sap.m" text="" id="text_new007"/><Text xmlns="sap.m" text="" id="text_new008" class="boldText"/><Text xmlns="sap.m" text="" id="text_new009" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_new002"><cells><Select xmlns="sap.m" id="select2_new010" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_new010"/></items></Select><Select xmlns="sap.m" id="select2_new011" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item8_new011"/></items></Select><Select xmlns="sap.m" id="select2_new012" selectedKey="{PerfilConsumo>valuePerfilC}" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" forceSelection="false" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item8_new012"/></items></Select><Input xmlns="sap.m" value="" id="input0_new010"/><Text xmlns="sap.m" text="" id="text_new010" class="boldText"/><Text xmlns="sap.m" text="" id="text_new011"/><Text xmlns="sap.m" text="" id="text_new012"/><Text xmlns="sap.m" text="" id="text_new013"/><Text xmlns="sap.m" text="" id="text_new014"/><Text xmlns="sap.m" text="" id="text_new015"/><Text xmlns="sap.m" text="" id="text_new016"/><Text xmlns="sap.m" text="" id="text_new017" class="boldText"/><Text xmlns="sap.m" text="" id="text_new018" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item3_new003"><cells><Select xmlns="sap.m" id="select2_new020" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_new020"/></items></Select><Select xmlns="sap.m" id="select2_new021" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item8_new021"/></items></Select><Select xmlns="sap.m" id="select2_new022" selectedKey="{PerfilConsumo>valuePerfilC}" tooltip="Seleccionar un perfil de la lista en caso de estar predefinido en caso contrario, introducir el Perfil y el PMJ aplicable al mismo en la columna PMJ" forceSelection="false" items="{/PerfilConsumo}" change="selectFuncionchange"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{nombrePerfilC}" id="item8_new022"/></items></Select><Input xmlns="sap.m" value="" id="input0_new020"/><Text xmlns="sap.m" text="" id="text_new020" class="boldText"/><Text xmlns="sap.m" text="" id="text_new021"/><Text xmlns="sap.m" text="" id="text_new022"/><Text xmlns="sap.m" text="" id="text_new023"/><Text xmlns="sap.m" text="" id="text_new024"/><Text xmlns="sap.m" text="" id="text_new025"/><Text xmlns="sap.m" text="" id="text_new026"/><Text xmlns="sap.m" text="" id="text_new027" class="boldText"/><Text xmlns="sap.m" text="" id="text_new028" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column3_1721815314201"><header><Label text="Vertical " id="label3_1721815314201"/></header></Column><Column id="column4_1721815314201"><header><Label text="Tipo Servicio" id="label4_1721815314201"/></header></Column><Column id="column5_1721815314201"><header><Label text="Perfil Servicio " id="label5_1721815314201"/></header></Column><Column id="column1_1723559260833"><header><Label text="Concepto Oferta" id="text38_1723559260832"/></header></Column><Column id="column2_1723559272834"><header><Label text="PMJ" id="text39_1723559272834"/></header></Column><Column id="column3_1723559286551"><header><Label text="2025" id="text40_1723559286550"/></header></Column><Column id="column4_1723559297070"><header><Label text="2026" id="text41_1723559297069"/></header></Column><Column id="column5_1723559395812"><header><Label text="2027" id="text42_1723559395811"/></header></Column><Column id="column6"><header><Label text="2028" id="text43"/></header></Column><Column id="column7"><header><Label text="2029" id="text44"/></header></Column><Column id="column8"><header><Label text="2030" id="text45"/></header></Column><Column id="column9_1723560312685"><header><Label text="Total" id="txt46"/></header></Column><Column id="column10_1723560351944"><header><Label text="Total € " id="text47"/></header></Column></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_1727948724833"><items><ScrollContainer id="scroll_containe345968" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="idOtroserConsu" width="auto" class="customHeaderColor2"><items><ColumnListItem id="item1_1724397774576"><cells><Select xmlns="sap.m" id="select2_132531067" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item45106"/></items></Select><Select xmlns="sap.m" id="seect104" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item156101"/></items></Select><Text xmlns="sap.m" text="" id="text27_17279210"/><Input xmlns="sap.m" id="input0552896767" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text29410" class="boldText"/><Text xmlns="sap.m" text="" id="text25_172354240710100"/><Text xmlns="sap.m" text="" id="text26_172354246701727"/><Text xmlns="sap.m" text="" id="text271067"/><Text xmlns="sap.m" text="" id="text250158"/><Text xmlns="sap.m" text="" id="text255109"/><Text xmlns="sap.m" text="" id="text30_1723542104030"/><Text xmlns="sap.m" text="" id="text31_1725157102" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235429910" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_new004"><cells><Select xmlns="sap.m" id="select2_new030" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new030"/></items></Select><Select xmlns="sap.m" id="select_new031" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new031"/></items></Select><Text xmlns="sap.m" text="" id="text_new030"/><Input xmlns="sap.m" id="input_new030" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text_new031" class="boldText"/><Text xmlns="sap.m" text="" id="text_new032"/><Text xmlns="sap.m" text="" id="text_new033"/><Text xmlns="sap.m" text="" id="text_new034"/><Text xmlns="sap.m" text="" id="text_new035"/><Text xmlns="sap.m" text="" id="text_new036"/><Text xmlns="sap.m" text="" id="text_new037"/><Text xmlns="sap.m" text="" id="text_new038" class="boldText"/><Text xmlns="sap.m" text="" id="text_new039" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item2_1724397821392"><cells><Select xmlns="sap.m" id="select2_13205367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item4560"/></items></Select><Select xmlns="sap.m" id="seect40" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item17561"/></items></Select><Text xmlns="sap.m" text="" id="text27_1702792"/><Input xmlns="sap.m" id="input05" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text2904" class="boldText"/><Text xmlns="sap.m" text="" id="text25_1723542710"/><Text xmlns="sap.m" text="" id="text26_1723542427"/><Text xmlns="sap.m" text="" id="text276007"/><Text xmlns="sap.m" text="" id="text25058"/><Text xmlns="sap.m" text="" id="text25059"/><Text xmlns="sap.m" text="" id="text30_1723540204030"/><Text xmlns="sap.m" text="" id="text31_1725015072" class="boldText"/><Text xmlns="sap.m" text="" id="text32_1702354299" class="boldText"/></cells></ColumnListItem></items><ColumnListItem id="item2_new1001"><cells><Select xmlns="sap.m" id="select2_new1001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new1001"/></items></Select><Select xmlns="sap.m" id="select2_new1002" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new1002"/></items></Select><Text xmlns="sap.m" text="" id="text_new1003"/><Input xmlns="sap.m" id="input_new1004" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text_new1005" class="boldText"/><Text xmlns="sap.m" text="" id="text_new1006"/><Text xmlns="sap.m" text="" id="text_new1007"/><Text xmlns="sap.m" text="" id="text_new1008"/><Text xmlns="sap.m" text="" id="text_new1009"/><Text xmlns="sap.m" text="" id="text_new1010"/><Text xmlns="sap.m" text="" id="text_new1011"/><Text xmlns="sap.m" text="" id="text_new1012" class="boldText"/><Text xmlns="sap.m" text="" id="text_new1013" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item2_new2001"><cells><Select xmlns="sap.m" id="select2_new2001" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new2001"/></items></Select><Select xmlns="sap.m" id="select2_new2002" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new2002"/></items></Select><Text xmlns="sap.m" text="" id="text_new2003"/><Input xmlns="sap.m" id="input_new2004" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" text="" id="text_new2005" class="boldText"/><Text xmlns="sap.m" text="" id="text_new2006"/><Text xmlns="sap.m" text="" id="text_new2007"/><Text xmlns="sap.m" text="" id="text_new2008"/><Text xmlns="sap.m" text="" id="text_new2009"/><Text xmlns="sap.m" text="" id="text_new2010"/><Text xmlns="sap.m" text="" id="text_new2011"/><Text xmlns="sap.m" text="" id="text_new2012" class="boldText"/><Text xmlns="sap.m" text="" id="text_new2013" class="boldText"/></cells></ColumnListItem><columns><Column id="column0_1727948918033"><header><Title xmlns="sap.m" text="Otros Servicios" id="title45" class="color"/></header></Column><Column id="column1_1727948918033"/><Column id="column2_1727948918033"/><Column id="column2_172794891804533"/><Column id="column4_1727948937547"/><Column id="column5_1727948940622"/><Column id="column7_1727948946436"/><Column id="column6_1727948943601"/><Column id="column8_1727948948989"/><Column id="column11_1727948977071"/><Column id="column9_1727948952449"/><Column id="column10_1727948956089"/><Column id="column3_1727948934250"/></columns></Table></ScrollContainer></items></FlexBox><FlexBox id="box0_1727950351451" width="2000px"><items><ScrollContainer id="scroll_containe345" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="idGastoViajeConsu" width="auto" class="customHeaderColor2 "><items><ColumnListItem id="item0_1724399567964"><cells><Select xmlns="sap.m" id="select2_17325367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item4576"/></items></Select><Select xmlns="sap.m" id="seect488" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15861"/></items></Select><Text xmlns="sap.m" text="" id="text27_1728792"/><Input xmlns="sap.m" id="input55605"/><Text xmlns="sap.m" text="" id="text2943" class="boldText"/><Text xmlns="sap.m" text="" id="text25_17235440710"/><Text xmlns="sap.m" text="" id="text26_172354246727"/><Text xmlns="sap.m" text="" id="text27677"/><Text xmlns="sap.m" text="" id="text25578"/><Text xmlns="sap.m" text="" id="text25597"/><Text xmlns="sap.m" text="" id="text30_17235424430"/><Text xmlns="sap.m" text="" id="text31_1725152572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235452299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_1724399587539"><cells><Select xmlns="sap.m" id="select2_132785367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item4541476"/></items></Select><Select xmlns="sap.m" id="seect4144" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item154161"/></items></Select><Text xmlns="sap.m" text="" id="text27_17241792"/><Input xmlns="sap.m" id="input054645"/><Text xmlns="sap.m" text="" id="text2947" class="boldText"/><Text xmlns="sap.m" text="" id="text25_17235424010"/><Text xmlns="sap.m" text="" id="text26_17235467727"/><Text xmlns="sap.m" text="" id="text2767527"/><Text xmlns="sap.m" text="" id="text2418"/><Text xmlns="sap.m" text="" id="text25459"/><Text xmlns="sap.m" text="" id="text30_1777235424030"/><Text xmlns="sap.m" text="" id="text31_1724551572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235475299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_new101"><cells><Select xmlns="sap.m" id="select2_new101" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new101"/></items></Select><Select xmlns="sap.m" id="select_new102" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new102"/></items></Select><Text xmlns="sap.m" text="" id="text_new103"/><Input xmlns="sap.m" id="input_new104"/><Text xmlns="sap.m" text="" id="text_new105" class="boldText"/><Text xmlns="sap.m" text="" id="text_new106"/><Text xmlns="sap.m" text="" id="text_new107"/><Text xmlns="sap.m" text="" id="text_new108"/><Text xmlns="sap.m" text="" id="text_new109"/><Text xmlns="sap.m" text="" id="text_new110"/><Text xmlns="sap.m" text="" id="text_new111"/><Text xmlns="sap.m" text="" id="text_new112" class="boldText"/><Text xmlns="sap.m" text="" id="text_new113" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_new201"><cells><Select xmlns="sap.m" id="select2_new201" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new201"/></items></Select><Select xmlns="sap.m" id="select_new202" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new202"/></items></Select><Text xmlns="sap.m" text="" id="text_new203"/><Input xmlns="sap.m" id="input_new204"/><Text xmlns="sap.m" text="" id="text_new205" class="boldText"/><Text xmlns="sap.m" text="" id="text_new206"/><Text xmlns="sap.m" text="" id="text_new207"/><Text xmlns="sap.m" text="" id="text_new208"/><Text xmlns="sap.m" text="" id="text_new209"/><Text xmlns="sap.m" text="" id="text_new210"/><Text xmlns="sap.m" text="" id="text_new211"/><Text xmlns="sap.m" text="" id="text_new212" class="boldText"/><Text xmlns="sap.m" text="" id="text_new213" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_new301"><cells><Select xmlns="sap.m" id="select2_new301" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item_new301"/></items></Select><Select xmlns="sap.m" id="select_new302" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item_new302"/></items></Select><Text xmlns="sap.m" text="" id="text_new303"/><Input xmlns="sap.m" id="input_new304"/><Text xmlns="sap.m" text="" id="text_new305" class="boldText"/><Text xmlns="sap.m" text="" id="text_new306"/><Text xmlns="sap.m" text="" id="text_new307"/><Text xmlns="sap.m" text="" id="text_new308"/><Text xmlns="sap.m" text="" id="text_new309"/><Text xmlns="sap.m" text="" id="text_new310"/><Text xmlns="sap.m" text="" id="text_new311"/><Text xmlns="sap.m" text="" id="text_new312" class="boldText"/><Text xmlns="sap.m" text="" id="text_new313" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1727950359285"><header><Title xmlns="sap.m" text="Gastos de viaje" id="title4145" class="color"/></header></Column><Column id="column7_1727950403610"><header/></Column><Column id="column4_1727950396824"/><Column id="column9_1727950408140"/><Column id="column10_1727950410822"/><Column id="column6_1727950401522"/><Column id="column12_1727950435214"/><Column id="column8_1727950405901"/><Column id="column5_1727950399522"/><Column id="column3_1727950372051"/><Column id="column378_1727950372051"/><Column id="column1_1727950359287"/><Column id="column2_1727950359288"/></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_17218154429" class="sapUiTinyMargin"><ScrollContainer id="scroll_containe3" width="100%"><Table noDataText="Drop column list items here and columns in the area above" id="tablaRecExterno" width="auto" class="customHeaderColor  sapUiMediumMarginTop"><headerToolbar><Toolbar id="toolbr03"><Title text="Recurso Externo" id="tituo500" class="customTextColor "/><ToolbarSpacer id="d4005"/></Toolbar></headerToolbar><items><ColumnListItem id="item1_17215314200"><cells><Select xmlns="sap.m" id="select2_172353950816" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_172353957100815"/></items></Select><Select xmlns="sap.m" id="select50" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item1023"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723652356052643"/><Input xmlns="sap.m" value="" id="input0_1723560528897864314"/><Input xmlns="sap.m" value="" id="input140_17235605264314"/><Text xmlns="sap.m" text="" id="text4902"/><Text xmlns="sap.m" text="" id="text50003"/><Text xmlns="sap.m" text="" id="text5104"/><Text xmlns="sap.m" text="" id="text5502"/><Text xmlns="sap.m" text="" id="text53600"/><Text xmlns="sap.m" text="" id="text5407"/><Text xmlns="sap.m" text="" id="text55008" class="boldText"/><Text xmlns="sap.m" text="" id="text56000" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_172356157633"><cells><Select xmlns="sap.m" id="select2_172353956" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_172353595"/></items></Select><Select xmlns="sap.m" id="select23450" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item138858"/></items></Select><Input xmlns="sap.m" value="" id="inpumt0_172360523"/><Input xmlns="sap.m" value="" id="input0_172360523"/><Input xmlns="sap.m" value="" id="input0_172360145641523"/><Text xmlns="sap.m" text="" id="text480948"/><Text xmlns="sap.m" text="" id="text419"/><Text xmlns="sap.m" text="" id="text504"/><Text xmlns="sap.m" text="" id="text5144"/><Text xmlns="sap.m" text="" id="text5442"/><Text xmlns="sap.m" text="" id="text5344"/><Text xmlns="sap.m" text="" id="text5544" class="boldText"/><Text xmlns="sap.m" text="" id="text5644" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17235616033"><cells><Select xmlns="sap.m" id="select2_17259576" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_1753535"/></items></Select><Select xmlns="sap.m" id="select2355" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="411477898652"/></items></Select><Input xmlns="sap.m" value="" id="input0_1007210114323"/><Input xmlns="sap.m" value="" id="input0_10072323"/><Input xmlns="sap.m" value="" id="input0_1724585865452360523"/><Text xmlns="sap.m" text="" id="text010049"/><Text xmlns="sap.m" text="" id="text15000"/><Text xmlns="sap.m" text="" id="text51004"/><Text xmlns="sap.m" text="" id="text501402"/><Text xmlns="sap.m" text="" id="text50043"/><Text xmlns="sap.m" text="" id="text54004"/><Text xmlns="sap.m" text="" id="text50405" class="boldText"/><Text xmlns="sap.m" text="" id="text500406" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17215314201"><cells><Select xmlns="sap.m" id="select2_172353950817" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_172353957100816"/></items></Select><Select xmlns="sap.m" id="select51" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item1024"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723652356052644"/><Input xmlns="sap.m" value="" id="input0_1723560528897864315"/><Input xmlns="sap.m" value="" id="input140_17235605264315"/><Text xmlns="sap.m" text="" id="text4903"/><Text xmlns="sap.m" text="" id="text50004"/><Text xmlns="sap.m" text="" id="text5105"/><Text xmlns="sap.m" text="" id="text5503"/><Text xmlns="sap.m" text="" id="text53601"/><Text xmlns="sap.m" text="" id="text5408"/><Text xmlns="sap.m" text="" id="text55009" class="boldText"/><Text xmlns="sap.m" text="" id="text56001" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17215314202"><cells><Select xmlns="sap.m" id="select2_172353950818" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_172353957100817"/></items></Select><Select xmlns="sap.m" id="select52" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item1025"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723652356052645"/><Input xmlns="sap.m" value="" id="input0_1723560528897864316"/><Input xmlns="sap.m" value="" id="input140_17235605264316"/><Text xmlns="sap.m" text="" id="text4904"/><Text xmlns="sap.m" text="" id="text50005"/><Text xmlns="sap.m" text="" id="text5106"/><Text xmlns="sap.m" text="" id="text5504"/><Text xmlns="sap.m" text="" id="text53602"/><Text xmlns="sap.m" text="" id="text5409"/><Text xmlns="sap.m" text="" id="text55010" class="boldText"/><Text xmlns="sap.m" text="" id="text56002" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17215314203"><cells><Select xmlns="sap.m" id="select2_172353950819" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item8_172353957100818"/></items></Select><Select xmlns="sap.m" id="select53" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item1026"/></items></Select><Input xmlns="sap.m" value="" id="input0_1723652356052646"/><Input xmlns="sap.m" value="" id="input0_1723560528897864317"/><Input xmlns="sap.m" value="" id="input140_17235605264317"/><Text xmlns="sap.m" text="" id="text4905"/><Text xmlns="sap.m" text="" id="text5000456"/><Text xmlns="sap.m" text="" id="text5107"/><Text xmlns="sap.m" text="" id="text5505"/><Text xmlns="sap.m" text="" id="text53603"/><Text xmlns="sap.m" text="" id="text5410"/><Text xmlns="sap.m" text="" id="text55011" class="boldText"/><Text xmlns="sap.m" text="" id="text56003" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column3_172221815314201"><header><Label text="Vertical " id="label3_1721815551"/></header></Column><Column id="column4_17218153140551"><header><Label text="Tipo Servicio" id="label4_1721201"/></header></Column><Column id="column5_1721814201"><header><Label text="Perfil Servicio " id="label5_172181531401"/></header></Column><Column id="column1_172356033"><header><Label text="Concepto Oferta" id="text38_17235592832"/></header></Column><Column id="column2_17235592234"><header><Label text="PMJ" id="text39_1723552834"/></header></Column><Column id="column3_172355928651"><header><Label text="2025" id="text40_17559286550"/></header></Column><Column id="column4_17235592970"><header><Label text="2026" id="text41_179297069"/></header></Column><Column id="column5_172355932"><header><Label text="2027" id="text1723559395811"/></header></Column><Column id="column66569"><header><Label text="2028" id="text4556853"/></header></Column><Column id="column79978"><header><Label text="2029" id="text58744"/></header></Column><Column id="column8879"><header><Label text="2030" id="text984798445"/></header></Column><Column id="column9_170312685"><header><Label text="Total" id="lbl_tal"/></header></Column><Column id="column10_172356035"><header><Label text="Total € " id="text565447"/></header></Column></columns></Table></ScrollContainer><items/></FlexBox><FlexBox width="2000px" id="box0_1727953252765"><items><ScrollContainer id="scroll_containe345222" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="idServiExterno" width="auto" class="customHeaderColor2"><items><ColumnListItem id="item1_17243977745476"><cells><Select xmlns="sap.m" id="select2_13253067" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item451067"/></items></Select><Select xmlns="sap.m" id="seect10204" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15610101"/></items></Select><Text xmlns="sap.m" text="" id="text27_1727910"/><Input xmlns="sap.m" id="input05545" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" id="text2910"/><Text xmlns="sap.m" id="text25_1723542407100"/><Text xmlns="sap.m" id="text26_1723246701727"/><Text xmlns="sap.m" id="text2717"/><Text xmlns="sap.m" id="text2508"/><Text xmlns="sap.m" id="text25519"/><Text xmlns="sap.m" text="" id="text30_1723542130"/><Text xmlns="sap.m" text="" id="text31_17251502" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235410" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item2_1724397822"><cells><Select xmlns="sap.m" id="select2_132054367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item45460"/></items></Select><Select xmlns="sap.m" id="seect40414" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item17404561"/></items></Select><Text xmlns="sap.m" text="" id="text27_17024792"/><Input xmlns="sap.m" id="input055287"/><Text xmlns="sap.m" id="text294004" class="boldText"/><Text xmlns="sap.m" id="text25_172340542710"/><Text xmlns="sap.m" id="text26_17235042427"/><Text xmlns="sap.m" id="text27600407"/><Text xmlns="sap.m" id="text2504058"/><Text xmlns="sap.m" id="text2505940"/><Text xmlns="sap.m" text="" id="text30_1723540200004030"/><Text xmlns="sap.m" text="" id="text31_1724050015072" class="boldText"/><Text xmlns="sap.m" text="" id="text32_170235429409" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17243977745477"><cells><Select xmlns="sap.m" id="select2_13253068" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item451068"/></items></Select><Select xmlns="sap.m" id="seect10205" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15610102"/></items></Select><Text xmlns="sap.m" text="" id="text27_1727911"/><Input xmlns="sap.m" id="input05546" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" id="text2911"/><Text xmlns="sap.m" id="text25_1723542407101"/><Text xmlns="sap.m" id="text26_1723246701728"/><Text xmlns="sap.m" id="text2718"/><Text xmlns="sap.m" id="text2509"/><Text xmlns="sap.m" id="text25520"/><Text xmlns="sap.m" text="" id="text30_1723542131"/><Text xmlns="sap.m" text="" id="text31_17251503" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235411" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17243977745478"><cells><Select xmlns="sap.m" id="select2_13253069" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item451069"/></items></Select><Select xmlns="sap.m" id="seect10206" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15610103"/></items></Select><Text xmlns="sap.m" text="" id="text27_1727912"/><Input xmlns="sap.m" id="input05547" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" id="text2912"/><Text xmlns="sap.m" id="text25_1723542407102"/><Text xmlns="sap.m" id="text26_1723246701729"/><Text xmlns="sap.m" id="text2719"/><Text xmlns="sap.m" id="text2510"/><Text xmlns="sap.m" id="text25521"/><Text xmlns="sap.m" text="" id="text30_1723542132"/><Text xmlns="sap.m" text="" id="text31_17251504" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235412" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_17243977745479"><cells><Select xmlns="sap.m" id="select2_13253070" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item451070"/></items></Select><Select xmlns="sap.m" id="seect10207" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15610104"/></items></Select><Text xmlns="sap.m" text="" id="text27_1727913"/><Input xmlns="sap.m" id="input05548" tooltip="Codigo Proyecto"/><Text xmlns="sap.m" id="text2913"/><Text xmlns="sap.m" id="text25_1723542407103"/><Text xmlns="sap.m" id="text26_1723246701730"/><Text xmlns="sap.m" id="text2720"/><Text xmlns="sap.m" id="text2511"/><Text xmlns="sap.m" id="text25522"/><Text xmlns="sap.m" text="" id="text30_1723542133"/><Text xmlns="sap.m" text="" id="text31_17251505" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235413" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column3_1727953316919"><header><Title xmlns="sap.m" text="Otros Servicios" id="title4445" class="color"/></header></Column><Column id="column11_1727953342801"/><Column id="column865420"/><Column id="column10_1727953340239"/><Column id="column12_1727953346004"/><Column id="column9_1727953335905"/><Column id="column7_1727953331492"/><Column id="column0_1727953262176"/><Column id="column6_1727953328949"/><Column id="column4_1727953320366"/><Column id="column5_1727953325886"/><Column id="column1_1727953262176"/><Column id="column2_1727953262177"/></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box1_1727953468615"><items><ScrollContainer id="scroll_containe341115" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="idGastoRecuExter" width="auto" class="customHeaderColor2"><items><ColumnListItem id="item0_172439956007964"><cells><Select xmlns="sap.m" id="select2_1725367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item455276"/></items></Select><Select xmlns="sap.m" id="seect48588" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15868251"/></items></Select><Text xmlns="sap.m" text="" id="text27_172852792"/><Input xmlns="sap.m" id="input0555436287"/><Text xmlns="sap.m" text=" " id="text8692943"/><Text xmlns="sap.m" text=" " id="text25_17235465340710"/><Text xmlns="sap.m" text="" id="text26_172354256346727"/><Text xmlns="sap.m" text="" id="text27656377"/><Text xmlns="sap.m" text="" id="text255765638"/><Text xmlns="sap.m" text="" id="text2556397"/><Text xmlns="sap.m" text="" id="text30_17256335424430"/><Text xmlns="sap.m" text="" id="text31_1725635152572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235465352299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_172439965587539"><cells><Select xmlns="sap.m" id="select2_132785365367" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item454221476"/></items></Select><Select xmlns="sap.m" id="seect415675444" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item188854161"/></items></Select><Text xmlns="sap.m" text="" id="text27_1724122792"/><Input xmlns="sap.m" id="input05528856877"/><Text xmlns="sap.m" id="text2945567"/><Text xmlns="sap.m" id="text25_1723542401550"/><Text xmlns="sap.m" id="text26_172354677545427"/><Text xmlns="sap.m" id="text2767544427"/><Text xmlns="sap.m" id="text24148"/><Text xmlns="sap.m" id="text25454744449"/><Text xmlns="sap.m" text="" id="text30_1777230"/><Text xmlns="sap.m" text="" id="text31_17245544572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_23545299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_172439956007965"><cells><Select xmlns="sap.m" id="select2_1725368" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item455277"/></items></Select><Select xmlns="sap.m" id="seect48589" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15868252"/></items></Select><Text xmlns="sap.m" text="" id="text27_172852793"/><Input xmlns="sap.m" id="input0555436288"/><Text xmlns="sap.m" text=" " id="text8692944"/><Text xmlns="sap.m" text=" " id="text25_17235465340711"/><Text xmlns="sap.m" text="" id="text26_172354256346728"/><Text xmlns="sap.m" text="" id="text27656378"/><Text xmlns="sap.m" text="" id="text255765639"/><Text xmlns="sap.m" text="" id="text2556398"/><Text xmlns="sap.m" text="" id="text30_17256335424431"/><Text xmlns="sap.m" text="" id="text31_1725635152573" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235465352300" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_172439956007966"><cells><Select xmlns="sap.m" id="select2_1725369" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item455278"/></items></Select><Select xmlns="sap.m" id="seect48590" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15868253"/></items></Select><Text xmlns="sap.m" text="" id="text27_172852794"/><Input xmlns="sap.m" id="input0555436289"/><Text xmlns="sap.m" text=" " id="text8692945"/><Text xmlns="sap.m" text=" " id="text25_17235465340712"/><Text xmlns="sap.m" text="" id="text26_172354256346729"/><Text xmlns="sap.m" text="" id="text27656379"/><Text xmlns="sap.m" text="" id="text255765640"/><Text xmlns="sap.m" text="" id="text2556399"/><Text xmlns="sap.m" text="" id="text30_17256335424432"/><Text xmlns="sap.m" text="" id="text31_1725635152574" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235465352301" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_172439956007967"><cells><Select xmlns="sap.m" id="select2_1725370" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item455279"/></items></Select><Select xmlns="sap.m" id="seect48591" selectedKey="{TipoServicio>valueTipoServ}" forceSelection="false" items="{/TipoServicio}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreTipoServ}" id="item15868254"/></items></Select><Text xmlns="sap.m" text="" id="text27_172852795"/><Input xmlns="sap.m" id="input0555436290"/><Text xmlns="sap.m" text=" " id="text8692946"/><Text xmlns="sap.m" text=" " id="text25_17235465340713"/><Text xmlns="sap.m" text="" id="text26_172354256346730"/><Text xmlns="sap.m" text="" id="text27656380"/><Text xmlns="sap.m" text="" id="text255765641"/><Text xmlns="sap.m" text="" id="text2556400"/><Text xmlns="sap.m" text="" id="text30_17256335424433"/><Text xmlns="sap.m" text="" id="text31_1725635152575" class="boldText"/><Text xmlns="sap.m" text="" id="text32_17235465352302" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column13_1727953477166"><header><Title xmlns="sap.m" text="Gastos de viaje" id="title400145" class="color"/></header></Column><Column id="column0_1727955320651"><header/></Column><Column id="column14_1727953477167"><header/></Column><Column id="column9_1727955353197"><header/></Column><Column id="column1_1727955323593"><header/></Column><Column id="column5_1727955342170"><header/></Column><Column id="column8_1727955350313"><header/></Column><Column id="column4_1727955339745"><header/></Column><Column id="column7_1727955348070"><header/></Column><Column id="column6_1727955344912"><header/></Column><Column id="column3_1727955329344"><header/></Column><Column id="column2_1727955326936"><header/></Column><Column id="column15_1727953477170"><header/></Column></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_17254429" class="sapUiLargeMarginTop"><items><ScrollContainer id="scroll_containe4" width="100%" height="auto"><Table noDataText="Drop column list items here and columns in the area above" id="tablaInfrestuctura" class="customHeaderColor" width="auto"><headerToolbar><Toolbar id="toolbr6"><Title text="Otros conceptos" id="tituo6" class="customTextColor borderedTable"/><ToolbarSpacer id="d4ds55"/></Toolbar></headerToolbar><items><ColumnListItem id="item0_1724421285072"><cells><Select xmlns="sap.m" id="select0_1724421301612" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item1_1724421301610"/></items></Select><Text xmlns="sap.m" text="" id="text67"/><Input xmlns="sap.m" value="" id="input0_1724422144416"/><Text xmlns="sap.m" text="" id="text69_1729172956538" class="boldText"/><Text xmlns="sap.m" text="" id="text71_1729173066345"/><Text xmlns="sap.m" text="" id="text72_1729173082482"/><Text xmlns="sap.m" text="" id="text73_1729173098474"/><Text xmlns="sap.m" text="" id="text74_1729173156735"/><Text xmlns="sap.m" text="" id="text75_1729173165560"/><Text xmlns="sap.m" text="" id="text76_1729173175636"/><Text xmlns="sap.m" text="" id="text77_1729173187036" class="boldText"/><Text xmlns="sap.m" text="" id="text78_1729173199360" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item1_1724414006634"><cells><Select xmlns="sap.m" id="select1_1724421323918" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item3_1724421323916"/></items></Select><Text xmlns="sap.m" text="" id="text6527"/><Input xmlns="sap.m" value="" id="input05528857"/><Text xmlns="sap.m" text="" id="text29467" class="boldText"/><Text xmlns="sap.m" text="" id="text25_172342450"/><Text xmlns="sap.m" text="" id="text26_172357545427"/><Text xmlns="sap.m" text="" id="text2754427"/><Text xmlns="sap.m" text="" id="text2418528"/><Text xmlns="sap.m" text="" id="text25449"/><Text xmlns="sap.m" text="" id="text30_17354030"/><Text xmlns="sap.m" text="" id="text31_4544572" class="boldText"/><Text xmlns="sap.m" text="" id="text32_171145299" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_1724421285073"><cells><Select xmlns="sap.m" id="select0_1724421301613" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item1_1724421301611"/></items></Select><Text xmlns="sap.m" text="" id="text00000000068"/><Input xmlns="sap.m" value="" id="input0_1724422144417"/><Text xmlns="sap.m" text="" id="text69_1729172956539" class="boldText"/><Text xmlns="sap.m" text="" id="text71_1729173066346"/><Text xmlns="sap.m" text="" id="text72_1729173082483"/><Text xmlns="sap.m" text="" id="text73_1729173098475"/><Text xmlns="sap.m" text="" id="text74_1729173156736"/><Text xmlns="sap.m" text="" id="text75_1729173165561"/><Text xmlns="sap.m" text="" id="text76_1729173175637"/><Text xmlns="sap.m" text="" id="text77_1729173187037" class="boldText"/><Text xmlns="sap.m" text="" id="text78_1729173199361" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_1724421285074"><cells><Select xmlns="sap.m" id="select0_1724421301614" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item1_1724421301612"/></items></Select><Text xmlns="sap.m" text="" id="text0000000069"/><Input xmlns="sap.m" value="" id="input0_1724422144418"/><Text xmlns="sap.m" text="" id="text69_1729172956540" class="boldText"/><Text xmlns="sap.m" text="" id="text71_1729173066347"/><Text xmlns="sap.m" text="" id="text72_1729173082484"/><Text xmlns="sap.m" text="" id="text73_1729173098476"/><Text xmlns="sap.m" text="" id="text74_1729173156737"/><Text xmlns="sap.m" text="" id="text75_1729173165562"/><Text xmlns="sap.m" text="" id="text76_1729173175638"/><Text xmlns="sap.m" text="" id="text77_1729173187038" class="boldText"/><Text xmlns="sap.m" text="" id="text78_1729173199362" class="boldText"/></cells></ColumnListItem><ColumnListItem id="item0_1724421285075"><cells><Select xmlns="sap.m" id="select0_1724421301615" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" key="{ID}" text="{NombreVertical}" id="item1_1724421301613"/></items></Select><Text xmlns="sap.m" text="" id="text000000070"/><Input xmlns="sap.m" value="" id="input0_1724422144419"/><Text xmlns="sap.m" text="" id="text69_1729172956541" class="boldText"/><Text xmlns="sap.m" text="" id="text71_1729173066348"/><Text xmlns="sap.m" text="" id="text72_1729173082485"/><Text xmlns="sap.m" text="" id="text73_1729173098477"/><Text xmlns="sap.m" text="" id="text74_1729173156738"/><Text xmlns="sap.m" text="" id="text75_1729173165563"/><Text xmlns="sap.m" text="" id="text76_1729173175639"/><Text xmlns="sap.m" text="" id="text77_1729173187039" class="boldText"/><Text xmlns="sap.m" text="" id="text78_1729173199363" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1724413700663"><header><Label text="Infrestuctura/Licencias/Viajes" id="label0_1724413700663"/></header></Column><Column id="column1_1724413700664"><header><Label text="Servicios" id="label1_1724413700664"/></header></Column><Column id="column2_1724413700664"><header><Label text="Concepto Oferta" id="label2_1724413700664"/></header></Column><Column id="column3_1724414044811"><header><Label text="PMJ" id="text71"/></header></Column><Column id="column4_1724414055800"><header><Label text="2025" id="text72"/></header></Column><Column id="column5_1724414073667"><header><Label text="2026" id="text73"/></header></Column><Column id="column6_1724414086329"><header><Label text="2027" id="text74"/></header></Column><Column id="column7_1724414094602"><header><Label text="2028" id="text75"/></header></Column><Column id="column8_1724414260725"><header><Label text="2029" id="text76"/></header></Column><Column id="column9_1724414268892"><header><Label text="2030" id="text77"/></header></Column><Column id="column10_1724414276433"><header><Label text="Total" id="text78"/></header></Column><Column id="column11_1724414284497"><header><Label text="Total €" id="text79"/></header></Column></columns></Table></ScrollContainer></items></FlexBox><FlexBox width="2000px" id="box0_1727955568380"><items><Table xmlns="sap.m" noDataText="Drop column list items here and columns in the area above" id="tablaLicencia" width="auto" class="customHeaderColor2"><columns><Column id="column0_1727955577123"><header><Title id="title65680" text="Licencias" class="color"/></header></Column><Column id="column3_1727955658552"/><Column id="column8_1727955671439"/><Column id="column4_1727955660992"/><Column id="column10_1727955676540"/><Column id="column9_1727955674062"/><Column id="column7_1727955668700"/><Column id="column6_1727955665646"/><Column id="column5_1727955663538"><header/></Column><Column id="column1_1727955577123"/><Column id="column0_1729173455651"/><Column id="column0_1730206050097"/></columns><items><ColumnListItem id="item7"><cells><Select id="select2_1724421568007" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" id="item8_1724421568005" key="{ID}" text="{NombreVertical}"/></items></Select><Text id="text72_1724608268260"/><Input id="input1_1724608279183" value=""/><Text id="text80_1729173297936" class="boldText" text=""/><Text id="text82_1729173316711" text=""/><Text id="text83_1729173320937" text=""/><Text id="text85_1729173332094" text=""/><Text id="text84_1729173328578" text=""/><Text id="text87_1729173377445" text=""/><Text id="text86_1729173336987" text=""/><Text id="text88_1729173381996" class="boldText" text=""/><Text id="text90_1729173466313" class="boldText" text=""/></cells></ColumnListItem><ColumnListItem id="item6_1724421342842"><cells><Select id="select3_1724421586106" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" id="item10" key="{ID}" text="{NombreVertical}"/></items></Select><Text id="text73_1724608398319"/><Input id="input2" value=""/><Text id="text69_1729177354727" class="boldText" text=""/><Text id="text67_1729177335361" text=""/><Text id="text68_1729177339385" text=""/><Text id="text70_1729177361584" text=""/><Text id="text71_1729177364955" text=""/><Text id="text72_1729177370550" text=""/><Text id="text73_1729177374604" text=""/><Text id="text74_1729177380906" class="boldText" text=""/><Text id="text75_1729177384465" class="boldText" text=""/></cells></ColumnListItem><ColumnListItem id="item587897477888"><cells><Select id="select2_1724421568008" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" id="item8_1724421568006" key="{ID}" text="{NombreVertical}"/></items></Select><Text id="text72_1724608268261"/><Input id="input1_1724608279184" value=""/><Text id="text80_1729173297937" class="boldText" text=""/><Text id="text82_1729173316712" text=""/><Text id="text83_1729173320938" text=""/><Text id="text85_1729173332095" text=""/><Text id="text84_1729173328579" text=""/><Text id="text87_1729173377446" text=""/><Text id="text86_1729173336988" text=""/><Text id="text88_1729173381997" class="boldText" text=""/><Text id="text90_1729173466314" class="boldText" text=""/></cells></ColumnListItem><ColumnListItem id="item69518949"><cells><Select id="select2_1724421568009" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" id="item8_1724421568007" key="{ID}" text="{NombreVertical}"/></items></Select><Text id="text72_1724608268262"/><Input id="input1_1724608279185" value=""/><Text id="text80_1729173297938" class="boldText" text=""/><Text id="text82_1729173316713" text=""/><Text id="text83_1729173320939" text=""/><Text id="text85_1729173332096" text=""/><Text id="text84_1729173328580" text=""/><Text id="text87_1729173377447" text=""/><Text id="text86_1729173336989" text=""/><Text id="text88_1729173381998" class="boldText" text=""/><Text id="text90_1729173466315" class="boldText" text=""/></cells></ColumnListItem><ColumnListItem id="item4854110"><cells><Select id="select2_1724421568010" selectedKey="{Vertical>valueVertical}" forceSelection="false" items="{/Vertical}"><items><core:Item xmlns:core="sap.ui.core" id="item8_1724421568008" key="{ID}" text="{NombreVertical}"/></items></Select><Text id="text72_1724608268263"/><Input id="input1_1724608279186" value=""/><Text id="text80_1729173297939" class="boldText" text=""/><Text id="text82_1729173316714" text=""/><Text id="text83_1729173320940" text=""/><Text id="text85_1729173332097" text=""/><Text id="text84_1729173328581" text=""/><Text id="text87_1729173377448" text=""/><Text id="text86_1729173336990" text=""/><Text id="text88_1729173381999" class="boldText" text=""/><Text id="text90_1729173466316" class="boldText" text=""/></cells></ColumnListItem></items></Table></items></FlexBox></content></Panel></IconTabFilter><IconTabFilter id="coste652" text="Resumen Costes y Margen" count="" key="key3"><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel0"><headerToolbar><Toolbar id="toolbar1_1724662285163"><Title id="title34" text="Resumen Costes y Margen" class="customHeaderTitle color"/><ToolbarSpacer id="mu345"/><Button icon="sap-icon://settings" id="btn5643"/></Toolbar></headerToolbar><content><FlexBox width="100%" id="boxs0_1724667519593" justifyContent="Center"><items><Table noDataText="Drop column list items here and columns in the area above" id="table0_1724662386430" width="1000px" class="sapUiLargeMargin customHeaderColor2"><items><ColumnListItem type="Active" id="item0_1724662386428"><cells><Text xmlns="sap.m" id="text72_1731325324246"/><Text xmlns="sap.m" id="text73_1731325328049"/><Text id="txt_client"/><Text id="txt_cFactura"/><Text id="txt_Codi2"/><Text xmlns="sap.m" id="txt_Nombre2"/><Text xmlns="sap.m" id="txt_area2"/><Text xmlns="sap.m" id="txt_Fe_ini2"/><Text xmlns="sap.m" id="txt_Fe_fin2"/></cells></ColumnListItem></items><columns><Column id="column1_1731325278215" hAlign="Center"><header><Label text="Iniciativa" id="text71_1731325278215"/></header></Column><Column id="column0_1731325275102" hAlign="Center"><header><Label text="Naturaleza" id="text70_1731325275101"/></header></Column><Column id="column0_1724662386428" hAlign="Center"><header><Label text="Cliente Funcional" id="label0_1724662386428"/></header></Column><Column id="column1_1724662386429" hAlign="Center"><header><Label text="Cliente Facturación" id="label1_1724662386429"/></header></Column><Column id="column2_1724662386429" hAlign="Center"><header><Label text="Codigo" id="label2_1724662386429"/></header></Column><Column id="column0_1724662560509" hAlign="Center"><header><Label text="Nombre" id="text66"/></header></Column><Column id="column1_1724662575822" hAlign="Center"><header><Label text="Area" id="text67_1724662575822"/></header></Column><Column id="column2_1724662579976" hAlign="Center"><header><Label text="Fecha Inicio" id="text68"/></header></Column><Column id="column3_1724662593213" hAlign="Center"><header><Label text="Fecha Fin " id="text69"/></header></Column></columns></Table></items></FlexBox><FlexBox width="100%" id="box0_1724667519593" justifyContent="Center"><items><Table noDataText="Drop column list items here and columns in the area above" id="tablaTotalesRecur" width="1180px" class="customHeaderColor"><items><ColumnListItem id="item0_1724751005422"><cells><Label id="label0_1724751005420"/><Label width="100%" id="label0_1724751459061"/><VBox id="vboxJorTotal" width="auto"><Input xmlns="sap.m" description="Jornada de Recursos Internos" class="miInputNoEditable" editable="false" id="inputReInter" width="105%" fieldWidth="35%"/><Input xmlns="sap.m" value="" description="Jornada Consumo Externo" id="inputConsuEx" editable="false" width="105%" fieldWidth="35%"/><Input xmlns="sap.m" value="" id="inputRcurExtern" description="Jornada Recurso Externo" editable="false" width="105%" fieldWidth="35%"/><Text xmlns="sap.m" text="________________________" id="text72_1724755428618"/><Input xmlns="sap.m" value="" description="Jornadas totales" id="inputTotalJor" editable="false" width="auto" fieldWidth="35%"/></VBox><VBox id="vbox205" width="auto"><Input xmlns="sap.m" value="" description="Servicios" editable="false" fieldWidth="45%" id="inputServi1" width="105%" class="customNonEditableInput"/><Input xmlns="sap.m" value="" id="inputOtrosServi1" description="Otros Servicios" editable="false" width="auto" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="inputGastoVia1" description=" Gastos de Viaje" editable="false" width="auto" fieldWidth="45%"/><ToolbarSpacer/><ToolbarSpacer/><ToolbarSpacer class="colorCora"/><Input xmlns="sap.m" value="" id="totalRecuInter" description="Recursos Internos" editable="false" width="auto" fieldWidth="45%"/><items/></VBox><VBox width="100%" direction="Column" id="vbox0_1724756807778"><items><Input xmlns="sap.m" value="" id="inputServi2" description="Servicios" editable="false" width="105%" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="inputOtroSer2" description="Otros Servicios " editable="false" width="105%" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="inptGastoVi2" description="Gastos de viaje" editable="false" width="105%" fieldWidth="45%"/><ToolbarSpacer/><ToolbarSpacer/><ToolbarSpacer class="colorCora"/><Input xmlns="sap.m" value="" id="totalConsuExternot" description="Consumo Externo" editable="false" width="105%" fieldWidth="45%"/></items></VBox><VBox width="100%" direction="Column" id="vbox1"><items><Input xmlns="sap.m" value="" id="inputServi" description="Servicios" editable="false" width="105%" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input10_1724757017406" description="Otros Servicios" editable="false" width="105%" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input9_1724757015442" description="Gastis de viaje" editable="false" width="105%" fieldWidth="45%"/><ToolbarSpacer/><ToolbarSpacer/><ToolbarSpacer class="colorCora"/><Input xmlns="sap.m" value="" id="totaRecurExterno" description="Recursos Externos" editable="false" width="105%" fieldWidth="45%"/></items></VBox></cells></ColumnListItem><ColumnListItem id="item3_1724757890529"><cells><Label width="100%" id="label4_1724758163611"/><Label width="100%" id="label5_1724758166913"/><Label width="100%" id="label6"/><VBox width="100%" direction="Column" id="vbox009" class="highlight-border2"><items><Label text="Licencias" width="100%" id="label3_1728582401804" class="color "/><Label xmlns="sap.m" text="Vertical" width="100%" id="label7" class="color"/></items></VBox><Label width="100%" id="label8"/><VBox width="100%" direction="Column" id="vbox1_1724758351656"><items><Label width="100%" id="label1_1724758443032"/><Input xmlns="sap.m" value="00.0" id="totalInfraestruc" class="customInputDescription" description="Infraestructura" editable="false" width="105%" fieldWidth="50%"/><Input xmlns="sap.m" value="" id="input0_1724758359" description="Licencia" editable="false" width="105%" fieldWidth="50%"/></items></VBox></cells></ColumnListItem></items><columns><Column id="column0_1724667530564" width="100px"><header><VBox id="vox0104"><Label id="label0_1724667530564"/><Label xmlns="sap.m" text="Vertical" id="text67_17247477226710"/></VBox></header></Column><Column id="column1_1724667530564" width="100px"><header><VBox id="vox0103"><Label id="label1_1724667530564"/><Label xmlns="sap.m" text="Tipo Servicio" id="text67_177722671"/></VBox></header></Column><Column id="column2_1724667530565" width="260px" hAlign="Center"><VBox id="vox0102"><Label text="" id="text76978540"/><Label xmlns="sap.m" text="Perfil" id="text67_1724747722671"/></VBox></Column><Column id="column3_1724667573396" width="260px" hAlign="Center"><header><VBox id="sdkjffhj"><Label text="Recursos Internos " id="text69_1724667573396" tooltip="Recursos propios de Telefonica"/><Label xmlns="sap.m" text="Ezfuerzo PMJ Coste" id="text66_172474778"/></VBox></header></Column><Column id="column4_1724667576735" width="260px" hAlign="Center"><header><VBox id="vox2"><Label text="Consumo Externo" id="text70" tooltip="Uso de recursos externosa contratados"/><Label xmlns="sap.m" text="Ezfuerzo PMJ Coste" id="text67_1724747722141"/></VBox></header></Column><Column id="column5_1724667579931" width="250px" hAlign="Center"><header><VBox id="vox3"><Label text="Recurso Externo" id="text752890" tooltip="Recursos a subcontratar"/><Label xmlns="sap.m" text="Ezfuerzo PMJ Coste" id="text67_17241"/></VBox></header></Column></columns></Table></items></FlexBox><FlexBox height="100px" alignItems="Start" justifyContent="End"><HBox id="cambio344" justifyContent="End"><Table noDataText="Drop column list items here and columns in the area above" id="table1_1725623729321" width="900px" class="sapUiLargeMarginTop"><items><ColumnListItem id="item2_1725624112050"><cells><VBox width="100%" direction="Column" id="vbox3"><items><Text xmlns="sap.m" text="Valor de referencia 0%. Cualquier cambio a este dato debe ser acordado con Control" class="boldText" wrapping="false" id="text66_1728582744699"/><Text xmlns="sap.m" id="text68_1728582813602"/><Text xmlns="sap.m" id="text67_1728582763477" text="&#9;&#9;&#9;&#9;Proyecto/Servicio de Inversión - El Margen debe ser establecido al 0%" class="boldText"/></items></VBox><VBox width="100%" direction="Column" id="vbox1_1728582556153"><items><Input xmlns="sap.m" value="" id="totalSubtotal" description="Subtotal" editable="false" width="auto" fieldWidth="45%" tooltip="Incluyendo licencias e infraestructuras"/><Input xmlns="sap.m" value="" id="input2_172475612" description="Coste Estructura%" editable="false" width="auto" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input2_1724756105" description="Coste estructura" editable="false" width="auto" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input2_17221205" description="Margen  sobre ingresos %" change=".onColumnTotales" width="auto" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input2_1756121205" description="Margen sobre ingresos" editable="false" width="auto" fieldWidth="45%"/><Input xmlns="sap.m" value="" id="input0_1725625161348" description="Total EUR" editable="false" change=".calcularDistribucionInput"/><Input xmlns="sap.m" value="" id="input0_1725625132423424361348" description="Total USD" visible="false" editable="false" change=".calcularDistribucionInput"/></items></VBox></cells></ColumnListItem></items><columns><Column id="column3_1725623729321" width="90px"/><Column id="column4_1725623729321" width="50px"/></columns></Table></HBox></FlexBox></content></Panel></IconTabFilter><IconTabFilter id="coste6552" text="Resumen Ingresos Vs costes" count="" key="key4"><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel0_1725710852901"><headerToolbar><Toolbar id="toolbar1895695"><Title id="noest" text="Resumen Ingresos Vs costes" class="customHeaderTitle color"/><ToolbarSpacer id="sorrtsd"/><Button id="ten45547" icon="sap-icon://settings"/></Toolbar></headerToolbar><content><FlexBox width="100%" id="boxk0_1724656751149593" justifyContent="Center"><items><ToolbarSpacer/><Table noDataText="Drop column list items here and columns in the area above" id="table0_1725710862342" width="1000px" class="sapUiLargeMargin customHeaderColor2"><items><ColumnListItem type="Active" id="item0_1725710862340"><cells><Text xmlns="sap.m" id="textClitFu3"/><Text xmlns="sap.m" id="textCliFac3"/><Text xmlns="sap.m" id="textCodigo3"/><Text xmlns="sap.m" id="textNatural3"/><Text xmlns="sap.m" id="txtNombre3"/><Text xmlns="sap.m" id="txtAre3"/><Text xmlns="sap.m" id="txtFechInici3"/><Text xmlns="sap.m" id="txtFechFin3"/></cells></ColumnListItem></items><columns><Column id="column0_1725710862340"><header><Label text="Cliente Funcional" id="label0_1725710862340"/></header></Column><Column id="column1_1725710862340"><header><Label text="Cliente Facturación" id="label1_1725710862340"/></header></Column><Column id="column3_1725711607678"><header><Label text="Codigo" id="text70_1725711607678"/></header></Column><Column id="column2_1725710862341"><header><Label text="Naturaleza" id="label2_1725710862341"/></header></Column><Column id="column5_1725711634814"><header><Label text="Nombre" id="text72_1725711634814"/></header></Column><Column id="column6_1725711637469"><header><Label text="Area" id="text73_1725711637466"/></header></Column><Column id="column4_1725711612436"><header><Label text="Fecha Inicio" id="text71_1725711612436"/></header></Column><Column id="column4_17257116124356"><header><Label text="Fecha Fin" id="text71_17257116124536"/></header></Column></columns></Table></items></FlexBox><FlexBox width="3500px" id="box0_1728586490864" justifyContent="Center"><items><HBox width="3500px" id="hbox0" class="sapUiMediumMargin"><Title text="Tipo Servicios " id="tipoSeviTabla" level="H1" class="sapUiLargeMarginTop sapUiSmallMargin customTextColor "/><Table ariaLabelledBy="__xmlview0--label017257878978979865736747" noDataText="Drop column list items here and columns in the area above" id="table0_1729085670197" class="customHeaderColor miTabla"><headerToolbar><Toolbar id="hijo567"><Title id="Gtof5d91211087" text="" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1729085670195"><cells><Text text="" id="text66_1729085670190"/><Text text="Total" id="text67_1729085670192"/></cells></ColumnListItem></items><columns><Column id="column0_1725865736987897747"><header><Label text="Vertical" id="label7362355555v47"/></header></Column><Column id="column0_17258686786745"><header><Label text="Tipo de Servicios" id="label7362355555747"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1725865736748" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="dhyffespew"><Title id="2ffrito" text="" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1725865736747"><cells><Text text="0€" id="tipoS2025" class="boldText"/><Text text="0€" id="tipoS2026" class="boldText"/><Text text="0€" id="tipoS2027" class="boldText"/><Text text="0€" id="tipoS2028" class="boldText"/><Text text="0€" id="tipoS2029" class="boldText"/><Text text="0€" id="tipoSTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1725865736747"><header><Label text="2025" id="label0_1725865736747"/></header></Column><Column id="column1_1725865736747"><header><Label text="2026" id="label1_1725865736747"/></header></Column><Column id="column2_17258567657412436748"><header><Label text="2027" id="label2_172586565736748"/></header></Column><Column id="column2_1725865543785736748"><header><Label text="2028" id="label2_17258656578778575836748"/></header></Column><Column id="column2_17258655437857"><header><Label text="2029" id="label2_581136748"/></header></Column><Column id="column2_17258111655437857"><header><Label text="Total" id="label2_5831111116748"/></header></Column></columns><columns/></Table><Table noDataText="Drop column list items here and columns in the area above" id="tablno2369118996" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosrtr90534"><Title id="Cada345d" text="Costes Directos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="inoso69118995"><cells><Text text="0€" id="TSCosteD2025" class="boldText"/><Text text="0€" id="TSCosteD2026" class="boldText"/><Text text="0€" id="TSCosteD2027" class="boldText"/><Text xmlns="sap.m" text="0€" id="TSCosteD2028" class="boldText"/><Text xmlns="sap.m" text="0€" id="TSCosteD2029" class="boldText"/><Text xmlns="sap.m" text="0€" id="TSCosteTotalD" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column0_1725869118995"><header><Label text="2025" id="label0_1725869118995"/></header></Column><Column id="column1_1725869118995"><header><Label text="2026" id="label1_1725869118995"/></header></Column><Column id="column2_1725869118996"><header><Label text="2027" id="label2_1725869118996"/></header></Column><Column id="column4_1725869241987"><header><Label text="2028" id="text70_1725869241986"/></header></Column><Column id="column5_1725869248024"><header><Label text="2029" id="text71_1725869248024"/></header></Column><Column id="column7_1725869396990"><header><Label text="Total" id="texfemini5869396988"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table_costes_indirectos_001" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbar_costes_indirectos_001"><Title id="title_costes_indirectos_001" text="Costes Indirectos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item_costes_indirectos_001"><cells><Text text="0€" id="costes_indirectos2025" class="boldText"/><Text text="0€" id="costes_indirectos2026" class="boldText"/><Text text="0€" id="costes_indirectos2027" class="boldText"/><Text text="0€" id="costes_indirectos2028" class="boldText"/><Text text="0€" id="costes_indirectos2029" class="boldText"/><Text text="0€" id="costes_indirectosTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column_2024_costes_indirectos_001"><header><Label text="2025" id="label_2024_costes_indirectos_001"/></header></Column><Column id="column_2025_costes_indirectos_001"><header><Label text="2026" id="text_2025_costes_indirectos_001"/></header></Column><Column id="column_2026_costes_indirectos_001"><header><Label text="2027" id="label_2026_costes_indirectos_001"/></header></Column><Column id="column_2027_costes_indirectos_001"><header><Label text="2028" id="label_2027_costes_indirectos_001"/></header></Column><Column id="column_2028_costes_indirectos_001"><header><Label text="2029" id="text_2028_costes_indirectos_001"/></header></Column><Column id="column_total_costes_indirectos_001"><header><Label text="Total" id="text_total_costes_indirectos_001"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table_costes_totales_001" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbar_costes_totales_001"><Title id="title_costes_totales_001" text="Costes Totales" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item_costes_totales_001"><cells><Text text="0€" id="TSCosteT2025" class="boldText"/><Text text="0€" id="TSCosteT2026" class="boldText"/><Text text="0€" id="TSCosteT2027" class="boldText"/><Text text="0€" id="TSCosteT2028" class="boldText"/><Text text="0€" id="TSCosteT2029" class="boldText"/><Text text="0€" id="TSCosteTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column_1_costes_totales_001"><header><Label text="2025" id="label_header_1_costes_totales_001"/></header></Column><Column id="column_2_costes_totales_001"><header><Label text="2026" id="label_header_2_costes_totales_001"/></header></Column><Column id="column_3_costes_totales_001"><header><Label text="2027" id="label_header_3_costes_totales_001"/></header></Column><Column id="column_4_costes_totales_001"><header><Label text="2028" id="text_header_1_costes_totales_001"/></header></Column><Column id="column_5_costes_totales_001"><header><Label text="2029" id="text_header_2_costes_totales_001"/></header></Column><Column id="column_6_costes_totales_02344"><header><Label text="Total" id="tbier2531584"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table_beneficio_001" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbar_beneficio_001"><Title id="title_beneficio_001" text="Beneficio" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item_beneficio_001"><cells><Text text="0€" id="TSBeneficio2025" class="boldText"/><Text text="0€" id="TSBeneficio2026" class="boldText"/><Text text="0€" id="TSBeneficio2027" class="boldText"/><Text text="0€" id="TSBeneficio2028" class="boldText"/><Text text="0€" id="TSBeneficio2029" class="boldText"/><Text text="0€" id="TSBeneficioTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column_1_beneficio_001"><header><Label text="2025" id="label_header_1_beneficio_001"/></header></Column><Column id="column_2_beneficio_001"><header><Label text="2026" id="label_header_2_beneficio_001"/></header></Column><Column id="column_3_beneficio_001"><header><Label text="2027" id="label_header_3_beneficio_001"/></header></Column><Column id="column_4_beneficio_001"><header><Label text="2028" id="text_header_1_beneficio_001"/></header></Column><Column id="column_5_beneficio_001"><header><Label text="2029" id="text_header_2_beneficio_001"/></header></Column><Column id="column_7_beneficio_001"><header><Label text="Total" id="text_header_4_beneficio_001"/></header></Column></columns></Table><items/></HBox></items></FlexBox><FlexBox width="3500px" id="box0_1724693"><items><HBox width="3500px" id="hbox12" class="sapUiMediumMargin"><Title text="Concepto Oferta" id="fser5d" level="H1" class="sapUiLargeMarginTop sapUiSmallMargin  customTextColor"/><Table noDataText="Drop column list items here and columns in the area above" id="table0_1729086577084" class="customHeaderColor  miTabla"><headerToolbar><Toolbar id="Nosr3119"><Title id="Cad5d98714" text="" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1729086577083"><cells><Text text="" id="text66_1729086577078"/><Text text="Total" id="text67_1729086577080"/></cells></ColumnListItem></items><columns><Column id="column0_1729086577083"><header><Label text="Vertical" id="label0_1729086577083"/></header></Column><Column id="column1_1729086577084"><header><Label text="Concepto Oferta" id="label1_1729086577084"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table26748" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Tdew"><Title id="terro" text="Ingresos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0747"><cells><Text text="0€" id="costeOfer2025" class="boldText"/><Text text="0€" id="costeOfer2026" class="boldText"/><Text text="0€" id="costeOfer2027" class="boldText"/><Text text="0€" id="costeOfer2028" class="boldText"/><Text text="0€" id="costeOfer2029" class="boldText"/><Text text="0€" id="costeOferTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="columj6747"><header><Label text="2025" id="label736747ffui"/></header></Column><Column id="column19378953"><header><Label text="2026" id="labehot747cas"/></header></Column><Column id="column29075"><header><Label text="2027" id="lai9834748"/></header></Column><Column id="column2874839"><header><Label text="2028" id="labe45t736748"/></header></Column><Column id="column2_5736748"><header><Label text="2029" id="label234"/></header></Column><Column id="column34_7"><header><Label text="Total" id="label2_48"/></header></Column></columns><columns/></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1725869118996" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosrtr34"><Title id="Cada34345d" text="Costes Directos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1725869118995"><cells><Text text="0€" id="COcostesDirec2025" class="boldText"/><Text text="0€" id="COcostesDirec2026" class="boldText"/><Text text="0€" id="COcostesDirec2027" class="boldText"/><Text xmlns="sap.m" text="0€" id="COcostesDirec2028" class="boldText"/><Text xmlns="sap.m" text="0€" id="COcostesDirec2029" class="boldText"/><Text xmlns="sap.m" text="0€" id="COcostesDirecTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="colum23975"><header><Label text="2025" id="labhn34875"/></header></Column><Column id="column15938745"><header><Label text="2026" id="ei344"/></header></Column><Column id="COlun3983409580"><header><Label text="2027" id="labno996"/></header></Column><Column id="column4_mue41987"><header><Label text="2028" id="texnofa"/></header></Column><Column id="columnNof4"><header><Label text="2029" id="teHid4"/></header></Column><Column id="column7_fgdf0"><header><Label text="Total" id="text73_1725869396988"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table5" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosrtr349"><Title id="Cada345099" text="Costes Indirectos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item5_1725870548700"><cells><Text text="0€" id="COIndirectos2025" class="boldText"/><Text text="0€" id="COIndirectos2026" class="boldText"/><Text text="0€" id="COIndirectos2027" class="boldText"/><Text xmlns="sap.m" text="0€" id="COIndirectos2028" class="boldText"/><Text xmlns="sap.m" text="0€" id="COIndirectos2029" class="boldText"/><Text xmlns="sap.m" text="0€" id="COIndirectosTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column15"><header><Label text="2025" id="label15"/></header></Column><Column id="column20"><header><Label text="2026" id="text86"/></header></Column><Column id="column16"><header><Label text="2027" id="label16"/></header></Column><Column id="column17"><header><Label text="2028" id="label17"/></header></Column><Column id="column19"><header><Label text="2029" id="text85"/></header></Column><Column id="column21"><header><Label text="Total" id="text87"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1725872132591" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosrtr390849"><Title id="Cada399" text="Costes Totales" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1725872132589"><cells><Text text="0€" id="COtotales2025"/><Text text="0€" id="COtotales2026"/><Text text="0€" id="COtotales2027"/><Text xmlns="sap.m" text="0€" id="COtotales2028"/><Text xmlns="sap.m" text="0€" id="COtotales2029"/><Text xmlns="sap.m" text="0€" id="COtotalesTotal"/></cells></ColumnListItem></items><columns><Column id="column0_1725872132589"><header><Label text="2025" id="label0_1725872132589"/></header></Column><Column id="column1_1725872132590"><header><Label text="2026" id="label1_1725872132589"/></header></Column><Column id="column2_1725872132590"><header><Label text="2027" id="label2_1725872132590"/></header></Column><Column id="column0_1725872519687"><header><Text text="2028" id="text66_1725872519687"/></header></Column><Column id="column1_1725872525562"><header><Text text="2029" id="text67_1725872525562"/></header></Column><Column id="column3_1725872545887"><header><Text text="Total" id="text69_1725872545887"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1725872637623" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosrtr342333"><Title id="Cada345d3223233" text="Beneficio" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item0_1725872637618"><cells><Text text="0€" id="CObenificios2025" class="boldText"/><Text text="0€" id="CObenificios2026" class="boldText"/><Text text="0€" id="CObenificios2027" class="boldText"/><Text xmlns="sap.m" text="0€" id="CObenificios2028" class="boldText"/><Text xmlns="sap.m" text="0€" id="CObenificios2029" class="boldText"/><Text xmlns="sap.m" text="0€" id="CObenificioTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column4_1725872637618"><header><Label text="2025" id="label0_1725872637618"/></header></Column><Column id="column5_1725872637619"><header><Label text="2026" id="label1_1725872637618"/></header></Column><Column id="column6_1725872637622"><header><Label text="2027" id="label2_1725872637619"/></header></Column><Column id="column7_1725872695703"><header><Text text="2028" id="text81_1725872695702"/></header></Column><Column id="column8_1725872707112"><header><Text text="2029" id="text82_1725872707110"/></header></Column><Column id="column10_1725872728491"><header><Text text="Total" id="text84_1725872728490"/></header></Column></columns></Table><items/></HBox></items></FlexBox><FlexBox width="3500px" id="box0_1728589342943"><items><HBox width="100%" id="hbox0_1728589351058" class="sapUiMediumMargin"><Title text="Tipo Recursos  " id="title_concepto_oferta_002" level="H1" class="sapUiLargeMarginTop sapUiSmallMargin customTextColor "/><Table noDataText="Drop column list items here and columns in the area above" id="table1_1729086584619" class="customHeaderColor miTabla"><headerToolbar><Toolbar id="No1sr311489"><Title id="Ca111d5d987" text="" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item1_1729086584618"><cells><Text text="" id="text69_1729086584611"/><Text text="Total" id="text_total_0012" width="100px"/></cells></ColumnListItem></items><columns><Column id="column3_1729086584618"><header><Label text="Tipo de Recursos" id="label3_1729086584618"/></header></Column><Column id="column4_1729086584619"><header><Label text="Vertical" id="label4_1729086584619"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table_ingresos_002" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbar_ingresos_002"><Title id="title_ingresos_002" text="Ingresos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item_ingresos_002"><cells><Text text="0€" id="TRecurso2025" class="boldText"/><Text text="0€" id="TRecurso2026" class="boldText"/><Text text="0€" id="TRecurso2027" class="boldText"/><Text text="0" id="TRecurso2028" class="boldText"/><Text text="0" id="TRecurso2029" class="boldText"/><Text text="0" id="TRecursoTotal" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column_2024_002"><header><Label text="2025" id="label_2024_002"/></header></Column><Column id="column_2025_002"><header><Label text="2026" id="label_2025_002"/></header></Column><Column id="column_2026_002"><header><Label text="2027" id="label_2026_002"/></header></Column><Column id="column_2027_002"><header><Label text="2028" id="label_2027_002"/></header></Column><Column id="column_2028_002"><header><Label text="2029" id="label_2028_002"/></header></Column><Column id="column_total_002"><header><Label text="Total" id="label_total_002"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table_costes_directos_002" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbar_costes_directos_002"><Title id="title_costes_directos_002" text="Costes Directos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="item_costes_directos_002"><cells><Text text="0€" id="text_costes_1_002" class="boldText"/><Text text="0€" id="text_costes_2_002" class="boldText"/><Text text="0" id="text_costes_3_002" class="boldText"/><Text xmlns="sap.m" text="0" id="text_costes_4_002" class="boldText"/><Text xmlns="sap.m" text="0" id="text_costes_5_002" class="boldText"/><Text xmlns="sap.m" text="0" id="text_costes_6_002" class="boldText"/><Text xmlns="sap.m" text="0€" id="text_costes_7_002" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column_2024_costes_002"><header><Label text="2025" id="label_2024_costes_002"/></header></Column><Column id="column_2025_costes_002"><header><Label text="2026" id="label_2025_costes_002"/></header></Column><Column id="column_2026_costes_002"><header><Label text="2027" id="label_2026_costes_002"/></header></Column><Column id="column_2027_costes_002"><header><Label text="2028" id="text_2027_costes_002"/></header></Column><Column id="column_2028_costes_002"><header><Label text="2029" id="text_2028_costes_002"/></header></Column><Column id="column_total_costes_002"><header><Label text="Total" id="text_total_costes_002"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="tableCostesIndirectos" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbarCostesIndirectos"><Title id="titleCostesIndirectos" text="Costes Indirectos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="itemCostesIndirectos_1"><cells><Text text="0" id="cell2024_1" class="boldText"/><Text text="0" id="cell2025_1" class="boldText"/><Text text="0" id="cell2026_1" class="boldText"/><Text xmlns="sap.m" text="0" id="cell2027_1" class="boldText"/><Text xmlns="sap.m" text="0" id="cell2028_1" class="boldText"/><Text xmlns="sap.m" text="0" id="cell2029_1" class="boldText"/><Text xmlns="sap.m" text="0" id="cellTotal_1" class="boldText"/></cells></ColumnListItem></items><columns><Column id="column2024"><header><Label text="2025" id="label2024"/></header></Column><Column id="column2025"><header><Label text="2026" id="label2025"/></header></Column><Column id="column2026"><header><Label text="2027" id="label2026"/></header></Column><Column id="column2027"><header><Label text="2028" id="label2027"/></header></Column><Column id="column2028"><header><Label text="2029" id="label2028"/></header></Column><Column id="columnTotal"><header><Label text="Total" id="labelTotal"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="tableCostesTotales" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbarCostesTotales"><Title id="titleCostesTotales" text="Costes Totales" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="itemCostesTotales_1"><cells><Text text="0€" id="cellCostesTotales_1_1" class="boldText"/><Text text="0€" id="cellCostesTotales_1_2" class="boldText"/><Text text="0€" id="cellCostesTotales_1_3" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellCostesTotales_1_4" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellCostesTotales_1_5" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellCostesTotales_1_6" class="boldText"/><Text xmlns="sap.m" text="4€" id="cellCostesTotales_1_7" class="boldText"/></cells></ColumnListItem></items><columns><Column id="columnCostesTotales_1"><header><Label text="2025" id="labelCostesTotales_1"/></header></Column><Column id="columnCostesTotales_2"><header><Label text="2026" id="labelCostesTotales_2"/></header></Column><Column id="columnCostesTotales_3"><header><Label text="2027" id="labelCostesTotales_3"/></header></Column><Column id="columnCostesTotales_4"><header><Label text="2028" id="headerCostesTotales_4"/></header></Column><Column id="columnCostesTotales_5"><header><Label text="2029" id="headerCostesTotales_5"/></header></Column><Column id="columnCostesTotales_7"><header><Label text="Total" id="headerCostesTotales_7"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="tableBeneficio" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="toolbarBeneficio"><Title id="titleBeneficio" text="Beneficio" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem type="Active" id="itemBeneficio_1"><cells><Text text="0€" id="cellBeneficio_1_1" class="boldText"/><Text text="0€" id="mygret" class="boldText"/><Text text="0€" id="cellBeneficio_1_3" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellBeneficio_1_4" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellBeneficio_1_5" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellBeneficio_1_6" class="boldText"/><Text xmlns="sap.m" text="0€" id="cellBeneficio_1_7" class="boldText"/></cells></ColumnListItem></items><columns><Column id="columnBeneficio_1"><header><Label text="2025" id="labelBeneficio_1"/></header></Column><Column id="columnBeneficio_2"><header><Label text="2026" id="labelBeneficio_2"/></header></Column><Column id="columnBeneficio_3"><header><Label text="2027" id="labelBeneficio_3"/></header></Column><Column id="columnBeneficio_4"><header><Label text="2028" id="headerBeneficio_4"/></header></Column><Column id="columnBeneficio_5"><header><Label text="2029" id="headerBeneficio_5"/></header></Column><Column id="columnBeneficio_7"><header><Label text="Total" id="headerBeneficio_7"/></header></Column></columns></Table><items/></HBox></items></FlexBox><FlexBox width="3500px" id="box0_1729073186524"><items><HBox width="100%" id="hbox056" class="sapUiMediumMargin"><Title text="Tipo Recursos " id="IdTable234" level="H1" class="sapUiLargeMarginTop customTextColor sapUiSmallMargin  "/><Table noDataText="Drop column list items here and columns in the area above" id="table1_1729073599724" class="customHeaderColor miTabla"><headerToolbar><Toolbar id="toolbar45895"><Title id="iDfied15" text="" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item2_1729074265728"><cells><Text xmlns="sap.m" text="Recursos Internos" id="text73_1729077037975"/></cells></ColumnListItem><ColumnListItem id="item3_1729074273283"><cells><Text xmlns="sap.m" text="Consumo Externo" id="text75_1729077061209"/></cells></ColumnListItem><ColumnListItem id="item4_1729074282333"><cells><Text xmlns="sap.m" text="Recursos Externos" id="text74_1729077053691"/><Label text="" id="label4_1729074282332"/><Text xmlns="sap.m" text="" id="text70_1729076946491"/></cells></ColumnListItem><ColumnListItem id="item5"><cells><Text xmlns="sap.m" text="Licencias" id="text76_1729077076684"/></cells></ColumnListItem><ColumnListItem id="item1_1729074262615"><cells><Text xmlns="sap.m" text="Infraestructuras" id="text69_1729076897627"/></cells></ColumnListItem><ColumnListItem id="item0_1729074233586"><cells><Text xmlns="sap.m" text="Gastos de Viaje      Internos  " id="text77_1729077103765"/></cells></ColumnListItem><ColumnListItem type="Active" id="item1_1729073599723"><cells><Text text="TOTAL" id="text69_1729073599717"/></cells></ColumnListItem></items><columns><Column id="column3_1729073599723"><header><Label text="Tipo Recursos" id="label3_1729073599723"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table4_1729073623135" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="tootble23"><Title id="IdIgre" text="Ingresos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item6_1729074302362"><cells><Text xmlns="sap.m" id="text79_1729077206637" text="0€"/><Text xmlns="sap.m" text="0€" id="text80_1729077210224"/><Text xmlns="sap.m" text="0€" id="text78_1729077203649"/><Text xmlns="sap.m" text="0€" id="text81_1729077213529"/><Text xmlns="sap.m" text="0€" id="text83_1729077301855"/><Text xmlns="sap.m" text="0€" id="text84_1729077305255"/><Text xmlns="sap.m" text="0€" id="text92"/></cells></ColumnListItem><ColumnListItem id="item10_1729074317086"><cells><Text xmlns="sap.m" text="0€" id="text85_1729077313319"/><Text xmlns="sap.m" text="0€" id="text86_1729077317194"/><Text xmlns="sap.m" text="0€" id="text87_1729077320933"/><Text xmlns="sap.m" text="0€" id="text89_1729077335929"/><Text xmlns="sap.m" text="0€" id="text90_1729077339030"/><Text xmlns="sap.m" text="0€" id="text91_1729077343635"/><Text xmlns="sap.m" text="0€" id="text93"/></cells></ColumnListItem><ColumnListItem id="item14"><cells><Text xmlns="sap.m" text="0€" id="text94"/><Text xmlns="sap.m" text="0€" id="text95"/><Text xmlns="sap.m" text="0€" id="text96"/><Text xmlns="sap.m" text="0€" id="text97"/><Text xmlns="sap.m" text="0€" id="text98"/><Text xmlns="sap.m" text="0€" id="text99"/><Text xmlns="sap.m" text="0€" id="text100"/></cells></ColumnListItem><ColumnListItem id="item18"><cells><Text xmlns="sap.m" text="0€" id="text101"/><Text xmlns="sap.m" text="0€" id="text102"/><Text xmlns="sap.m" text="0€" id="text106"/><Text xmlns="sap.m" text="0€" id="text107"/><Text xmlns="sap.m" text="0€" id="text105"/><Text xmlns="sap.m" text="0€" id="text103"/><Text xmlns="sap.m" text="0€" id="text104"/></cells></ColumnListItem><ColumnListItem id="item22"><cells><Text xmlns="sap.m" text="0€" id="text108"/><Text xmlns="sap.m" text="0€" id="text109"/><Text xmlns="sap.m" text="0€" id="text110"/><Text xmlns="sap.m" text="0€" id="text111"/><Text xmlns="sap.m" text="0€" id="text112"/><Text xmlns="sap.m" text="0€" id="text113"/><Text xmlns="sap.m" text="0€" id="text114"/></cells></ColumnListItem><ColumnListItem id="item26"><cells><Text xmlns="sap.m" text="0€" id="text116"/><Text xmlns="sap.m" text="0€" id="text117"/><Text xmlns="sap.m" text="0€" id="text118"/><Text xmlns="sap.m" text="0€" id="text119"/><Text xmlns="sap.m" text="0€" id="text120"/><Text xmlns="sap.m" text="0€" id="text121"/><Text xmlns="sap.m" text="0€" id="text122"/></cells></ColumnListItem><ColumnListItem type="Active" id="item4_1729073623133"><cells><Text text="0€" id="text79_1729073623129"/><Text text="0€" id="text80_1729073623133"/><Text xmlns="sap.m" text="0€" id="text123"/><Text xmlns="sap.m" text="0€" id="text124"/><Text xmlns="sap.m" text="0€" id="text125"/><Text xmlns="sap.m" text="0€" id="text126"/><Text xmlns="sap.m" text="0€" id="text127"/></cells></ColumnListItem></items><columns><Column id="column12_1729073623134"><header><Label text="2025" id="label12_1729073623134"/></header></Column><Column id="column13_1729073623134"><header><Label text="2026" id="label13_1729073623134"/></header></Column><Column id="column2_1729074839765"><header><Label text="2027" id="text68_1729074839764"/></header></Column><Column id="column14_1729073623135"><header><Label text="2028" id="label14_1729073623135"/></header></Column><Column id="column3_1729074842441"><header><Label text="2029" id="text69_1729074842441"/></header></Column><Column id="column0_1729074833782"><header><Label text="Total" id="text66_1729074833782"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table3" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosr34"><Title id="Cad5d" text="Costes Directos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item7_1729074305217"><cells><Text xmlns="sap.m" text="0€" id="text129CosteDi"/><Text xmlns="sap.m" text="0€" id="text128CosteDi"/><Text xmlns="sap.m" text="0€" id="text140CosteDi"/><Text xmlns="sap.m" text="0€" id="text141CosteDi"/><Text xmlns="sap.m" text="0€" id="text143CosteDi"/><Text xmlns="sap.m" text="0€" id="text70_1729079344938"/></cells></ColumnListItem><ColumnListItem id="item11_1729074320189"><cells><Text xmlns="sap.m" text="0€" id="text130CosteDi"/><Text xmlns="sap.m" text="0€" id="text134CosteDi"/><Text xmlns="sap.m" text="0€" id="text135"/><Text xmlns="sap.m" text="0€" id="text136"/><Text xmlns="sap.m" text="0€" id="text138"/><Text xmlns="sap.m" text="0€" id="text137"/></cells></ColumnListItem><ColumnListItem id="item15_1729074334146"><cells><Text xmlns="sap.m" text="0€" id="text400"/><Text xmlns="sap.m" text="0€" id="text401"/><Text xmlns="sap.m" text="0€" id="text402"/><Text xmlns="sap.m" text="0€" id="text403"/><Text xmlns="sap.m" text="0€" id="text404"/><Text xmlns="sap.m" text="0€" id="text405"/></cells></ColumnListItem><ColumnListItem id="item19"><cells><Text xmlns="sap.m" text="0€" id="text133"/><Text xmlns="sap.m" text="0€" id="text1341"/><Text xmlns="sap.m" text="0€" id="text1352"/><Text xmlns="sap.m" text="0€" id="text1363"/><Text xmlns="sap.m" text="0€" id="text1374"/><Text xmlns="sap.m" text="0€" id="text1385"/></cells></ColumnListItem><ColumnListItem id="item27"><cells><Text xmlns="sap.m" text="0€" id="text200"/><Text xmlns="sap.m" text="0€" id="text201"/><Text xmlns="sap.m" text="0€" id="text202"/><Text xmlns="sap.m" text="0€" id="text203"/><Text xmlns="sap.m" text="0€" id="text204"/><Text xmlns="sap.m" text="0€" id="text205"/></cells></ColumnListItem><ColumnListItem id="item23"><cells><Text xmlns="sap.m" text="0€" id="text210"/><Text xmlns="sap.m" text="0€" id="text211"/><Text xmlns="sap.m" text="0€" id="text212"/><Text xmlns="sap.m" text="0€" id="text213"/><Text xmlns="sap.m" text="0€" id="text214"/><Text xmlns="sap.m" text="0€" id="text215"/></cells></ColumnListItem><ColumnListItem type="Active" id="item3_1729073618736"><cells><Text text="0€" id="text75_1729073618729"/><Text text="0€" id="text76_1729073618732"/><Text text="0€" id="text77_1729073618734"/><Text xmlns="sap.m" text="0€" id="text300"/><Text xmlns="sap.m" text="0€" id="text301"/><Text xmlns="sap.m" text="0€" id="text302"/><Text xmlns="sap.m" text="0€" id="text303"/><Text xmlns="sap.m" text="0€" id="text304"/></cells></ColumnListItem></items><columns><Column id="column9_1729073618737"><header><Label text="2025" id="label9_1729073618737"/></header></Column><Column id="column1_1729074996661"><header><Text text="2026" id="text67_1729074996661"/></header></Column><Column id="column3_1729075003015"><header><Text text="2027" id="text69_1729075003015"/></header></Column><Column id="column10_1729073618738"><header><Label text="2028" id="label10_1729073618737"/></header></Column><Column id="column11_1729073618738"><header><Label text="2029" id="label11_1729073618738"/></header></Column><Column id="column0_17290749900002732"><header><Label text="Total" id="text66_1729074992700031"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1729074461791" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosr34111"><Title id="Cad5d111" text="Costes Indirectos" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item31"><cells><Text xmlns="sap.m" text="0€" id="text500"/><Text xmlns="sap.m" text="0€" id="text501"/><Text xmlns="sap.m" text="0€" id="text502"/><Text xmlns="sap.m" text="0€" id="text5403"/><Text xmlns="sap.m" text="0€" id="text50544"/><Text xmlns="sap.m" text="0€" id="text505"/><Text xmlns="sap.m" text="0€" id="text506"/></cells></ColumnListItem><ColumnListItem id="item32"><cells><Text xmlns="sap.m" text="0€" id="text510"/><Text xmlns="sap.m" text="0€" id="text511"/><Text xmlns="sap.m" text="0€" id="text512"/><Text xmlns="sap.m" text="0€" id="text513"/><Text xmlns="sap.m" text="0€" id="text5174"/><Text xmlns="sap.m" text="0€" id="text515"/><Text xmlns="sap.m" text="0€" id="text516"/></cells></ColumnListItem><ColumnListItem id="item33"><cells><Text xmlns="sap.m" text="0€" id="text520"/><Text xmlns="sap.m" text="0€" id="text521"/><Text xmlns="sap.m" text="0€" id="text522"/><Text xmlns="sap.m" text="0€" id="text523"/><Text xmlns="sap.m" text="0€" id="text524"/><Text xmlns="sap.m" text="0€" id="text525"/><Text xmlns="sap.m" text="0€" id="text526"/></cells></ColumnListItem><ColumnListItem id="item34"><cells><Text xmlns="sap.m" text="0€" id="text530"/><Text xmlns="sap.m" text="0€" id="text531"/><Text xmlns="sap.m" text="0€" id="text532"/><Text xmlns="sap.m" text="0€" id="text533"/><Text xmlns="sap.m" text="0€" id="text534"/><Text xmlns="sap.m" text="0€" id="text535"/><Text xmlns="sap.m" text="0€" id="text5368"/></cells></ColumnListItem><ColumnListItem id="item35"><cells><Text xmlns="sap.m" text="0€" id="text540"/><Text xmlns="sap.m" text="0€" id="text541"/><Text xmlns="sap.m" text="0€" id="text542"/><Text xmlns="sap.m" text="0€" id="text543"/><Text xmlns="sap.m" text="0€" id="text544"/><Text xmlns="sap.m" text="0€" id="text545"/><Text xmlns="sap.m" text="0€" id="text546"/></cells></ColumnListItem><ColumnListItem id="item36"><cells><Text xmlns="sap.m" text="0€" id="text550"/><Text xmlns="sap.m" text="0€" id="text551"/><Text xmlns="sap.m" text="0€" id="text5522"/><Text xmlns="sap.m" text="0€" id="text553"/><Text xmlns="sap.m" text="0€" id="text554"/><Text xmlns="sap.m" text="0€" id="text555"/><Text xmlns="sap.m" text="0€" id="text556"/></cells></ColumnListItem><ColumnListItem type="Active" id="item30"><cells><Text text="0€" id="text67_1729074461761"/><Text xmlns="sap.m" text="0€" id="text67_1729079322040"/><Text text="0€" id="text68_1729074461766"/><Text text="0€" id="text69_1729074461769"/><Text xmlns="sap.m" text="0€" id="text66_1729079318344"/><Text xmlns="sap.m" text="0€" id="text68_1729079325388"/><Text xmlns="sap.m" text="0€" id="text69_1729079329715"/></cells></ColumnListItem></items><columns><Column id="column1_1729074461780"><header><Label text="2025" id="label30"/></header></Column><Column id="column4_1729075007390"><header><Label text="2026" id="text70_1729075007390"/></header></Column><Column id="column2_1729074461785"><header><Label text="2027" id="label31"/></header></Column><Column id="column9_1729075024383"><header><Label text="2028" id="text75_1729075024382"/></header></Column><Column id="column6_1729075013996"><header><Label text="2029" id="text72_1729075013994"/></header></Column><Column id="column7_1729075017235"><header><Label text="Total" id="text73_1729075017233"/></header></Column></columns></Table><Table ariaLabelledBy="__label5" noDataText="Drop column list items here and columns in the area above" id="table2_1729073605332" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosr3489"><Title id="Cad5d987" text="Costes Totales" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item8_1729074308323"><cells><Text xmlns="sap.m" text="0€" id="textA1_1"/><Text xmlns="sap.m" text="0€" id="textA2_1"/><Text xmlns="sap.m" text="0€" id="textA3_1"/><Text xmlns="sap.m" text="0€" id="textA4_1"/><Text xmlns="sap.m" text="0€" id="textA5_1"/><Text xmlns="sap.m" text="0€" id="textA6_1"/><Text xmlns="sap.m" text="0€" id="textA7_1"/></cells></ColumnListItem><ColumnListItem id="item12"><cells><Text xmlns="sap.m" text="0€" id="textB1_2"/><Text xmlns="sap.m" text="0€" id="textB2_2"/><Text xmlns="sap.m" text="0€" id="textB3_2"/><Text xmlns="sap.m" text="0€" id="textB4_2"/><Text xmlns="sap.m" text="0€" id="textB5_2"/><Text xmlns="sap.m" text="0€" id="textB6_2"/><Text xmlns="sap.m" text="0€" id="textB7_2"/></cells></ColumnListItem><ColumnListItem id="item16"><cells><Text xmlns="sap.m" text="0€" id="textC1_3"/><Text xmlns="sap.m" text="0€" id="textC2_3"/><Text xmlns="sap.m" text="0€" id="textC3_3"/><Text xmlns="sap.m" text="0€" id="textC4_3"/><Text xmlns="sap.m" text="0€" id="textC5_3"/><Text xmlns="sap.m" text="0€" id="textC6_3"/><Text xmlns="sap.m" text="0€" id="textC7_3"/></cells></ColumnListItem><ColumnListItem id="item24"><cells><Text xmlns="sap.m" text="0€" id="textD1_4"/><Text xmlns="sap.m" text="0€" id="textD2_4"/><Text xmlns="sap.m" text="0€" id="textD3_4"/><Text xmlns="sap.m" text="0€" id="textD4_4"/><Text xmlns="sap.m" text="0€" id="textD5_4"/><Text xmlns="sap.m" text="0€" id="textD6_4"/><Text xmlns="sap.m" text="0€" id="textD7_4"/></cells></ColumnListItem><ColumnListItem id="item20"><cells><Text xmlns="sap.m" text="0€" id="textE1_5"/><Text xmlns="sap.m" text="0€" id="textE2_5"/><Text xmlns="sap.m" text="0€" id="textE3_5"/><Text xmlns="sap.m" text="0€" id="textE4_5"/><Text xmlns="sap.m" text="0€" id="textE5_5"/><Text xmlns="sap.m" text="0€" id="textE6_5"/><Text xmlns="sap.m" text="0€" id="textE7_5"/></cells></ColumnListItem><ColumnListItem id="item28"><cells><Text xmlns="sap.m" text="0€" id="textF1_6"/><Text xmlns="sap.m" text="0€" id="textF2_6"/><Text xmlns="sap.m" text="0€" id="textF3_6"/><Text xmlns="sap.m" text="0€" id="textF4_6"/><Text xmlns="sap.m" text="0€" id="textF5_6"/><Text xmlns="sap.m" text="0€" id="textF6_6"/><Text xmlns="sap.m" text="0€" id="textF7_6"/></cells></ColumnListItem><ColumnListItem id="item40"><cells><Text xmlns="sap.m" text="0€" id="textG1_7"/><Text xmlns="sap.m" text="0€" id="textG2_7"/><Text xmlns="sap.m" text="0€" id="textG3_7"/><Text xmlns="sap.m" text="0€" id="textG4_7"/><Text xmlns="sap.m" text="0€" id="textG5_7"/><Text xmlns="sap.m" text="0€" id="textG6_7"/><Text xmlns="sap.m" text="0€" id="textG7_7"/></cells></ColumnListItem></items><columns><Column id="column6_1729073605321"><header><Label text="2025" id="label6_1729073605320"/></header></Column><Column id="column13_1729075038211"><header><Label text="2026" id="text79_1729075038210"/></header></Column><Column id="column7_1729073605326"><header><Label text="2027" id="label7_1729073605324"/></header></Column><Column id="column10_1729075028735"><header><Label text="2028" id="text76_1729075028735"/></header></Column><Column id="column12_1729075034494"><header><Label text="2029" id="text78_1729075034493"/></header></Column><Column id="column8_1729073605331"><header><Label text="Total" id="label8_1729073605330"/></header></Column></columns></Table><Table noDataText="Drop column list items here and columns in the area above" id="table0_1729073521933" class="customHeaderColor2 miTabla"><headerToolbar><Toolbar id="Nosr77773489"><Title id="Cad5d9777787" text="Beneficios" level="H2" class="myText2"/></Toolbar></headerToolbar><items><ColumnListItem id="item41"><cells><Text xmlns="sap.m" text="0€" id="text1_41"/><Text xmlns="sap.m" text="0€" id="text2_41"/><Text xmlns="sap.m" text="0€" id="text3_41"/><Text xmlns="sap.m" text="0€" id="text4_41"/><Text xmlns="sap.m" text="0€" id="text5_41"/><Text xmlns="sap.m" text="0€" id="text6_41"/><Text xmlns="sap.m" text="0€" id="text7_41"/></cells></ColumnListItem><ColumnListItem id="item42"><cells><Text xmlns="sap.m" text="0€" id="text1_42"/><Text xmlns="sap.m" text="0€" id="text2_42"/><Text xmlns="sap.m" text="0€" id="text3_42"/><Text xmlns="sap.m" text="0€" id="text4_42"/><Text xmlns="sap.m" text="0€" id="text5_42"/><Text xmlns="sap.m" text="0€" id="text6_42"/><Text xmlns="sap.m" text="0€" id="text7_42"/></cells></ColumnListItem><ColumnListItem id="item43"><cells><Text xmlns="sap.m" text="0€" id="text1_43"/><Text xmlns="sap.m" text="0€" id="text2_43"/><Text xmlns="sap.m" text="0€" id="text3_43"/><Text xmlns="sap.m" text="0€" id="text4_43"/><Text xmlns="sap.m" text="0€" id="text5_43"/><Text xmlns="sap.m" text="0€" id="text6_43"/><Text xmlns="sap.m" text="0€" id="text7_43"/></cells></ColumnListItem><ColumnListItem id="item44"><cells><Text xmlns="sap.m" text="0€" id="text1_44"/><Text xmlns="sap.m" text="0€" id="text2_44"/><Text xmlns="sap.m" text="0€" id="text3_44"/><Text xmlns="sap.m" text="0€" id="text4_44"/><Text xmlns="sap.m" text="0€" id="text5_44"/><Text xmlns="sap.m" text="0€" id="text6_44"/><Text xmlns="sap.m" text="0€" id="text7_44"/></cells></ColumnListItem><ColumnListItem id="item45"><cells><Text xmlns="sap.m" text="0€" id="text1_45"/><Text xmlns="sap.m" text="0€" id="text2_45"/><Text xmlns="sap.m" text="0€" id="text3_45"/><Text xmlns="sap.m" text="0€" id="text4_45"/><Text xmlns="sap.m" text="0€" id="text5_45"/><Text xmlns="sap.m" text="0€" id="text6_45"/><Text xmlns="sap.m" text="0€" id="text7_45"/></cells></ColumnListItem><ColumnListItem id="item46"><cells><Text xmlns="sap.m" text="0€" id="text1_46"/><Text xmlns="sap.m" text="0€" id="text2_46"/><Text xmlns="sap.m" text="0€" id="text3_46"/><Text xmlns="sap.m" text="0€" id="text4_46"/><Text xmlns="sap.m" text="0€" id="text5_46"/><Text xmlns="sap.m" text="0€" id="text6_46"/><Text xmlns="sap.m" text="0€" id="text7_46"/></cells></ColumnListItem><ColumnListItem id="item47"><cells><Text xmlns="sap.m" text="0€" id="text1_47"/><Text xmlns="sap.m" text="0€" id="text2_47"/><Text xmlns="sap.m" text="0€" id="text3_47"/><Text xmlns="sap.m" text="0€" id="text4_47"/><Text xmlns="sap.m" text="0€" id="text5_47"/><Text xmlns="sap.m" text="0€" id="text6_47"/><Text xmlns="sap.m" text="0€" id="text7_47"/></cells></ColumnListItem></items><columns><Column id="column0_1729073521931"><header><Label text="2025" id="label0_1729073521931"/></header></Column><Column id="column15_1729075046507"><header><Label text="2026" id="text81_1729075046504"/></header></Column><Column id="column1_1729073521932"><header><Label text="2027" id="label1_1729073521931"/></header></Column><Column id="column14_1729075043557"><header><Label text="2028" id="text80_1729075043557"/></header></Column><Column id="column16_1729075049600"><header><Label text="2029" id="text82_1729075049597"/></header></Column><Column id="column17_1729075052988"><header><Label text="Total" id="text83_1729075052984"/></header></Column></columns></Table></HBox></items></FlexBox></content></Panel></IconTabFilter><IconTabFilter id="idHojaAdi" text="Anexos" count="" key="key5"><content><Panel xmlns="sap.m" width="auto" expandable="true" expanded="true" id="panel0_1729068544153"><headerToolbar><Toolbar id="toolbar651"><Title id="idtitleAnexo" text="Informacion Adicional" class="color"/><ToolbarSpacer id="idToan"/><Button id="idbtnSefitn1" icon="sap-icon://settings"/></Toolbar></headerToolbar><content><Text text="Información adicional considerada relevante a presentar junto con la solicitud del proyecto" class="**`sapUiTinyMargin sapUiSmallMarginBottom" id="text66_1729068544144"/><FlexBox xmlns="sap.m" xmlns:u="sap.ui.unified" xmlns:core="sap.ui.core" width="100%" justifyContent="Center" direction="Column" class="sapUiSmallMargin" wrap="Wrap"><VBox width="80%" class="sapUiSmallMargin" justifyContent="Center"><Title text="📝 Información adicional" level="H5" class="sapUiSmallMarginBottom"/><TextArea id="area0" width="100%" rows="8" placeholder="Añade comentarios o detalles relevantes..." growing="true" growingMaxLines="10"/></VBox><VBox width="50%" class="sapUiSmallMarginTop sapUiSmallMargin" justifyContent="Center"><Title text="📁 Subir archivos" level="H5" class="sapUiSmallMarginBottom"/><Text text="Puedes subir archivos hasta 20 MB. Tipos permitidos: PDF, Word, Excel, Imágenes (JPG, PNG), Texto." class="sapUiSmallMarginBottom" wrapping="true" width="100%"/><u:FileUploader id="fileUploader" change=".onFileSelected" uploadOnChange="false" sameFilenameAllowed="true" width="450px" name="myFileUpload" tooltip="Selecciona un archivo para subir"/><List id="fileList" width="100%" items="{archivosModel>/archivos}" noDataText="No hay archivos subidos aún"><items><StandardListItem title="{archivosModel>nombre}" description="{archivosModel>tipoMime}" type="Active" press=".onVerArchivo"/></items></List></VBox></FlexBox></content></Panel></content></IconTabFilter></items></IconTabBar></headerContainer></ObjectHeader></items></VBox></content><footer><OverflowToolbar id="toolba1"><ToolbarSpacer id="25432"/><OverflowToolbarButton tooltip="Delete" text="Delete" id="idDelete" type="Reject" icon="sap-icon://delete" press="onClearFields"/><Button id="btnBorrado" type="Emphasized" icon="sap-icon://save" text="Guardar como borrador" press="onBorrador"/><Button id="btnAceptar" type="Accept" text="Enviar" press="onSave"/></OverflowToolbar></footer></Page></App><Popover id="infoPopoverRecursos" placement="Bottom" title="Información sobre Recursos" contentWidth="auto"><VBox class="sapUiSmallMargin"><Text text="• En todas las secciones Seleccionar la Vertical, Tipo de Servicio, Perfil / Servicio (Estos tres campos son obligatorios) e indicar el Concepto de Oferta (adicionales, formacion, soporte... ) "/><Text text="• Recursos Externos: Seleccionar la Vertical, Tipo de Servicio, Perfil / Servicio  y PMJ(Estos tres campos son obligatorios) e indicar el Concepto de Oferta (adicionales, formacion, soporte... ) "/></VBox></Popover><Popover id="infoPopoverGeneral" placement="Bottom" title="Información General" contentWidth="450px"><VBox class="sapUiSmallMargin"><Text text="📌 Información útil para completar los campos:" class="sapUiSmallMarginBottom"/><Text text="• Código Proyecto: " class="boldText"/><Text text=" Codigo Proyecto asignado por la PMO"/><Text text="• Área: " class="boldText"/><Text text=" Área Funcional de la DAGC que pertenece a la solicitud"/><Text text="• Jefe de Proyecto: " class="boldText"/><Text text=" Nombre del Jefe de Proyecto preasignado: si el jefe de proyecto no está disponible en el desplegable, escribir"/><Text text="• Multijurídica: " class="boldText"/><Text text=" En caso de que exista más de una jurídica, marca el checkbox de \'Multijurídica\' y completa la información en la tabla Cliente Facturación / Jurídicas. En caso contrario, indica la jurídica en Cliente Facturación."/><Text text="• Ejecución Via: " class="boldText"/><Text text=" Aplica a iniciativas GlobalSAP"/><Text text="• Naturaleza: " class="boldText"/><Text text=" OPEX o CAPEX"/><Text text="• IPC Aplicable: " class="boldText"/><Text text=" En los proyecto PluriAnuales se considera un incremento del IPC del 2,5% para Recursos Internos a partir del segundo año, para Recursos Externos el responsable de la cotizacion tiene que considerar si es necesario incrementar la tarifa en cada uno de los años sucesivos"/><Text text="• Cambio EUR - USD: " class="boldText"/><Text text=" En caso de querer obtener el total de la tabla oferta en $ indicar el tipo de cambio aplicado. Consultar a Control el tipo de cambio vigente en el momento de la realización de la ficha "/><Text text="• Fecha inicio del Proyecto: " class="boldText"/><Text text=" Insertar la fecha de inicio del proyecto"/><Text text="• Fecha fin del Proyecto: " class="boldText"/><Text text=" Insertar la fecha de fin del proyecto"/></VBox></Popover><Popover id="infoPopover" placement="Bottom" title="Información sobre Facturación" contentWidth="auto"><FormattedText htmlText="• Para proyectos cortos (hasta 3 meses): se debe facturar el 30% a la firma y el 70% a la entrega.&lt;br&gt;         • Para proyectos de mayor duración: se debe facturar por hitos, comenzando con un hito de facturación a la firma de la propuesta.&lt;br&gt;         • Se debe intentar minimizar el working capital en la planificación de facturación.&lt;br&gt;         • En caso de dudas, consultar con Finanzas."/></Popover></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
